/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Constants.VariablesDynamic"),goog.require("Blockly"),goog.require("Blockly.Blocks"),goog.require("Blockly.FieldLabel"),goog.require("Blockly.FieldVariable"),Blockly.Constants.VariablesDynamic.HUE=310,Blockly.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),Blockly.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(e){if(this.inDebugWorkspace())if(this.isInFlyout){if("variables_get_dynamic"==this.type||"variables_get_reporter_dynamic"==this.type){var t={text:Blockly.Msg.RENAME_VARIABLE,enabled:!this.inDebugWorkspace(),callback:Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},a=(o=this.getField("VAR").getText(),{text:Blockly.Msg.DELETE_VARIABLE.replace("%1",o),enabled:!this.inDebugWorkspace(),callback:Blockly.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)});e.unshift(t),e.unshift(a)}}else{var l,i,s=this.getFieldValue("VAR"),n=this.workspace.getVariableById(s).type;"variables_get_dynamic"==this.type?(l="variables_set_dynamic",i=Blockly.Msg.VARIABLES_GET_CREATE_SET):(l="variables_get_dynamic",i=Blockly.Msg.VARIABLES_SET_CREATE_GET);var r={enabled:this.workspace.remainingCapacity()>0},o=this.getField("VAR").getText();r.text=i.replace("%1",o);var c=Blockly.utils.xml.createElement("field");c.setAttribute("name","VAR"),c.setAttribute("variabletype",n),c.appendChild(Blockly.utils.xml.createTextNode(o));var _=Blockly.utils.xml.createElement("block");_.setAttribute("type",l),_.appendChild(c),r.callback=Blockly.ContextMenu.callbackFactory(this,_),e.push(r)}},onchange:function(e){var t=this.getFieldValue("VAR"),a=Blockly.Variables.getVariable(this.workspace,t);"variables_get_dynamic"==this.type?this.outputConnection.setCheck(a.type):this.getInput("VALUE").connection.setCheck(a.type)}},Blockly.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(e){return function(){var t=e.workspace,a=e.getField("VAR").getVariable();Blockly.Variables.renameVariable(t,a)}},Blockly.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(e){return function(){var t=e.workspace,a=e.getField("VAR").getVariable();t.deleteVariableById(a.getId()),t.refreshToolboxSelection()}},Blockly.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",Blockly.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN);