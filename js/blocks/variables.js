/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Blocks.variables"),goog.provide("Blockly.Constants.Variables"),goog.require("Blockly"),goog.require("Blockly.Blocks"),goog.require("Blockly.FieldLabel"),goog.require("Blockly.FieldVariable"),Blockly.Constants.Variables.HUE=330,Blockly.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_get_reporter",message0:"%1",args0:[{type:"field_variable_getter",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,colour:"%{BKY_VARIABLES_HUE}",outputShape:Blockly.OUTPUT_SHAPE_ROUND,helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableReporter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),Blockly.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(e){if(!this.isCollapsed())if(this.isInFlyout){if("variables_get"==this.type||"variables_get_reporter"==this.type){var t={text:Blockly.Msg.RENAME_VARIABLE,enabled:!this.inDebugWorkspace(),callback:Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},l=(o=this.getField("VAR").getText(),{text:Blockly.Msg.DELETE_VARIABLE.replace("%1",o),enabled:!this.inDebugWorkspace(),callback:Blockly.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)});e.unshift(t),e.unshift(l)}}else{if("variables_get"==this.type||"variables_get_reporter"==this.type)var a="variables_set",s=Blockly.Msg.VARIABLES_GET_CREATE_SET;else a="variables_get",s=Blockly.Msg.VARIABLES_SET_CREATE_GET;var i={enabled:this.workspace.remainingCapacity()>0&&!this.inDebugWorkspace()},o=this.getField("VAR").getText();i.text=s.replace("%1",o);var r=Blockly.utils.xml.createElement("field");r.setAttribute("name","VAR"),r.appendChild(Blockly.utils.xml.createTextNode(o));var n=Blockly.utils.xml.createElement("block");n.setAttribute("type",a),n.appendChild(r),i.callback=Blockly.ContextMenu.callbackFactory(this,n),e.push(i)}}},Blockly.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_REPORTER_MIXIN={customContextMenu:function(e){if(!this.isCollapsed()){var t={text:Blockly.Msg.RENAME_VARIABLE,enabled:!this.inDebugWorkspace(),callback:Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)};if(e.unshift(t),!this.isInFlyout){var l=this.workspace.getVariablesOfType("");if(l.length>0){e.unshift({separator:!0})}for(var a=l.length-1;a>=0;a--){var s={enabled:!this.inDebugWorkspace()};s.text=l[a].name,s.callback=Blockly.Constants.Variables.VARIABLE_OPTION_CALLBACK_FACTORY(this,s.text,l[a].getId()),e.unshift(s)}}}}},Blockly.Constants.Variables.VARIABLE_OPTION_CALLBACK_FACTORY=function(e,t,l){return function(){var t=e.getField("VAR");t||console.log("Tried to get a variable field on the wrong type of block."),t.setValue(l)}},Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(e){return function(){var t=e.workspace,l=e.getField("VAR").getVariable();Blockly.Variables.renameVariable(t,l)}},Blockly.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(e){return function(){var t=e.workspace,l=e.getField("VAR").getVariable();t.deleteVariableById(l.getId()),t.refreshToolboxSelection()}},Blockly.Extensions.registerMixin("contextMenu_variableSetterGetter",Blockly.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),Blockly.Extensions.registerMixin("contextMenu_variableReporter",Blockly.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_REPORTER_MIXIN);