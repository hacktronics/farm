/**
 * @license
 * Copyright 2016 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Lua"),goog.require("Blockly.Generator"),goog.require("Blockly.inputTypes"),goog.require("Blockly.utils.object"),goog.require("Blockly.utils.string"),Blockly.Lua=new Blockly.Generator("Lua"),Blockly.Lua.addReservedWords("_,__inext,assert,bit,colors,colours,coroutine,disk,dofile,error,fs,fetfenv,getmetatable,gps,help,io,ipairs,keys,loadfile,loadstring,math,native,next,os,paintutils,pairs,parallel,pcall,peripheral,print,printError,rawequal,rawget,rawset,read,rednet,redstone,rs,select,setfenv,setmetatable,sleep,string,table,term,textutils,tonumber,tostring,turtle,type,unpack,vector,write,xpcall,_VERSION,__indext,HTTP,and,break,do,else,elseif,end,false,for,function,if,in,local,nil,not,or,repeat,return,then,true,until,while,add,sub,mul,div,mod,pow,unm,concat,len,eq,lt,le,index,newindex,call,assert,collectgarbage,dofile,error,_G,getmetatable,inpairs,load,loadfile,next,pairs,pcall,print,rawequal,rawget,rawlen,rawset,select,setmetatable,tonumber,tostring,type,_VERSION,xpcall,require,package,string,table,math,bit32,io,file,os,debug"),Blockly.Lua.ORDER_ATOMIC=0,Blockly.Lua.ORDER_HIGH=1,Blockly.Lua.ORDER_EXPONENTIATION=2,Blockly.Lua.ORDER_UNARY=3,Blockly.Lua.ORDER_MULTIPLICATIVE=4,Blockly.Lua.ORDER_ADDITIVE=5,Blockly.Lua.ORDER_CONCATENATION=6,Blockly.Lua.ORDER_RELATIONAL=7,Blockly.Lua.ORDER_AND=8,Blockly.Lua.ORDER_OR=9,Blockly.Lua.ORDER_NONE=99,Blockly.Lua.isInitialized=!1,Blockly.Lua.init=function(e){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new Blockly.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(e.getVariableMap()),this.nameDB_.populateVariables(e),this.nameDB_.populateProcedures(e),this.isInitialized=!0},Blockly.Lua.finish=function(e){var t=Blockly.utils.object.values(this.definitions_);return e=Object.getPrototypeOf(this).finish.call(this,e),this.isInitialized=!1,this.nameDB_.reset(),t.join("\n\n")+"\n\n\n"+e},Blockly.Lua.scrubNakedValue=function(e){return"local _ = "+e+"\n"},Blockly.Lua.quote_=function(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},Blockly.Lua.multiline_quote_=function(e){return e.split(/\n/g).map(this.quote_).join(" .. '\\n' ..\n")},Blockly.Lua.scrub_=function(e,t,l){var i="";if(!e.outputConnection||!e.outputConnection.targetConnection){var n=e.getCommentText();n&&(n=Blockly.utils.string.wrap(n,this.COMMENT_WRAP-3),i+=this.prefixLines(n,"-- ")+"\n");for(var o=0;o<e.inputList.length;o++)if(e.inputList[o].type==Blockly.inputTypes.VALUE){var a=e.inputList[o].connection.targetBlock();a&&(n=this.allNestedComments(a))&&(i+=this.prefixLines(n,"-- "))}}var r=e.nextConnection&&e.nextConnection.targetBlock();return i+t+(l?"":this.blockToCode(r))};