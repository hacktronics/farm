/**
 * @license
 * Copyright 2014 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Dart.loops"),goog.require("Blockly.Dart"),Blockly.Dart.controls_repeat_ext=function(l){if(l.getField("TIMES"))var o=String(Number(l.getFieldValue("TIMES")));else o=Blockly.Dart.valueToCode(l,"TIMES",Blockly.Dart.ORDER_ASSIGNMENT)||"0";var t=Blockly.Dart.statementToCode(l,"DO");t=Blockly.Dart.addLoopTrap(t,l);var a="",r=Blockly.Dart.nameDB_.getDistinctName("count",Blockly.VARIABLE_CATEGORY_NAME),e=o;return o.match(/^\w+$/)||Blockly.isNumber(o)||(a+="var "+(e=Blockly.Dart.nameDB_.getDistinctName("repeat_end",Blockly.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),a+="for (int "+r+" = 0; "+r+" < "+e+"; "+r+"++) {\n"+t+"}\n"},Blockly.Dart.controls_repeat=Blockly.Dart.controls_repeat_ext,Blockly.Dart.controls_whileUntil=function(l){var o="UNTIL"==l.getFieldValue("MODE"),t=Blockly.Dart.valueToCode(l,"BOOL",o?Blockly.Dart.ORDER_UNARY_PREFIX:Blockly.Dart.ORDER_NONE)||"false",a=Blockly.Dart.statementToCode(l,"DO");return o&&(t="!"+t),"while ("+t+") {\n"+(a=Blockly.Dart.addLoopTrap(a,l))+"}\n"},Blockly.Dart.controls_for=function(l){var o,t=Blockly.Dart.nameDB_.getName(l.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),a=Blockly.Dart.valueToCode(l,"FROM",Blockly.Dart.ORDER_ASSIGNMENT)||"0",r=Blockly.Dart.valueToCode(l,"TO",Blockly.Dart.ORDER_ASSIGNMENT)||"0",e=Blockly.Dart.valueToCode(l,"BY",Blockly.Dart.ORDER_ASSIGNMENT)||"1",c=Blockly.Dart.statementToCode(l,"DO");if(c=Blockly.Dart.addLoopTrap(c,l),Blockly.isNumber(a)&&Blockly.isNumber(r)&&Blockly.isNumber(e)){var n=parseFloat(a)<=parseFloat(r);o="for ("+t+" = "+a+"; "+t+(n?" <= ":" >= ")+r+"; "+t;var B=Math.abs(parseFloat(e));o+=1==B?n?"++":"--":(n?" += ":" -= ")+B,o+=") {\n"+c+"}\n"}else{o="";var D=a;a.match(/^\w+$/)||Blockly.isNumber(a)||(o+="var "+(D=Blockly.Dart.nameDB_.getDistinctName(t+"_start",Blockly.VARIABLE_CATEGORY_NAME))+" = "+a+";\n");var k=r;r.match(/^\w+$/)||Blockly.isNumber(r)||(o+="var "+(k=Blockly.Dart.nameDB_.getDistinctName(t+"_end",Blockly.VARIABLE_CATEGORY_NAME))+" = "+r+";\n");var y=Blockly.Dart.nameDB_.getDistinctName(t+"_inc",Blockly.VARIABLE_CATEGORY_NAME);o+="num "+y+" = ",Blockly.isNumber(e)?o+=Math.abs(e)+";\n":o+="("+e+").abs();\n",o+="if ("+D+" > "+k+") {\n",o+=Blockly.Dart.INDENT+y+" = -"+y+";\n",o+="}\n",o+="for ("+t+" = "+D+"; "+y+" >= 0 ? "+t+" <= "+k+" : "+t+" >= "+k+"; "+t+" += "+y+") {\n"+c+"}\n"}return o},Blockly.Dart.controls_forEach=function(l){var o=Blockly.Dart.nameDB_.getName(l.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),t=Blockly.Dart.valueToCode(l,"LIST",Blockly.Dart.ORDER_ASSIGNMENT)||"[]",a=Blockly.Dart.statementToCode(l,"DO");return"for (var "+o+" in "+t+") {\n"+(a=Blockly.Dart.addLoopTrap(a,l))+"}\n"},Blockly.Dart.controls_flow_statements=function(l){var o="";if(Blockly.Dart.STATEMENT_PREFIX&&(o+=Blockly.Dart.injectId(Blockly.Dart.STATEMENT_PREFIX,l)),Blockly.Dart.STATEMENT_SUFFIX&&(o+=Blockly.Dart.injectId(Blockly.Dart.STATEMENT_SUFFIX,l)),Blockly.Dart.STATEMENT_PREFIX){var t=Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(l);t&&!t.suppressPrefixSuffix&&(o+=Blockly.Dart.injectId(Blockly.Dart.STATEMENT_PREFIX,t))}switch(l.getFieldValue("FLOW")){case"BREAK":return o+"break;\n";case"CONTINUE":return o+"continue;\n"}throw Error("Unknown flow statement.")};