/**
 * @license
 * Copyright 2014 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Dart.lists"),goog.require("Blockly.Dart"),Blockly.Dart.addReservedWords("Math"),Blockly.Dart.lists_create_empty=function(t){return["[]",Blockly.Dart.ORDER_ATOMIC]},Blockly.Dart.lists_create_with=function(t){for(var e=new Array(t.itemCount_),l=0;l<t.itemCount_;l++)e[l]=Blockly.Dart.valueToCode(t,"ADD"+l,Blockly.Dart.ORDER_NONE)||"null";return["["+e.join(", ")+"]",Blockly.Dart.ORDER_ATOMIC]},Blockly.Dart.lists_repeat=function(t){var e=Blockly.Dart.valueToCode(t,"ITEM",Blockly.Dart.ORDER_NONE)||"null";return["new List.filled("+(Blockly.Dart.valueToCode(t,"NUM",Blockly.Dart.ORDER_NONE)||"0")+", "+e+")",Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_length=function(t){return[(Blockly.Dart.valueToCode(t,"VALUE",Blockly.Dart.ORDER_UNARY_POSTFIX)||"[]")+".length",Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_isEmpty=function(t){return[(Blockly.Dart.valueToCode(t,"VALUE",Blockly.Dart.ORDER_UNARY_POSTFIX)||"[]")+".isEmpty",Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",l=Blockly.Dart.valueToCode(t,"FIND",Blockly.Dart.ORDER_NONE)||"''",r=(Blockly.Dart.valueToCode(t,"VALUE",Blockly.Dart.ORDER_UNARY_POSTFIX)||"[]")+"."+e+"("+l+")";return t.workspace.options.oneBasedIndex?[r+" + 1",Blockly.Dart.ORDER_ADDITIVE]:[r,Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET",l=t.getFieldValue("WHERE")||"FROM_START",r="RANDOM"==l||"FROM_END"==l?Blockly.Dart.ORDER_NONE:Blockly.Dart.ORDER_UNARY_POSTFIX,a=Blockly.Dart.valueToCode(t,"VALUE",r)||"[]";function o(){var t=Blockly.Dart.nameDB_.getDistinctName("tmp_list",Blockly.VARIABLE_CATEGORY_NAME),e="List "+t+" = "+a+";\n";return a=t,e}if(("RANDOM"!=l||"REMOVE"!=e)&&"FROM_END"!=l||a.match(/^\w+$/))switch(l){case"FIRST":if("GET"==e)return[i=a+".first",Blockly.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==e)return[i=a+".removeAt(0)",Blockly.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==e)return a+".removeAt(0);\n";break;case"LAST":if("GET"==e)return[i=a+".last",Blockly.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==e)return[i=a+".removeLast()",Blockly.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==e)return a+".removeLast();\n";break;case"FROM_START":D=Blockly.Dart.getAdjusted(t,"AT");if("GET"==e)return[i=a+"["+D+"]",Blockly.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==e)return[i=a+".removeAt("+D+")",Blockly.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==e)return a+".removeAt("+D+");\n";break;case"FROM_END":D=Blockly.Dart.getAdjusted(t,"AT",1,!1,Blockly.Dart.ORDER_ADDITIVE);if("GET"==e)return[i=a+"["+a+".length - "+D+"]",Blockly.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==e||"REMOVE"==e){i=a+".removeAt("+a+".length - "+D+")";if("GET_REMOVE"==e)return[i,Blockly.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==e)return i+";\n"}break;case"RANDOM":if(Blockly.Dart.definitions_.import_dart_math="import 'dart:math' as Math;","REMOVE"==e){i="int "+(n=Blockly.Dart.nameDB_.getDistinctName("tmp_x",Blockly.VARIABLE_CATEGORY_NAME))+" = new Math.Random().nextInt("+a+".length);\n";return i+=a+".removeAt("+n+");\n"}if("GET"==e)return[i=Blockly.Dart.provideFunction_("lists_get_random_item",["dynamic "+Blockly.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list) {","  int x = new Math.Random().nextInt(my_list.length);","  return my_list[x];","}"])+"("+a+")",Blockly.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==e)return[i=Blockly.Dart.provideFunction_("lists_remove_random_item",["dynamic "+Blockly.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list) {","  int x = new Math.Random().nextInt(my_list.length);","  return my_list.removeAt(x);","}"])+"("+a+")",Blockly.Dart.ORDER_UNARY_POSTFIX]}else{if("RANDOM"==l){Blockly.Dart.definitions_.import_dart_math="import 'dart:math' as Math;";var n,i=o();return i+="int "+(n=Blockly.Dart.nameDB_.getDistinctName("tmp_x",Blockly.VARIABLE_CATEGORY_NAME))+" = new Math.Random().nextInt("+a+".length);\n",i+=a+".removeAt("+n+");\n"}if("REMOVE"==e){var D=Blockly.Dart.getAdjusted(t,"AT",1,!1,Blockly.Dart.ORDER_ADDITIVE),i=o();return i+=a+".removeAt("+a+".length - "+D+");\n"}if("GET"==e){var D=Blockly.Dart.getAdjusted(t,"AT",1);return[i=Blockly.Dart.provideFunction_("lists_get_from_end",["dynamic "+Blockly.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list, num x) {","  x = my_list.length - x;","  return my_list[x];","}"])+"("+a+", "+D+")",Blockly.Dart.ORDER_UNARY_POSTFIX]}if("GET_REMOVE"==e){var D=Blockly.Dart.getAdjusted(t,"AT",1);return[i=Blockly.Dart.provideFunction_("lists_remove_from_end",["dynamic "+Blockly.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list, num x) {","  x = my_list.length - x;","  return my_list.removeAt(x);","}"])+"("+a+", "+D+")",Blockly.Dart.ORDER_UNARY_POSTFIX]}}throw Error("Unhandled combination (lists_getIndex).")},Blockly.Dart.lists_setIndex=function(t){var e=t.getFieldValue("MODE")||"GET",l=t.getFieldValue("WHERE")||"FROM_START",r=Blockly.Dart.valueToCode(t,"LIST",Blockly.Dart.ORDER_UNARY_POSTFIX)||"[]",a=Blockly.Dart.valueToCode(t,"TO",Blockly.Dart.ORDER_ASSIGNMENT)||"null";function o(){if(r.match(/^\w+$/))return"";var t=Blockly.Dart.nameDB_.getDistinctName("tmp_list",Blockly.VARIABLE_CATEGORY_NAME),e="List "+t+" = "+r+";\n";return r=t,e}switch(l){case"FIRST":if("SET"==e)return r+"[0] = "+a+";\n";if("INSERT"==e)return r+".insert(0, "+a+");\n";break;case"LAST":if("SET"==e){var n=o();return n+=r+"["+r+".length - 1] = "+a+";\n"}if("INSERT"==e)return r+".add("+a+");\n";break;case"FROM_START":var i=Blockly.Dart.getAdjusted(t,"AT");if("SET"==e)return r+"["+i+"] = "+a+";\n";if("INSERT"==e)return r+".insert("+i+", "+a+");\n";break;case"FROM_END":i=Blockly.Dart.getAdjusted(t,"AT",1,!1,Blockly.Dart.ORDER_ADDITIVE),n=o();if("SET"==e)return n+=r+"["+r+".length - "+i+"] = "+a+";\n";if("INSERT"==e)return n+=r+".insert("+r+".length - "+i+", "+a+");\n";break;case"RANDOM":Blockly.Dart.definitions_.import_dart_math="import 'dart:math' as Math;";n=o();var D=Blockly.Dart.nameDB_.getDistinctName("tmp_x",Blockly.VARIABLE_CATEGORY_NAME);if(n+="int "+D+" = new Math.Random().nextInt("+r+".length);\n","SET"==e)return n+=r+"["+D+"] = "+a+";\n";if("INSERT"==e)return n+=r+".insert("+D+", "+a+");\n"}throw Error("Unhandled combination (lists_setIndex).")},Blockly.Dart.lists_getSublist=function(t){var e=Blockly.Dart.valueToCode(t,"LIST",Blockly.Dart.ORDER_UNARY_POSTFIX)||"[]",l=t.getFieldValue("WHERE1"),r=t.getFieldValue("WHERE2");if(e.match(/^\w+$/)||"FROM_END"!=l&&"FROM_START"==r){switch(l){case"FROM_START":var a=Blockly.Dart.getAdjusted(t,"AT1");break;case"FROM_END":a=e+".length - "+(a=Blockly.Dart.getAdjusted(t,"AT1",1,!1,Blockly.Dart.ORDER_ADDITIVE));break;case"FIRST":a="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(r){case"FROM_START":var o=Blockly.Dart.getAdjusted(t,"AT2",1);break;case"FROM_END":o=e+".length - "+(o=Blockly.Dart.getAdjusted(t,"AT2",0,!1,Blockly.Dart.ORDER_ADDITIVE));break;case"LAST":break;default:throw Error("Unhandled option (lists_getSublist).")}if("LAST"==r)var n=e+".sublist("+a+")";else n=e+".sublist("+a+", "+o+")"}else a=Blockly.Dart.getAdjusted(t,"AT1"),o=Blockly.Dart.getAdjusted(t,"AT2"),n=Blockly.Dart.provideFunction_("lists_get_sublist",["List "+Blockly.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List list, String where1, num at1, String where2, num at2) {","  int getAt(String where, num at) {","    if (where == 'FROM_END') {","      at = list.length - 1 - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = list.length - 1;","    } else if (where != 'FROM_START') {","      throw 'Unhandled option (lists_getSublist).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return list.sublist(at1, at2);","}"])+"("+e+", '"+l+"', "+a+", '"+r+"', "+o+")";return[n,Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_sort=function(t){var e=Blockly.Dart.valueToCode(t,"LIST",Blockly.Dart.ORDER_NONE)||"[]",l="1"===t.getFieldValue("DIRECTION")?1:-1,r=t.getFieldValue("TYPE");return[Blockly.Dart.provideFunction_("lists_sort",["List "+Blockly.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List list, String type, int direction) {","  var compareFuncs = {",'    "NUMERIC": (a, b) => (direction * a.compareTo(b)).toInt(),','    "TEXT": (a, b) => direction * a.toString().compareTo(b.toString()),','    "IGNORE_CASE": ',"       (a, b) => direction * ","      a.toString().toLowerCase().compareTo(b.toString().toLowerCase())","  };","  list = new List.from(list);","  var compare = compareFuncs[type];","  list.sort(compare);","  return list;","}"])+"("+e+', "'+r+'", '+l+")",Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_split=function(t){var e=Blockly.Dart.valueToCode(t,"INPUT",Blockly.Dart.ORDER_UNARY_POSTFIX),l=Blockly.Dart.valueToCode(t,"DELIM",Blockly.Dart.ORDER_NONE)||"''",r=t.getFieldValue("MODE");if("SPLIT"==r){e||(e="''");var a="split"}else{if("JOIN"!=r)throw Error("Unknown mode: "+r);e||(e="[]");a="join"}return[e+"."+a+"("+l+")",Blockly.Dart.ORDER_UNARY_POSTFIX]},Blockly.Dart.lists_reverse=function(t){return["new List.from("+(Blockly.Dart.valueToCode(t,"LIST",Blockly.Dart.ORDER_NONE)||"[]")+".reversed)",Blockly.Dart.ORDER_UNARY_POSTFIX]};