/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Python.loops"),goog.require("Blockly.Python"),Blockly.Python.controls_repeat_ext=function(o){if(o.getField("TIMES"))var t=String(parseInt(o.getFieldValue("TIMES"),10));else t=Blockly.Python.valueToCode(o,"TIMES",Blockly.Python.ORDER_NONE)||"0";t=Blockly.isNumber(t)?parseInt(t,10):"int("+t+")";var l=Blockly.Python.statementToCode(o,"DO");return l=Blockly.Python.addLoopTrap(l,o)||Blockly.Python.PASS,"for "+Blockly.Python.nameDB_.getDistinctName("count",Blockly.VARIABLE_CATEGORY_NAME)+" in range("+t+"):\n"+l},Blockly.Python.controls_repeat=Blockly.Python.controls_repeat_ext,Blockly.Python.controls_whileUntil=function(o){var t="UNTIL"==o.getFieldValue("MODE"),l=Blockly.Python.valueToCode(o,"BOOL",t?Blockly.Python.ORDER_LOGICAL_NOT:Blockly.Python.ORDER_NONE)||"False",n=Blockly.Python.statementToCode(o,"DO");return t&&(l="not "+l),"while "+l+":\n"+(n=Blockly.Python.addLoopTrap(n,o)||Blockly.Python.PASS)},Blockly.Python.controls_for=function(o){var t=Blockly.Python.nameDB_.getName(o.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),l=Blockly.Python.valueToCode(o,"FROM",Blockly.Python.ORDER_NONE)||"0",n=Blockly.Python.valueToCode(o,"TO",Blockly.Python.ORDER_NONE)||"0",e=Blockly.Python.valueToCode(o,"BY",Blockly.Python.ORDER_NONE)||"1",y=Blockly.Python.statementToCode(o,"DO");y=Blockly.Python.addLoopTrap(y,o)||Blockly.Python.PASS;var c,r,a,B,s="",k=function(){return Blockly.Python.provideFunction_("upRange",["def "+Blockly.Python.FUNCTION_NAME_PLACEHOLDER_+"(start, stop, step):","  while start <= stop:","    yield start","    start += abs(step)"])},P=function(){return Blockly.Python.provideFunction_("downRange",["def "+Blockly.Python.FUNCTION_NAME_PLACEHOLDER_+"(start, stop, step):","  while start >= stop:","    yield start","    start -= abs(step)"])};if(Blockly.isNumber(l)&&Blockly.isNumber(n)&&Blockly.isNumber(e))l=parseFloat(l),n=parseFloat(n),e=Math.abs(parseFloat(e)),l%1==0&&n%1==0&&e%1==0?(l<=n?(n++,c=0==l&&1==e?n:l+", "+n,1!=e&&(c+=", "+e)):c=l+", "+--n+", -"+e,c="range("+c+")"):(c=l<n?k():P(),c+="("+l+", "+n+", "+e+")");else{var h=function(o,l){if(Blockly.isNumber(o))o=parseFloat(o);else if(o.match(/^\w+$/))o="float("+o+")";else{var n=Blockly.Python.nameDB_.getDistinctName(t+l,Blockly.VARIABLE_CATEGORY_NAME);s+=n+" = float("+o+")\n",o=n}return o},E=h(l,"_start"),i=h(n,"_end"),_=h(e,"_inc");"number"==typeof E&&"number"==typeof i?(c=E<i?k():P(),c+="("+E+", "+i+", "+_+")"):(B=_,c="("+(r=E)+" <= "+(a=i)+") and "+k()+"("+r+", "+a+", "+B+") or "+P()+"("+r+", "+a+", "+B+")")}return s+="for "+t+" in "+c+":\n"+y},Blockly.Python.controls_forEach=function(o){var t=Blockly.Python.nameDB_.getName(o.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),l=Blockly.Python.valueToCode(o,"LIST",Blockly.Python.ORDER_RELATIONAL)||"[]",n=Blockly.Python.statementToCode(o,"DO");return"for "+t+" in "+l+":\n"+(n=Blockly.Python.addLoopTrap(n,o)||Blockly.Python.PASS)},Blockly.Python.controls_flow_statements=function(o){var t="";if(Blockly.Python.STATEMENT_PREFIX&&(t+=Blockly.Python.injectId(Blockly.Python.STATEMENT_PREFIX,o)),Blockly.Python.STATEMENT_SUFFIX&&(t+=Blockly.Python.injectId(Blockly.Python.STATEMENT_SUFFIX,o)),Blockly.Python.STATEMENT_PREFIX){var l=Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(o);l&&!l.suppressPrefixSuffix&&(t+=Blockly.Python.injectId(Blockly.Python.STATEMENT_PREFIX,l))}switch(o.getFieldValue("FLOW")){case"BREAK":return t+"break\n";case"CONTINUE":return t+"continue\n"}throw Error("Unknown flow statement.")};