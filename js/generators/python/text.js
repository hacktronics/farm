/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Python.texts"),goog.require("Blockly.Python"),Blockly.Python.text=function(o){return[Blockly.Python.quote_(o.getFieldValue("TEXT")),Blockly.Python.ORDER_ATOMIC]},Blockly.Python.text_multiline=function(o){var t=Blockly.Python.multiline_quote_(o.getFieldValue("TEXT")),l=-1!=t.indexOf("+")?Blockly.Python.ORDER_ADDITIVE:Blockly.Python.ORDER_ATOMIC;return[t,l]},Blockly.Python.text.forceString_=function(o){return Blockly.Python.text.forceString_.strRegExp.test(o)?[o,Blockly.Python.ORDER_ATOMIC]:["str("+o+")",Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,Blockly.Python.text_join=function(o){switch(o.itemCount_){case 0:return["''",Blockly.Python.ORDER_ATOMIC];case 1:var t=Blockly.Python.valueToCode(o,"ADD0",Blockly.Python.ORDER_NONE)||"''";return Blockly.Python.text.forceString_(t);case 2:var l=Blockly.Python.valueToCode(o,"ADD0",Blockly.Python.ORDER_NONE)||"''",e=Blockly.Python.valueToCode(o,"ADD1",Blockly.Python.ORDER_NONE)||"''";return[Blockly.Python.text.forceString_(l)[0]+" + "+Blockly.Python.text.forceString_(e)[0],Blockly.Python.ORDER_ADDITIVE];default:for(var n=[],y=0;y<o.itemCount_;y++)n[y]=Blockly.Python.valueToCode(o,"ADD"+y,Blockly.Python.ORDER_NONE)||"''";var c=Blockly.Python.nameDB_.getDistinctName("x",Blockly.VARIABLE_CATEGORY_NAME);return["''.join([str("+c+") for "+c+" in ["+n.join(", ")+"]])",Blockly.Python.ORDER_FUNCTION_CALL]}},Blockly.Python.text_append=function(o){var t=Blockly.Python.nameDB_.getName(o.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),l=Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_NONE)||"''";return t+" = str("+t+") + "+Blockly.Python.text.forceString_(l)[0]+"\n"},Blockly.Python.text_length=function(o){return["len("+(Blockly.Python.valueToCode(o,"VALUE",Blockly.Python.ORDER_NONE)||"''")+")",Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text_isEmpty=function(o){return["not len("+(Blockly.Python.valueToCode(o,"VALUE",Blockly.Python.ORDER_NONE)||"''")+")",Blockly.Python.ORDER_LOGICAL_NOT]},Blockly.Python.text_indexOf=function(o){var t="FIRST"==o.getFieldValue("END")?"find":"rfind",l=Blockly.Python.valueToCode(o,"FIND",Blockly.Python.ORDER_NONE)||"''",e=(Blockly.Python.valueToCode(o,"VALUE",Blockly.Python.ORDER_MEMBER)||"''")+"."+t+"("+l+")";return o.workspace.options.oneBasedIndex?[e+" + 1",Blockly.Python.ORDER_ADDITIVE]:[e,Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text_charAt=function(o){var t=o.getFieldValue("WHERE")||"FROM_START",l="RANDOM"==t?Blockly.Python.ORDER_NONE:Blockly.Python.ORDER_MEMBER,e=Blockly.Python.valueToCode(o,"VALUE",l)||"''";switch(t){case"FIRST":return[e+"[0]",Blockly.Python.ORDER_MEMBER];case"LAST":return[e+"[-1]",Blockly.Python.ORDER_MEMBER];case"FROM_START":return[e+"["+Blockly.Python.getAdjustedInt(o,"AT")+"]",Blockly.Python.ORDER_MEMBER];case"FROM_END":return[e+"["+Blockly.Python.getAdjustedInt(o,"AT",1,!0)+"]",Blockly.Python.ORDER_MEMBER];case"RANDOM":return Blockly.Python.definitions_.import_random="import random",[Blockly.Python.provideFunction_("text_random_letter",["def "+Blockly.Python.FUNCTION_NAME_PLACEHOLDER_+"(text):","  x = int(random.random() * len(text))","  return text[x];"])+"("+e+")",Blockly.Python.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},Blockly.Python.text_getSubstring=function(o){var t=o.getFieldValue("WHERE1"),l=o.getFieldValue("WHERE2"),e=Blockly.Python.valueToCode(o,"STRING",Blockly.Python.ORDER_MEMBER)||"''";switch(t){case"FROM_START":"0"==(n=Blockly.Python.getAdjustedInt(o,"AT1"))&&(n="");break;case"FROM_END":var n=Blockly.Python.getAdjustedInt(o,"AT1",1,!0);break;case"FIRST":n="";break;default:throw Error("Unhandled option (text_getSubstring)")}switch(l){case"FROM_START":var y=Blockly.Python.getAdjustedInt(o,"AT2",1);break;case"FROM_END":y=Blockly.Python.getAdjustedInt(o,"AT2",0,!0);Blockly.isNumber(String(y))?"0"==y&&(y=""):(Blockly.Python.definitions_.import_sys="import sys",y+=" or sys.maxsize");break;case"LAST":y="";break;default:throw Error("Unhandled option (text_getSubstring)")}return[e+"["+n+" : "+y+"]",Blockly.Python.ORDER_MEMBER]},Blockly.Python.text_changeCase=function(o){var t={UPPERCASE:".upper()",LOWERCASE:".lower()",TITLECASE:".title()"}[o.getFieldValue("CASE")];return[(Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_MEMBER)||"''")+t,Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text_trim=function(o){var t={LEFT:".lstrip()",RIGHT:".rstrip()",BOTH:".strip()"}[o.getFieldValue("MODE")];return[(Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_MEMBER)||"''")+t,Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text_print=function(o){return"print("+(Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_NONE)||"''")+")\n"},Blockly.Python.text_prompt_ext=function(o){var t=Blockly.Python.provideFunction_("text_prompt",["def "+Blockly.Python.FUNCTION_NAME_PLACEHOLDER_+"(msg):","  try:","    return raw_input(msg)","  except NameError:","    return input(msg)"]);if(o.getField("TEXT"))var l=Blockly.Python.quote_(o.getFieldValue("TEXT"));else l=Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_NONE)||"''";var e=t+"("+l+")";return"NUMBER"==o.getFieldValue("TYPE")&&(e="float("+e+")"),[e,Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text_prompt=Blockly.Python.text_prompt_ext,Blockly.Python.text_count=function(o){return[(Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_MEMBER)||"''")+".count("+(Blockly.Python.valueToCode(o,"SUB",Blockly.Python.ORDER_NONE)||"''")+")",Blockly.Python.ORDER_FUNCTION_CALL]},Blockly.Python.text_replace=function(o){return[(Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_MEMBER)||"''")+".replace("+(Blockly.Python.valueToCode(o,"FROM",Blockly.Python.ORDER_NONE)||"''")+", "+(Blockly.Python.valueToCode(o,"TO",Blockly.Python.ORDER_NONE)||"''")+")",Blockly.Python.ORDER_MEMBER]},Blockly.Python.text_reverse=function(o){return[(Blockly.Python.valueToCode(o,"TEXT",Blockly.Python.ORDER_MEMBER)||"''")+"[::-1]",Blockly.Python.ORDER_MEMBER]};