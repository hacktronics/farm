/**
 * @license
 * Copyright 2015 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.PHP.procedures"),goog.require("Blockly.PHP"),Blockly.PHP.procedures_defreturn=function(l){for(var P,e=[],o=l.workspace,c=Blockly.Variables.allUsedVarModels(o)||[],r=0;P=c[r];r++){var B=P.name;-1==l.getVars().indexOf(B)&&e.push(Blockly.PHP.nameDB_.getName(B,Blockly.VARIABLE_CATEGORY_NAME))}var n=Blockly.Variables.allDeveloperVariables(o);for(r=0;r<n.length;r++)e.push(Blockly.PHP.nameDB_.getName(n[r],Blockly.Names.DEVELOPER_VARIABLE_TYPE));e=e.length?Blockly.PHP.INDENT+"global "+e.join(", ")+";\n":"";var k=Blockly.PHP.nameDB_.getName(l.getFieldValue("NAME"),Blockly.PROCEDURE_CATEGORY_NAME),y="";Blockly.PHP.STATEMENT_PREFIX&&(y+=Blockly.PHP.injectId(Blockly.PHP.STATEMENT_PREFIX,l)),Blockly.PHP.STATEMENT_SUFFIX&&(y+=Blockly.PHP.injectId(Blockly.PHP.STATEMENT_SUFFIX,l)),y&&(y=Blockly.PHP.prefixLines(y,Blockly.PHP.INDENT));var E="";Blockly.PHP.INFINITE_LOOP_TRAP&&(E=Blockly.PHP.prefixLines(Blockly.PHP.injectId(Blockly.PHP.INFINITE_LOOP_TRAP,l),Blockly.PHP.INDENT));var a=Blockly.PHP.statementToCode(l,"STACK"),N=Blockly.PHP.valueToCode(l,"RETURN",Blockly.PHP.ORDER_NONE)||"",H="";a&&N&&(H=y),N&&(N=Blockly.PHP.INDENT+"return "+N+";\n");var t=[];for(c=l.getVars(),r=0;r<c.length;r++)t[r]=Blockly.PHP.nameDB_.getName(c[r],Blockly.VARIABLE_CATEGORY_NAME);var u="function "+k+"("+t.join(", ")+") {\n"+e+y+E+a+H+N+"}";return u=Blockly.PHP.scrub_(l,u),Blockly.PHP.definitions_["%"+k]=u,null},Blockly.PHP.procedures_defnoreturn=Blockly.PHP.procedures_defreturn,Blockly.PHP.procedures_callreturn=function(l){for(var P=Blockly.PHP.nameDB_.getName(l.getFieldValue("NAME"),Blockly.PROCEDURE_CATEGORY_NAME),e=[],o=l.getVars(),c=0;c<o.length;c++)e[c]=Blockly.PHP.valueToCode(l,"ARG"+c,Blockly.PHP.ORDER_NONE)||"null";return[P+"("+e.join(", ")+")",Blockly.PHP.ORDER_FUNCTION_CALL]},Blockly.PHP.procedures_callnoreturn=function(l){return Blockly.PHP.procedures_callreturn(l)[0]+";\n"},Blockly.PHP.procedures_ifreturn=function(l){var P="if ("+(Blockly.PHP.valueToCode(l,"CONDITION",Blockly.PHP.ORDER_NONE)||"false")+") {\n";if(Blockly.PHP.STATEMENT_SUFFIX&&(P+=Blockly.PHP.prefixLines(Blockly.PHP.injectId(Blockly.PHP.STATEMENT_SUFFIX,l),Blockly.PHP.INDENT)),l.hasReturnValue_){var e=Blockly.PHP.valueToCode(l,"VALUE",Blockly.PHP.ORDER_NONE)||"null";P+=Blockly.PHP.INDENT+"return "+e+";\n"}else P+=Blockly.PHP.INDENT+"return;\n";return P+="}\n"};