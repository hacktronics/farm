/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.JavaScript.loops"),goog.require("Blockly.JavaScript"),Blockly.JavaScript.controls_repeat_ext=function(a){if(a.getField("TIMES"))var l=String(Number(a.getFieldValue("TIMES")));else l=Blockly.JavaScript.valueToCode(a,"TIMES",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0";var c=Blockly.JavaScript.statementToCode(a,"DO");c=Blockly.JavaScript.addLoopTrap(c,a);var t="",o=Blockly.JavaScript.nameDB_.getDistinctName("count",Blockly.VARIABLE_CATEGORY_NAME),r=l;return l.match(/^\w+$/)||Blockly.isNumber(l)||(t+="var "+(r=Blockly.JavaScript.nameDB_.getDistinctName("repeat_end",Blockly.VARIABLE_CATEGORY_NAME))+" = "+l+";\n"),t+="for (var "+o+" = 0; "+o+" < "+r+"; "+o+"++) {\n"+c+"}\n"},Blockly.JavaScript.controls_repeat=Blockly.JavaScript.controls_repeat_ext,Blockly.JavaScript.controls_whileUntil=function(a){var l="UNTIL"==a.getFieldValue("MODE"),c=Blockly.JavaScript.valueToCode(a,"BOOL",l?Blockly.JavaScript.ORDER_LOGICAL_NOT:Blockly.JavaScript.ORDER_NONE)||"false",t=Blockly.JavaScript.statementToCode(a,"DO");return l&&(c="!"+c),"while ("+c+") {\n"+(t=Blockly.JavaScript.addLoopTrap(t,a))+"}\n"},Blockly.JavaScript.controls_for=function(a){var l,c=Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),t=Blockly.JavaScript.valueToCode(a,"FROM",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",o=Blockly.JavaScript.valueToCode(a,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",r=Blockly.JavaScript.valueToCode(a,"BY",Blockly.JavaScript.ORDER_ASSIGNMENT)||"1",e=Blockly.JavaScript.statementToCode(a,"DO");if(e=Blockly.JavaScript.addLoopTrap(e,a),Blockly.isNumber(t)&&Blockly.isNumber(o)&&Blockly.isNumber(r)){var i=parseFloat(t)<=parseFloat(o);l="for ("+c+" = "+t+"; "+c+(i?" <= ":" >= ")+o+"; "+c;var B=Math.abs(parseFloat(r));l+=1==B?i?"++":"--":(i?" += ":" -= ")+B,l+=") {\n"+e+"}\n"}else{l="";var n=t;t.match(/^\w+$/)||Blockly.isNumber(t)||(l+="var "+(n=Blockly.JavaScript.nameDB_.getDistinctName(c+"_start",Blockly.VARIABLE_CATEGORY_NAME))+" = "+t+";\n");var v=o;o.match(/^\w+$/)||Blockly.isNumber(o)||(l+="var "+(v=Blockly.JavaScript.nameDB_.getDistinctName(c+"_end",Blockly.VARIABLE_CATEGORY_NAME))+" = "+o+";\n");var S=Blockly.JavaScript.nameDB_.getDistinctName(c+"_inc",Blockly.VARIABLE_CATEGORY_NAME);l+="var "+S+" = ",Blockly.isNumber(r)?l+=Math.abs(r)+";\n":l+="Math.abs("+r+");\n",l+="if ("+n+" > "+v+") {\n",l+=Blockly.JavaScript.INDENT+S+" = -"+S+";\n",l+="}\n",l+="for ("+c+" = "+n+"; "+S+" >= 0 ? "+c+" <= "+v+" : "+c+" >= "+v+"; "+c+" += "+S+") {\n"+e+"}\n"}return l},Blockly.JavaScript.controls_forEach=function(a){var l=Blockly.JavaScript.nameDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),c=Blockly.JavaScript.valueToCode(a,"LIST",Blockly.JavaScript.ORDER_ASSIGNMENT)||"[]",t=Blockly.JavaScript.statementToCode(a,"DO");t=Blockly.JavaScript.addLoopTrap(t,a);var o="",r=c;c.match(/^\w+$/)||(o+="var "+(r=Blockly.JavaScript.nameDB_.getDistinctName(l+"_list",Blockly.VARIABLE_CATEGORY_NAME))+" = "+c+";\n");var e=Blockly.JavaScript.nameDB_.getDistinctName(l+"_index",Blockly.VARIABLE_CATEGORY_NAME);return o+="for (var "+e+" in "+r+") {\n"+(t=Blockly.JavaScript.INDENT+l+" = "+r+"["+e+"];\n"+t)+"}\n"},Blockly.JavaScript.controls_flow_statements=function(a){var l="";if(Blockly.JavaScript.STATEMENT_PREFIX&&(l+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,a)),Blockly.JavaScript.STATEMENT_SUFFIX&&(l+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,a)),Blockly.JavaScript.STATEMENT_PREFIX){var c=Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(a);c&&!c.suppressPrefixSuffix&&(l+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,c))}switch(a.getFieldValue("FLOW")){case"BREAK":return l+"break;\n";case"CONTINUE":return l+"continue;\n"}throw Error("Unknown flow statement.")};