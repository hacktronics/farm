/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.JavaScript"),goog.require("Blockly.Generator"),goog.require("Blockly.inputTypes"),goog.require("Blockly.utils.global"),goog.require("Blockly.utils.object"),goog.require("Blockly.utils.string"),Blockly.JavaScript=new Blockly.Generator("JavaScript"),Blockly.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(Blockly.utils.global).join(",")),Blockly.JavaScript.ORDER_ATOMIC=0,Blockly.JavaScript.ORDER_NEW=1.1,Blockly.JavaScript.ORDER_MEMBER=1.2,Blockly.JavaScript.ORDER_FUNCTION_CALL=2,Blockly.JavaScript.ORDER_INCREMENT=3,Blockly.JavaScript.ORDER_DECREMENT=3,Blockly.JavaScript.ORDER_BITWISE_NOT=4.1,Blockly.JavaScript.ORDER_UNARY_PLUS=4.2,Blockly.JavaScript.ORDER_UNARY_NEGATION=4.3,Blockly.JavaScript.ORDER_LOGICAL_NOT=4.4,Blockly.JavaScript.ORDER_TYPEOF=4.5,Blockly.JavaScript.ORDER_VOID=4.6,Blockly.JavaScript.ORDER_DELETE=4.7,Blockly.JavaScript.ORDER_AWAIT=4.8,Blockly.JavaScript.ORDER_EXPONENTIATION=5,Blockly.JavaScript.ORDER_MULTIPLICATION=5.1,Blockly.JavaScript.ORDER_DIVISION=5.2,Blockly.JavaScript.ORDER_MODULUS=5.3,Blockly.JavaScript.ORDER_SUBTRACTION=6.1,Blockly.JavaScript.ORDER_ADDITION=6.2,Blockly.JavaScript.ORDER_BITWISE_SHIFT=7,Blockly.JavaScript.ORDER_RELATIONAL=8,Blockly.JavaScript.ORDER_IN=8,Blockly.JavaScript.ORDER_INSTANCEOF=8,Blockly.JavaScript.ORDER_EQUALITY=9,Blockly.JavaScript.ORDER_BITWISE_AND=10,Blockly.JavaScript.ORDER_BITWISE_XOR=11,Blockly.JavaScript.ORDER_BITWISE_OR=12,Blockly.JavaScript.ORDER_LOGICAL_AND=13,Blockly.JavaScript.ORDER_LOGICAL_OR=14,Blockly.JavaScript.ORDER_CONDITIONAL=15,Blockly.JavaScript.ORDER_ASSIGNMENT=16,Blockly.JavaScript.ORDER_YIELD=17,Blockly.JavaScript.ORDER_COMMA=18,Blockly.JavaScript.ORDER_NONE=99,Blockly.JavaScript.ORDER_OVERRIDES=[[Blockly.JavaScript.ORDER_FUNCTION_CALL,Blockly.JavaScript.ORDER_MEMBER],[Blockly.JavaScript.ORDER_FUNCTION_CALL,Blockly.JavaScript.ORDER_FUNCTION_CALL],[Blockly.JavaScript.ORDER_MEMBER,Blockly.JavaScript.ORDER_MEMBER],[Blockly.JavaScript.ORDER_MEMBER,Blockly.JavaScript.ORDER_FUNCTION_CALL],[Blockly.JavaScript.ORDER_LOGICAL_NOT,Blockly.JavaScript.ORDER_LOGICAL_NOT],[Blockly.JavaScript.ORDER_MULTIPLICATION,Blockly.JavaScript.ORDER_MULTIPLICATION],[Blockly.JavaScript.ORDER_ADDITION,Blockly.JavaScript.ORDER_ADDITION],[Blockly.JavaScript.ORDER_LOGICAL_AND,Blockly.JavaScript.ORDER_LOGICAL_AND],[Blockly.JavaScript.ORDER_LOGICAL_OR,Blockly.JavaScript.ORDER_LOGICAL_OR]],Blockly.JavaScript.isInitialized=!1,Blockly.JavaScript.init=function(l){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new Blockly.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(l.getVariableMap()),this.nameDB_.populateVariables(l),this.nameDB_.populateProcedures(l);for(var t=[],a=Blockly.Variables.allDeveloperVariables(l),i=0;i<a.length;i++)t.push(this.nameDB_.getName(a[i],Blockly.Names.DEVELOPER_VARIABLE_TYPE));var c=Blockly.Variables.allUsedVarModels(l);for(i=0;i<c.length;i++)t.push(this.nameDB_.getName(c[i].getId(),Blockly.VARIABLE_CATEGORY_NAME));t.length&&(this.definitions_.variables="var "+t.join(", ")+";"),this.isInitialized=!0},Blockly.JavaScript.finish=function(l){var t=Blockly.utils.object.values(this.definitions_);return l=Object.getPrototypeOf(this).finish.call(this,l),this.isInitialized=!1,this.nameDB_.reset(),t.join("\n\n")+"\n\n\n"+l},Blockly.JavaScript.scrubNakedValue=function(l){return l+";\n"},Blockly.JavaScript.quote_=function(l){return"'"+(l=l.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},Blockly.JavaScript.multiline_quote_=function(l){return l.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},Blockly.JavaScript.scrub_=function(l,t,a){var i="";if(!l.outputConnection||!l.outputConnection.targetConnection){var c=l.getCommentText();c&&(c=Blockly.utils.string.wrap(c,this.COMMENT_WRAP-3),i+=this.prefixLines(c+"\n","// "));for(var e=0;e<l.inputList.length;e++)if(l.inputList[e].type==Blockly.inputTypes.VALUE){var o=l.inputList[e].connection.targetBlock();o&&(c=this.allNestedComments(o))&&(i+=this.prefixLines(c,"// "))}}var r=l.nextConnection&&l.nextConnection.targetBlock();return i+t+(a?"":this.blockToCode(r))},Blockly.JavaScript.getAdjusted=function(l,t,a,i,c){var e=a||0,o=c||this.ORDER_NONE;l.workspace.options.oneBasedIndex&&e--;var r=l.workspace.options.oneBasedIndex?"1":"0";if(e>0)var R=this.valueToCode(l,t,this.ORDER_ADDITION)||r;else if(e<0)R=this.valueToCode(l,t,this.ORDER_SUBTRACTION)||r;else if(i)R=this.valueToCode(l,t,this.ORDER_UNARY_NEGATION)||r;else R=this.valueToCode(l,t,o)||r;if(Blockly.isNumber(R))R=Number(R)+e,i&&(R=-R);else{if(e>0){R=R+" + "+e;var O=this.ORDER_ADDITION}else if(e<0){R=R+" - "+-e;O=this.ORDER_SUBTRACTION}if(i){R=e?"-("+R+")":"-"+R;O=this.ORDER_UNARY_NEGATION}O=Math.floor(O),o=Math.floor(o),O&&o>=O&&(R="("+R+")")}return R};