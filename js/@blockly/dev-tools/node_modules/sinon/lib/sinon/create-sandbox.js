"use strict";var arrayProto=require("@sinonjs/commons").prototypes.array,Sandbox=require("./sandbox"),forEach=arrayProto.forEach,push=arrayProto.push;function prepareSandboxFromConfig(e){var r=new Sandbox;return e.useFakeServer&&("object"==typeof e.useFakeServer&&(r.serverPrototype=e.useFakeServer),r.useFakeServer()),e.useFakeTimers&&("object"==typeof e.useFakeTimers?r.useFakeTimers(e.useFakeTimers):r.useFakeTimers()),r}function exposeValue(e,r,o,a){a&&(r.injectInto&&!(o in r.injectInto)?(r.injectInto[o]=a,push(e.injectedKeys,o)):push(e.args,a))}function createSandbox(e){if(!e)return new Sandbox;var r=prepareSandboxFromConfig(e);r.args=r.args||[],r.injectedKeys=[],r.injectInto=e.injectInto;var o=r.inject({});return e.properties?forEach(e.properties,function(a){var n=o[a]||"sandbox"===a&&r;exposeValue(r,e,a,n)}):exposeValue(r,e,"sandbox"),r}module.exports=createSandbox;