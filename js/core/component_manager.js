/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.ComponentManager"),goog.requireType("Blockly.IAutoHideable"),goog.requireType("Blockly.IComponent"),goog.requireType("Blockly.IDeleteArea"),goog.requireType("Blockly.IDragTarget"),goog.requireType("Blockly.IPositionable"),Blockly.ComponentManager=function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)},Blockly.ComponentManager.ComponentDatum,Blockly.ComponentManager.prototype.addComponent=function(o,t){var n=o.component.id;if(!t&&this.componentData_[n])throw Error('Plugin "'+n+'" with capabilities "'+this.componentData_[n].capabilities+'" already added.');this.componentData_[n]=o;for(var a=[],e=0;e<o.capabilities.length;e++){var i=String(o.capabilities[e]).toLowerCase();a.push(i),void 0===this.capabilityToComponentIds_[i]?this.capabilityToComponentIds_[i]=[n]:this.capabilityToComponentIds_[i].push(n)}this.componentData_[n].capabilities=a},Blockly.ComponentManager.prototype.removeComponent=function(o){var t=this.componentData_[o];if(t){for(var n=0;n<t.capabilities.length;n++){var a=String(t.capabilities[n]).toLowerCase();this.capabilityToComponentIds_[a].splice(this.capabilityToComponentIds_[a].indexOf(o),1)}delete this.componentData_[o]}},Blockly.ComponentManager.prototype.addCapability=function(o,t){if(!this.getComponent(o))throw Error('Cannot add capability, "'+t+'". Plugin "'+o+'" has not been added to the ComponentManager');this.hasCapability(o,t)?console.warn('Plugin "'+o+'already has capability "'+t+'"'):(t=String(t).toLowerCase(),this.componentData_[o].capabilities.push(t),this.capabilityToComponentIds_[t].push(o))},Blockly.ComponentManager.prototype.removeCapability=function(o,t){if(!this.getComponent(o))throw Error('Cannot remove capability, "'+t+'". Plugin "'+o+'" has not been added to the ComponentManager');this.hasCapability(o,t)?(t=String(t).toLowerCase(),this.componentData_[o].capabilities.splice(this.componentData_[o].capabilities.indexOf(t),1),this.capabilityToComponentIds_[t].splice(this.capabilityToComponentIds_[t].indexOf(o),1)):console.warn('Plugin "'+o+"doesn't have capability \""+t+'" to remove')},Blockly.ComponentManager.prototype.hasCapability=function(o,t){return t=String(t).toLowerCase(),-1!==this.componentData_[o].capabilities.indexOf(t)},Blockly.ComponentManager.prototype.getComponent=function(o){return this.componentData_[o]&&this.componentData_[o].component},Blockly.ComponentManager.prototype.getComponents=function(o,t){o=String(o).toLowerCase();var n=this.capabilityToComponentIds_[o];if(!n)return[];var a=[];if(t){var e=[],i=this.componentData_;n.forEach(function(o){e.push(i[o])}),e.sort(function(o,t){return o.weight-t.weight}),e.forEach(function(o){a.push(o.component)})}else{i=this.componentData_;n.forEach(function(o){a.push(i[o].component)})}return a},Blockly.ComponentManager.Capability=function(o){this.name_=o},Blockly.ComponentManager.Capability.prototype.toString=function(){return this.name_},Blockly.ComponentManager.Capability.POSITIONABLE=new Blockly.ComponentManager.Capability("positionable"),Blockly.ComponentManager.Capability.DRAG_TARGET=new Blockly.ComponentManager.Capability("drag_target"),Blockly.ComponentManager.Capability.DELETE_AREA=new Blockly.ComponentManager.Capability("delete_area"),Blockly.ComponentManager.Capability.AUTOHIDEABLE=new Blockly.ComponentManager.Capability("autohideable");