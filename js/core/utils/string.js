/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.utils.string"),Blockly.utils.string.startsWith=function(t,r){return 0==t.lastIndexOf(r,0)},Blockly.utils.string.shortestStringLength=function(t){return t.length?t.reduce(function(t,r){return t.length<r.length?t:r}).length:0},Blockly.utils.string.commonWordPrefix=function(t,r){if(!t.length)return 0;if(1==t.length)return t[0].length;for(var n=0,l=r||Blockly.utils.string.shortestStringLength(t),e=0;e<l;e++){for(var i=t[0][e],o=1;o<t.length;o++)if(i!=t[o][e])return n;" "==i&&(n=e+1)}for(o=1;o<t.length;o++){if((i=t[o][e])&&" "!=i)return n}return l},Blockly.utils.string.commonWordSuffix=function(t,r){if(!t.length)return 0;if(1==t.length)return t[0].length;for(var n=0,l=r||Blockly.utils.string.shortestStringLength(t),e=0;e<l;e++){for(var i=t[0].substr(-e-1,1),o=1;o<t.length;o++)if(i!=t[o].substr(-e-1,1))return n;" "==i&&(n=e+1)}for(o=1;o<t.length;o++){if((i=t[o].charAt(t[o].length-e-1))&&" "!=i)return n}return l},Blockly.utils.string.wrap=function(t,r){for(var n=t.split("\n"),l=0;l<n.length;l++)n[l]=Blockly.utils.string.wrapLine_(n[l],r);return n.join("\n")},Blockly.utils.string.wrapLine_=function(t,r){if(t.length<=r)return t;for(var n,l=t.trim().split(/\s+/),e=0;e<l.length;e++)l[e].length>r&&(r=l[e].length);var i,o=-1/0,s=1;do{n=o,i=t;var g=[],u=l.length/s,h=1;for(e=0;e<l.length-1;e++)h<(e+1.5)/u?(h++,g[e]=!0):g[e]=!1;g=Blockly.utils.string.wrapMutate_(l,g,r),o=Blockly.utils.string.wrapScore_(l,g,r),t=Blockly.utils.string.wrapToText_(l,g),s++}while(o>n);return i},Blockly.utils.string.wrapScore_=function(t,r,n){for(var l=[0],e=[],i=0;i<t.length;i++)l[l.length-1]+=t[i].length,!0===r[i]?(l.push(0),e.push(t[i].charAt(t[i].length-1))):!1===r[i]&&l[l.length-1]++;var o=Math.max.apply(Math,l),s=0;for(i=0;i<l.length;i++)s-=2*Math.pow(Math.abs(n-l[i]),1.5),s-=Math.pow(o-l[i],1.5),-1!=".?!".indexOf(e[i])?s+=n/3:-1!=",;)]}".indexOf(e[i])&&(s+=n/4);return l.length>1&&l[l.length-1]<=l[l.length-2]&&(s+=.5),s},Blockly.utils.string.wrapMutate_=function(t,r,n){for(var l,e=Blockly.utils.string.wrapScore_(t,r,n),i=0;i<r.length-1;i++)if(r[i]!=r[i+1]){var o=[].concat(r);o[i]=!o[i],o[i+1]=!o[i+1];var s=Blockly.utils.string.wrapScore_(t,o,n);s>e&&(e=s,l=o)}return l?Blockly.utils.string.wrapMutate_(t,l,n):r},Blockly.utils.string.wrapToText_=function(t,r){for(var n=[],l=0;l<t.length;l++)n.push(t[l]),void 0!==r[l]&&n.push(r[l]?"\n":" ");return n.join("")};