/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
goog.provide("Blockly.blockRendering.BottomRow"),goog.provide("Blockly.blockRendering.InputRow"),goog.provide("Blockly.blockRendering.Row"),goog.provide("Blockly.blockRendering.SpacerRow"),goog.provide("Blockly.blockRendering.TopRow"),goog.require("Blockly.blockRendering.InputConnection"),goog.require("Blockly.blockRendering.InRowSpacer"),goog.require("Blockly.blockRendering.Measurable"),goog.require("Blockly.blockRendering.NextConnection"),goog.require("Blockly.blockRendering.PreviousConnection"),goog.require("Blockly.blockRendering.Types"),goog.require("Blockly.utils.object"),goog.requireType("Blockly.blockRendering.ConstantProvider"),goog.requireType("Blockly.BlockSvg"),Blockly.blockRendering.Row=function(e){this.type=Blockly.blockRendering.Types.ROW,this.elements=[],this.height=0,this.width=0,this.minHeight=0,this.minWidth=0,this.widthWithConnectedBlocks=0,this.yPos=0,this.xPos=0,this.hasExternalInput=!1,this.hasStatement=!1,this.hasInlineInput=!1,this.hasDummyInput=!1,this.hasJaggedEdge=!1,this.isCollapsedStack=!1,this.constants_=e,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},Blockly.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},Blockly.blockRendering.Row.prototype.getLastInput=function(){for(var e,o=this.elements.length-1;e=this.elements[o];o--)if(Blockly.blockRendering.Types.isInput(e))return e;return null},Blockly.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},Blockly.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},Blockly.blockRendering.Row.prototype.getFirstSpacer=function(){for(var e,o=0;e=this.elements[o];o++)if(Blockly.blockRendering.Types.isSpacer(e))return e;return null},Blockly.blockRendering.Row.prototype.getLastSpacer=function(){for(var e,o=this.elements.length-1;e=this.elements[o];o--)if(Blockly.blockRendering.Types.isSpacer(e))return e;return null},Blockly.blockRendering.TopRow=function(e){Blockly.blockRendering.TopRow.superClass_.constructor.call(this,e),this.type|=Blockly.blockRendering.Types.TOP_ROW,this.capline=0,this.ascenderHeight=0,this.hasPreviousConnection=!1,this.connection=null},Blockly.utils.object.inherits(Blockly.blockRendering.TopRow,Blockly.blockRendering.Row),Blockly.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(e){var o=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,t=e.getPreviousBlock();return!!e.outputConnection||o||!!t&&t.getNextBlock()==e},Blockly.blockRendering.TopRow.prototype.hasRightSquareCorner=function(e){return!0},Blockly.blockRendering.TopRow.prototype.measure=function(){for(var e,o=0,t=0,n=0,i=0;e=this.elements[i];i++)t+=e.width,Blockly.blockRendering.Types.isSpacer(e)||(Blockly.blockRendering.Types.isHat(e)?n=Math.max(n,e.ascenderHeight):o=Math.max(o,e.height));this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,o)+n,this.ascenderHeight=n,this.capline=this.ascenderHeight,this.widthWithConnectedBlocks=this.width},Blockly.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},Blockly.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},Blockly.blockRendering.BottomRow=function(e){Blockly.blockRendering.BottomRow.superClass_.constructor.call(this,e),this.type|=Blockly.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.descenderHeight=0,this.baseline=0},Blockly.utils.object.inherits(Blockly.blockRendering.BottomRow,Blockly.blockRendering.Row),Blockly.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection||!!e.getNextBlock()},Blockly.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(e){return!0},Blockly.blockRendering.BottomRow.prototype.measure=function(){for(var e,o=0,t=0,n=0,i=0;e=this.elements[i];i++)t+=e.width,Blockly.blockRendering.Types.isSpacer(e)||(Blockly.blockRendering.Types.isNextConnection(e)?n=Math.max(n,e.height):o=Math.max(o,e.height));this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,o)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width},Blockly.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},Blockly.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},Blockly.blockRendering.SpacerRow=function(e,o,t){Blockly.blockRendering.SpacerRow.superClass_.constructor.call(this,e),this.type|=Blockly.blockRendering.Types.SPACER|Blockly.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=t,this.height=o,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new Blockly.blockRendering.InRowSpacer(this.constants_,t)]},Blockly.utils.object.inherits(Blockly.blockRendering.SpacerRow,Blockly.blockRendering.Row),Blockly.blockRendering.SpacerRow.prototype.measure=function(){},Blockly.blockRendering.InputRow=function(e){Blockly.blockRendering.InputRow.superClass_.constructor.call(this,e),this.type|=Blockly.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},Blockly.utils.object.inherits(Blockly.blockRendering.InputRow,Blockly.blockRendering.Row),Blockly.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var e,o=0,t=0;e=this.elements[t];t++)this.width+=e.width,Blockly.blockRendering.Types.isInput(e)&&(Blockly.blockRendering.Types.isStatementInput(e)?o+=e.connectedBlockWidth:Blockly.blockRendering.Types.isExternalInput(e)&&0!=e.connectedBlockWidth&&(o+=e.connectedBlockWidth-e.connectionWidth)),Blockly.blockRendering.Types.isSpacer(e)||(this.height=Math.max(this.height,e.height));this.connectedBlockWidths=o,this.widthWithConnectedBlocks=this.width+o},Blockly.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement};