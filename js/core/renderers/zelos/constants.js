/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.zelos.ConstantProvider"),goog.require("Blockly.blockRendering.ConstantProvider"),goog.require("Blockly.connectionTypes"),goog.require("Blockly.constants"),goog.require("Blockly.utils.colour"),goog.require("Blockly.utils.dom"),goog.require("Blockly.utils.object"),goog.require("Blockly.utils.Svg"),goog.require("Blockly.utils.svgPaths"),Blockly.zelos.ConstantProvider=function(){Blockly.zelos.ConstantProvider.superClass_.constructor.call(this),this.GRID_UNIT=4,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_HEIGHT=0,this.JAGGED_TEETH_WIDTH=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_COLOURED_DIV=!0,this.FIELD_DROPDOWN_SVG_ARROW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_FULL_BLOCK=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},Blockly.utils.object.inherits(Blockly.zelos.ConstantProvider,Blockly.blockRendering.ConstantProvider),Blockly.zelos.ConstantProvider.prototype.setFontConstants_=function(t){Blockly.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,t),this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT},Blockly.zelos.ConstantProvider.prototype.init=function(){Blockly.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},Blockly.zelos.ConstantProvider.prototype.setDynamicProperties_=function(t){Blockly.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var l=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=l&&!isNaN(l)?l:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR;var o=Number(t.getComponentStyle("replacementGlowSize"));this.REPLACEMENT_GLOW_SIZE=o&&!isNaN(o)?o:this.REPLACEMENT_GLOW_SIZE},Blockly.zelos.ConstantProvider.prototype.dispose=function(){Blockly.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&Blockly.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&Blockly.utils.dom.removeNode(this.replacementGlowFilter_)},Blockly.zelos.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,l=this.START_HAT_WIDTH;return{height:t,width:l,path:Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(25,-t),Blockly.utils.svgPaths.point(71,-t),Blockly.utils.svgPaths.point(l,0)])}},Blockly.zelos.ConstantProvider.prototype.makeHexagonal=function(){var t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;function l(l,o,i){var e=l/2,s=e>t?t:e,n=i?-1:1,r=(o?-1:1)*l/2;return Blockly.utils.svgPaths.lineTo(-n*s,r)+Blockly.utils.svgPaths.lineTo(n*s,r)}return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(l){var o=l/2;return o>t?t:o},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(t){return l(t,!1,!1)},pathUp:function(t){return l(t,!0,!1)},pathRightDown:function(t){return l(t,!1,!0)},pathRightUp:function(t){return l(t,!1,!0)}}},Blockly.zelos.ConstantProvider.prototype.makeRounded=function(){var t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,l=2*t;function o(t,o,i){var e=t>l?t-l:0,s=(t>l?l:t)/2;return Blockly.utils.svgPaths.arc("a","0 0,1",s,Blockly.utils.svgPaths.point((o?-1:1)*s,(o?-1:1)*s))+Blockly.utils.svgPaths.lineOnAxis("v",(i?1:-1)*e)+Blockly.utils.svgPaths.arc("a","0 0,1",s,Blockly.utils.svgPaths.point((o?1:-1)*s,(o?-1:1)*s))}return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(l){var o=l/2;return o>t?t:o},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(t){return o(t,!1,!1)},pathUp:function(t){return o(t,!0,!1)},pathRightDown:function(t){return o(t,!1,!0)},pathRightUp:function(t){return o(t,!1,!0)}}},Blockly.zelos.ConstantProvider.prototype.makeSquared=function(){var t=this.CORNER_RADIUS;function l(l,o,i){var e=l-2*t;return Blockly.utils.svgPaths.arc("a","0 0,1",t,Blockly.utils.svgPaths.point((o?-1:1)*t,(o?-1:1)*t))+Blockly.utils.svgPaths.lineOnAxis("v",(i?1:-1)*e)+Blockly.utils.svgPaths.arc("a","0 0,1",t,Blockly.utils.svgPaths.point((o?1:-1)*t,(o?-1:1)*t))}return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(l){return t},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(t){return l(t,!1,!1)},pathUp:function(t){return l(t,!0,!1)},pathRightDown:function(t){return l(t,!1,!0)},pathRightUp:function(t){return l(t,!1,!0)}}},Blockly.zelos.ConstantProvider.prototype.shapeFor=function(t){var l=t.getCheck();switch(!l&&t.targetConnection&&(l=t.targetConnection.getCheck()),t.type){case Blockly.connectionTypes.OUTPUT_VALUE:var o=t.getSourceBlock().getOutputShape();if(null!=o)switch(o){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}case Blockly.connectionTypes.INPUT_VALUE:return l&&-1!=l.indexOf("Boolean")?this.HEXAGONAL:(l&&-1!=l.indexOf("Number")||l&&l.indexOf("String"),this.ROUNDED);case Blockly.connectionTypes.PREVIOUS_STATEMENT:case Blockly.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},Blockly.zelos.ConstantProvider.prototype.makeNotch=function(){var t=this.NOTCH_WIDTH,l=this.NOTCH_HEIGHT,o=t/3,i=o/3,e=l/2,s=e/2;function n(t){return Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(t*i/2,0),Blockly.utils.svgPaths.point(t*i*3/4,s/2),Blockly.utils.svgPaths.point(t*i,s)])+Blockly.utils.svgPaths.line([Blockly.utils.svgPaths.point(t*i,e)])+Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(t*i/4,s/2),Blockly.utils.svgPaths.point(t*i/2,s),Blockly.utils.svgPaths.point(t*i,s)])+Blockly.utils.svgPaths.lineOnAxis("h",t*o)+Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(t*i/2,0),Blockly.utils.svgPaths.point(t*i*3/4,-s/2),Blockly.utils.svgPaths.point(t*i,-s)])+Blockly.utils.svgPaths.line([Blockly.utils.svgPaths.point(t*i,-e)])+Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(t*i/4,-s/2),Blockly.utils.svgPaths.point(t*i/2,-s),Blockly.utils.svgPaths.point(t*i,-s)])}var r=n(1),c=n(-1);return{type:this.SHAPES.NOTCH,width:t,height:l,pathLeft:r,pathRight:c}},Blockly.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS,l=Blockly.utils.svgPaths.arc("a","0 0,0",t,Blockly.utils.svgPaths.point(-t,t)),o=Blockly.utils.svgPaths.arc("a","0 0,1",t,Blockly.utils.svgPaths.point(-t,t));return{width:t,height:t,pathTop:l,pathBottom:Blockly.utils.svgPaths.arc("a","0 0,0",t,Blockly.utils.svgPaths.point(t,t)),rightWidth:t,rightHeight:t,pathTopRight:o,pathBottomRight:Blockly.utils.svgPaths.arc("a","0 0,1",t,Blockly.utils.svgPaths.point(t,t))}},Blockly.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(t){return Blockly.utils.colour.blend("#000",t,.15)||t},Blockly.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(t){return Blockly.utils.colour.blend("#000",t,.25)||t},Blockly.zelos.ConstantProvider.prototype.createDom=function(t,l,o){Blockly.zelos.ConstantProvider.superClass_.createDom.call(this,t,l,o);var i=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.DEFS,{},t),e=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},i);Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},e);var s=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e);Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},s),Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.selectedGlowFilterId=e.id,this.selectedGlowFilter_=e;var n=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},i);Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},n);var r=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},n);Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},n),Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n),Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},n),this.replacementGlowFilterId=n.id,this.replacementGlowFilter_=n},Blockly.zelos.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText,",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",t+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text,",t+" .blocklyNonEditableText>g>text,",t+" .blocklyEditableText>g>text {","fill: #575E75;","}",t+" .blocklyFlyoutLabelText {","fill: #575E75;","fill: #fff;","}",t+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",t+" .blocklyDropdownText {","fill: #fff !important;","}",t+".blocklyWidgetDiv .goog-menuitem,",t+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",t+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",t+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",t+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]};