/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.ThemeManager"),goog.require("Blockly.Theme"),goog.requireType("Blockly.Workspace"),goog.requireType("Blockly.WorkspaceSvg"),Blockly.ThemeManager=function(e,t){this.workspace_=e,this.theme_=t,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},Blockly.ThemeManager.Component,Blockly.ThemeManager.prototype.getTheme=function(){return this.theme_},Blockly.ThemeManager.prototype.setTheme=function(e){var t=this.theme_;this.theme_=e;var o=this.workspace_.getInjectionDiv();o&&(t&&Blockly.utils.dom.removeClass(o,t.getClassName()),Blockly.utils.dom.addClass(o,this.theme_.getClassName()));for(var s,r=0;s=this.subscribedWorkspaces_[r];r++)s.refreshTheme();r=0;for(var n,c=Object.keys(this.componentDB_);n=c[r];r++)for(var i,h=0;i=this.componentDB_[n][h];h++){var l=i.element,a=i.propertyName,p=this.theme_&&this.theme_.getComponentStyle(n);l.style[a]=p||""}Blockly.hideChaff()},Blockly.ThemeManager.prototype.subscribeWorkspace=function(e){this.subscribedWorkspaces_.push(e)},Blockly.ThemeManager.prototype.unsubscribeWorkspace=function(e){var t=this.subscribedWorkspaces_.indexOf(e);if(t<0)throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},Blockly.ThemeManager.prototype.subscribe=function(e,t,o){this.componentDB_[t]||(this.componentDB_[t]=[]),this.componentDB_[t].push({element:e,propertyName:o});var s=this.theme_&&this.theme_.getComponentStyle(t);e.style[o]=s||""},Blockly.ThemeManager.prototype.unsubscribe=function(e){if(e)for(var t,o=Object.keys(this.componentDB_),s=0;t=o[s];s++){for(var r=this.componentDB_[t],n=r.length-1;n>=0;n--)r[n].element===e&&r.splice(n,1);this.componentDB_[t].length||delete this.componentDB_[t]}},Blockly.ThemeManager.prototype.dispose=function(){this.owner_=null,this.theme_=null,this.subscribedWorkspaces_=null,this.componentDB_=null};