/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.MarkerManager"),goog.require("Blockly.Cursor"),goog.require("Blockly.Marker"),goog.requireType("Blockly.WorkspaceSvg"),Blockly.MarkerManager=function(r){this.cursor_=null,this.cursorSvg_=null,this.markers_=Object.create(null),this.workspace_=r},Blockly.MarkerManager.LOCAL_MARKER="local_marker_1",Blockly.MarkerManager.prototype.registerMarker=function(r,e){this.markers_[r]&&this.unregisterMarker(r),e.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,e)),this.setMarkerSvg(e.getDrawer().createDom()),this.markers_[r]=e},Blockly.MarkerManager.prototype.unregisterMarker=function(r){var e=this.markers_[r];if(!e)throw Error("Marker with ID "+r+" does not exist. Can only unregister markers that exist.");e.dispose(),delete this.markers_[r]},Blockly.MarkerManager.prototype.getCursor=function(){return this.cursor_},Blockly.MarkerManager.prototype.getMarker=function(r){return this.markers_[r]||null},Blockly.MarkerManager.prototype.setCursor=function(r){if(this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),this.cursor_=r,this.cursor_){var e=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_);this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom())}},Blockly.MarkerManager.prototype.setCursorSvg=function(r){r?(this.workspace_.getBlockCanvas().appendChild(r),this.cursorSvg_=r):this.cursorSvg_=null},Blockly.MarkerManager.prototype.setMarkerSvg=function(r){r?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(r,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(r)):this.markerSvg_=null},Blockly.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},Blockly.MarkerManager.prototype.dispose=function(){for(var r,e=Object.keys(this.markers_),s=0;r=e[s];s++)this.unregisterMarker(r);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)};