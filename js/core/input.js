/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Input"),goog.require("Blockly.Connection"),goog.require("Blockly.constants"),goog.require("Blockly.fieldRegistry"),goog.require("Blockly.FieldLabel"),goog.require("Blockly.inputTypes"),goog.requireType("Blockly.Block"),goog.requireType("Blockly.BlockSvg"),goog.requireType("Blockly.Field"),goog.requireType("Blockly.RenderedConnection"),Blockly.Input=function(o,t,e,i){if(o!=Blockly.inputTypes.DUMMY&&!t)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=o,this.name=t,this.sourceBlock_=e,this.connection=i,this.fieldRow=[]},Blockly.Input.prototype.align=Blockly.constants.ALIGN.LEFT,Blockly.Input.prototype.visible_=!0,Blockly.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},Blockly.Input.prototype.appendField=function(o,t){return this.insertFieldAt(this.fieldRow.length,o,t),this},Blockly.Input.prototype.insertFieldAt=function(o,t,e){if(o<0||o>this.fieldRow.length)throw Error("index "+o+" out of bounds.");return t||""==t&&e?("string"==typeof t&&(t=Blockly.fieldRegistry.fromJson({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(t.init(),t.applyColour()),t.name=e,t.setVisible(this.isVisible()),t.prefixField&&(o=this.insertFieldAt(o,t.prefixField)),this.fieldRow.splice(o,0,t),++o,t.suffixField&&(o=this.insertFieldAt(o,t.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),o):o},Blockly.Input.prototype.removeField=function(o,t){for(var e,i=0;e=this.fieldRow[i];i++)if(e.name===o)return e.dispose(),this.fieldRow.splice(i,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(t)return!1;throw Error('Field "'+o+'" not found.')},Blockly.Input.prototype.isVisible=function(){return this.visible_},Blockly.Input.prototype.setVisible=function(o){var t=[];if(this.visible_==o)return t;this.visible_=o;for(var e,i=0;e=this.fieldRow[i];i++)e.setVisible(o);if(this.connection){this.connection=this.connection,o?t=this.connection.startTrackingAll():this.connection.stopTrackingAll();var n=this.connection.targetBlock();n&&(n.getSvgRoot().style.display=o?"block":"none")}return t},Blockly.Input.prototype.markDirty=function(){for(var o,t=0;o=this.fieldRow[t];t++)o.markDirty()},Blockly.Input.prototype.setCheck=function(o){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(o),this},Blockly.Input.prototype.setAlign=function(o){return this.align=o,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},Blockly.Input.prototype.setShadowDom=function(o){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(o),this},Blockly.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},Blockly.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var o=0;o<this.fieldRow.length;o++)this.fieldRow[o].init(this.sourceBlock_)},Blockly.Input.prototype.dispose=function(){for(var o,t=0;o=this.fieldRow[t];t++)o.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null};