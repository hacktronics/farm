/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.FieldImage"),goog.require("Blockly.Field"),goog.require("Blockly.fieldRegistry"),goog.require("Blockly.utils"),goog.require("Blockly.utils.dom"),goog.require("Blockly.utils.object"),goog.require("Blockly.utils.Size"),goog.require("Blockly.utils.Svg"),Blockly.FieldImage=function(e,l,t,i,o,s,r){if(!e)throw Error("Src value of an image field is required");e=Blockly.utils.replaceMessageReferences(e);var a=Number(Blockly.utils.replaceMessageReferences(t)),c=Number(Blockly.utils.replaceMessageReferences(l));if(isNaN(a)||isNaN(c))throw Error("Height and width values of an image field must cast to numbers.");if(a<=0||c<=0)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",Blockly.FieldImage.superClass_.constructor.call(this,e,null,r),r||(this.flipRtl_=!!s,this.altText_=Blockly.utils.replaceMessageReferences(i)||""),this.size_=new Blockly.utils.Size(c,a+Blockly.FieldImage.Y_PADDING),this.imageHeight_=a,this.clickHandler_=null,"function"==typeof o&&(this.clickHandler_=o),this.imageElement_=null},Blockly.utils.object.inherits(Blockly.FieldImage,Blockly.Field),Blockly.FieldImage.prototype.DEFAULT_VALUE="",Blockly.FieldImage.fromJson=function(e){return new Blockly.FieldImage(e.src,e.width,e.height,void 0,void 0,void 0,e)},Blockly.FieldImage.Y_PADDING=1,Blockly.FieldImage.prototype.EDITABLE=!1,Blockly.FieldImage.prototype.SERIALIZABLE=!1,Blockly.FieldImage.prototype.isDirty_=!1,Blockly.FieldImage.prototype.configure_=function(e){Blockly.FieldImage.superClass_.configure_.call(this,e),this.flipRtl_=!!e.flipRtl,this.altText_=Blockly.utils.replaceMessageReferences(e.alt)||""},Blockly.FieldImage.prototype.initView=function(){this.imageElement_=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},Blockly.FieldImage.prototype.updateSize_=function(){},Blockly.FieldImage.prototype.doClassValidation_=function(e){return"string"!=typeof e?null:e},Blockly.FieldImage.prototype.doValueUpdate_=function(e){this.value_=e,this.imageElement_&&this.imageElement_.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},Blockly.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},Blockly.FieldImage.prototype.setAlt=function(e){e!=this.altText_&&(this.altText_=e||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},Blockly.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},Blockly.FieldImage.prototype.setOnClickHandler=function(e){this.clickHandler_=e},Blockly.FieldImage.prototype.getText_=function(){return this.altText_},Blockly.fieldRegistry.register("field_image",Blockly.FieldImage);