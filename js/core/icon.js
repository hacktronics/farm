/**
 * @license
 * Copyright 2013 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Icon"),goog.require("Blockly.browserEvents"),goog.require("Blockly.utils"),goog.require("Blockly.utils.Coordinate"),goog.require("Blockly.utils.dom"),goog.require("Blockly.utils.Size"),goog.require("Blockly.utils.Svg"),goog.requireType("Blockly.BlockSvg"),goog.requireType("Blockly.Bubble"),Blockly.Icon=function(o){this.block_=o,this.iconGroup_=null},Blockly.Icon.prototype.collapseHidden=!0,Blockly.Icon.prototype.SIZE=25,Blockly.Icon.prototype.bubble_=null,Blockly.Icon.prototype.iconXY_=null,Blockly.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&Blockly.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),Blockly.browserEvents.conditionalBind(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},Blockly.Icon.prototype.dispose=function(){Blockly.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},Blockly.Icon.prototype.updateEditable=function(){},Blockly.Icon.prototype.isVisible=function(){return!!this.bubble_},Blockly.Icon.prototype.iconClick_=function(o){this.block_.workspace.isDragging()||this.block_.isInFlyout||Blockly.utils.isRightButton(o)||this.setVisible(!this.isVisible())},Blockly.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary,this.block_.style.colourSecondary)},Blockly.Icon.prototype.renderIcon=function(o){if(this.collapseHidden&&this.block_.isCollapsed()||this.block_.isInsertionMarker())return this.iconGroup_.setAttribute("display","none"),o;this.iconGroup_.setAttribute("display","block");var t=this.SIZE;return this.block_.RTL&&(o-=t),this.iconGroup_.setAttribute("transform","translate("+o+",9),scale(1.4)"),this.computeIconLocation(),this.block_.RTL?o-=Blockly.BlockSvg.SEP_SPACE_X:o+=t+Blockly.BlockSvg.SEP_SPACE_X,o},Blockly.Icon.prototype.moveIcon=function(o,t){var l=this.SIZE;return this.block_.RTL&&(o-=l),this.iconGroup_.setAttribute("transform","translate("+o+","+(9+t)+"),scale(1.4)"),this.block_.RTL?o-=Blockly.BlockSvg.SEP_SPACE_X:o+=l+Blockly.BlockSvg.SEP_SPACE_X,o},Blockly.Icon.prototype.setIconLocation=function(o){this.iconXY_=o,this.isVisible()&&this.bubble_.setAnchorLocation(o)},Blockly.Icon.prototype.computeIconLocation=function(){var o=this.block_.getRelativeToSurfaceXY(),t=Blockly.utils.getRelativeXY(this.iconGroup_),l=new Blockly.utils.Coordinate(o.x+t.x+this.SIZE/2,o.y+t.y+this.SIZE/2);Blockly.utils.Coordinate.equals(this.getIconLocation(),l)||this.setIconLocation(l)},Blockly.Icon.prototype.getIconLocation=function(){return this.iconXY_},Blockly.Icon.prototype.getCorrectedSize=function(){return new Blockly.utils.Size(Blockly.Icon.prototype.SIZE,Blockly.Icon.prototype.SIZE-2)},Blockly.Icon.prototype.drawIcon_,Blockly.Icon.prototype.setVisible;