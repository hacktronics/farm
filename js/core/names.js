/**
 * @license
 * Copyright 2012 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.Names"),goog.require("Blockly.constants"),goog.require("Blockly.Msg"),goog.requireType("Blockly.VariableMap"),Blockly.Names=function(e,t){if(this.variablePrefix_=t||"",this.reservedDict_=Object.create(null),e)for(var a=e.split(","),r=0;r<a.length;r++)this.reservedDict_[a[r]]=!0;this.reset()},Blockly.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",Blockly.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},Blockly.Names.prototype.setVariableMap=function(e){this.variableMap_=e},Blockly.Names.prototype.getNameForUserVariable_=function(e){if(!this.variableMap_)return console.warn("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null;var t=this.variableMap_.getVariableById(e);return t?t.name:null},Blockly.Names.prototype.populateVariables=function(e){for(var t=Blockly.Variables.allUsedVarModels(e),a=0;a<t.length;a++)this.getName(t[a].getId(),Blockly.VARIABLE_CATEGORY_NAME)},Blockly.Names.prototype.populateProcedures=function(e){var t=Blockly.Procedures.allProcedures(e);t=t[0].concat(t[1]);for(var a=0;a<t.length;a++)this.getName(t[a][0],Blockly.PROCEDURE_CATEGORY_NAME)},Blockly.Names.prototype.getName=function(e,t){var a=e;if(t==Blockly.VARIABLE_CATEGORY_NAME){var r=this.getNameForUserVariable_(e);r&&(a=r)}var l=a.toLowerCase(),o=t==Blockly.VARIABLE_CATEGORY_NAME||t==Blockly.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";t in this.db_||(this.db_[t]=Object.create(null));var i=this.db_[t];if(l in i)return o+i[l];var s=this.getDistinctName(a,t);return i[l]=s.substr(o.length),s},Blockly.Names.prototype.getUserNames=function(e){var t=this.db_[e]||{};return Object.keys(t)},Blockly.Names.prototype.getDistinctName=function(e,t){for(var a=this.safeName_(e),r="";this.dbReverse_[a+r]||a+r in this.reservedDict_;)r=r?r+1:2;return a+=r,this.dbReverse_[a]=!0,(t==Blockly.VARIABLE_CATEGORY_NAME||t==Blockly.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+a},Blockly.Names.prototype.safeName_=function(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(e[0])&&(e="my_"+e)):e=Blockly.Msg.UNNAMED_KEY||"unnamed",e},Blockly.Names.equals=function(e,t){return e.toLowerCase()==t.toLowerCase()};