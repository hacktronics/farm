/**
 * @license
 * Copyright 2016 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";goog.provide("Blockly.BlockDragSurfaceSvg"),goog.require("Blockly.utils"),goog.require("Blockly.utils.Coordinate"),goog.require("Blockly.utils.dom"),goog.require("Blockly.utils.Svg"),Blockly.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},Blockly.BlockDragSurfaceSvg.prototype.SVG_=null,Blockly.BlockDragSurfaceSvg.prototype.dragGroup_=null,Blockly.BlockDragSurfaceSvg.prototype.container_=null,Blockly.BlockDragSurfaceSvg.prototype.scale_=1,Blockly.BlockDragSurfaceSvg.prototype.surfaceXY_=null,Blockly.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new Blockly.utils.Coordinate(0,0),Blockly.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.SVG,{xmlns:Blockly.utils.dom.SVG_NS,"xmlns:html":Blockly.utils.dom.HTML_NS,"xmlns:xlink":Blockly.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.G,{},this.SVG_))},Blockly.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new Blockly.utils.Coordinate(0,0),document.getElementsByClassName("injectionDiv")[0].style.overflow="visible"},Blockly.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,o,l){this.scale_=l;var r=t.toFixed(0),e=o.toFixed(0);this.childSurfaceXY_.x=parseInt(r,10),this.childSurfaceXY_.y=parseInt(e,10),this.dragGroup_.setAttribute("transform","translate("+r+","+e+") scale("+l+")")},Blockly.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,o=this.surfaceXY_.y;t=t.toFixed(0),o=o.toFixed(0),this.SVG_.style.display="block",Blockly.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+o+"px, 0px)")},Blockly.BlockDragSurfaceSvg.prototype.translateBy=function(t,o){var l=this.surfaceXY_.x+t,r=this.surfaceXY_.y+o;this.surfaceXY_=new Blockly.utils.Coordinate(l,r),this.translateSurfaceInternal_()},Blockly.BlockDragSurfaceSvg.prototype.translateSurface=function(t,o){this.surfaceXY_=new Blockly.utils.Coordinate(t*this.scale_,o*this.scale_),this.translateSurfaceInternal_()},Blockly.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=Blockly.utils.getRelativeXY(this.SVG_);return new Blockly.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},Blockly.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},Blockly.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},Blockly.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},Blockly.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},Blockly.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?this.getCurrentBlock()&&t.appendChild(this.getCurrentBlock()):this.getCurrentBlock()&&this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null,document.getElementsByClassName("injectionDiv")[0].style.overflow="hidden"},Blockly.BlockDragSurfaceSvg.prototype.setOpacity=function(t){this.SVG_.setAttribute("opacity",t)};