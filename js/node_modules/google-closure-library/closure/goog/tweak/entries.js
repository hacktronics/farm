goog.provide("goog.tweak.BaseEntry"),goog.provide("goog.tweak.BasePrimitiveSetting"),goog.provide("goog.tweak.BaseSetting"),goog.provide("goog.tweak.BooleanGroup"),goog.provide("goog.tweak.BooleanInGroupSetting"),goog.provide("goog.tweak.BooleanSetting"),goog.provide("goog.tweak.ButtonAction"),goog.provide("goog.tweak.NumericSetting"),goog.provide("goog.tweak.StringSetting"),goog.require("goog.array"),goog.require("goog.asserts"),goog.require("goog.log"),goog.require("goog.object"),goog.tweak.BaseEntry=function(t,e){this.id_=t,this.label=t,this.description=e,this.callbacks_=[]},goog.tweak.BaseEntry.prototype.logger=goog.log.getLogger("goog.tweak.BaseEntry"),goog.tweak.BaseEntry.prototype.restartRequired_=!0,goog.tweak.BaseEntry.prototype.getId=function(){return this.id_},goog.tweak.BaseEntry.prototype.isRestartRequired=function(){return this.restartRequired_},goog.tweak.BaseEntry.prototype.setRestartRequired=function(t){this.restartRequired_=t},goog.tweak.BaseEntry.prototype.addCallback=function(t){this.callbacks_.push(t)},goog.tweak.BaseEntry.prototype.removeCallback=function(t){goog.array.remove(this.callbacks_,t)},goog.tweak.BaseEntry.prototype.fireCallbacks=function(){for(var t,e=0;t=this.callbacks_[e];++e)t(this)},goog.tweak.BaseSetting=function(t,e){goog.tweak.BaseEntry.call(this,t,e),goog.asserts.assert(!/[^A-Za-z0-9._]/.test(t),"Tweak id contains illegal characters: ",t),this.initialQueryParamValue,this.paramName_=this.getId().toLowerCase()},goog.inherits(goog.tweak.BaseSetting,goog.tweak.BaseEntry),goog.tweak.BaseSetting.InitializeState_={NOT_INITIALIZED:0,INITIALIZING:1,INITIALIZED:2},goog.tweak.BaseSetting.prototype.logger=goog.log.getLogger("goog.tweak.BaseSetting"),goog.tweak.BaseSetting.prototype.initializeState_=goog.tweak.BaseSetting.InitializeState_.NOT_INITIALIZED,goog.tweak.BaseSetting.prototype.initialize=goog.abstractMethod,goog.tweak.BaseSetting.prototype.getNewValueEncoded=goog.abstractMethod,goog.tweak.BaseSetting.prototype.assertNotInitialized=function(t){goog.asserts.assert(this.initializeState_!=goog.tweak.BaseSetting.InitializeState_.INITIALIZED,"Cannot call "+t+" after the tweak as been initialized.")},goog.tweak.BaseSetting.prototype.isInitializing=function(){return this.initializeState_==goog.tweak.BaseSetting.InitializeState_.INITIALIZING},goog.tweak.BaseSetting.prototype.setInitialQueryParamValue=function(t){this.assertNotInitialized("setInitialQueryParamValue"),this.initialQueryParamValue=t},goog.tweak.BaseSetting.prototype.getParamName=function(){return this.paramName_},goog.tweak.BaseSetting.prototype.setParamName=function(t){this.assertNotInitialized("setParamName"),this.paramName_=t},goog.tweak.BaseSetting.prototype.ensureInitialized=function(){if(this.initializeState_==goog.tweak.BaseSetting.InitializeState_.NOT_INITIALIZED){this.initializeState_=goog.tweak.BaseSetting.InitializeState_.INITIALIZING;var t=null==this.initialQueryParamValue?null:this.initialQueryParamValue;this.initialize(t),this.initializeState_=goog.tweak.BaseSetting.InitializeState_.INITIALIZED}},goog.tweak.BasePrimitiveSetting=function(t,e,o){goog.tweak.BaseSetting.call(this,t,e),this.defaultValue_=o,this.value_,this.newValue_},goog.inherits(goog.tweak.BasePrimitiveSetting,goog.tweak.BaseSetting),goog.tweak.BasePrimitiveSetting.prototype.logger=goog.log.getLogger("goog.tweak.BasePrimitiveSetting"),goog.tweak.BasePrimitiveSetting.prototype.encodeNewValue=goog.abstractMethod,goog.tweak.BasePrimitiveSetting.prototype.getValue=function(){return this.ensureInitialized(),this.value_},goog.tweak.BasePrimitiveSetting.prototype.getNewValue=function(){return this.ensureInitialized(),this.newValue_},goog.tweak.BasePrimitiveSetting.prototype.setValue=function(t){this.ensureInitialized();var e=this.newValue_!=t;this.newValue_=t,this.isInitializing()?this.value_=t:(this.isRestartRequired()||(this.value_=t),e&&this.fireCallbacks())},goog.tweak.BasePrimitiveSetting.prototype.getDefaultValue=function(){return this.defaultValue_},goog.tweak.BasePrimitiveSetting.prototype.setDefaultValue=function(t){this.assertNotInitialized("setDefaultValue"),this.defaultValue_=t},goog.tweak.BasePrimitiveSetting.prototype.getNewValueEncoded=function(){return this.ensureInitialized(),this.newValue_==this.defaultValue_?null:this.encodeNewValue()},goog.tweak.StringSetting=function(t,e){goog.tweak.BasePrimitiveSetting.call(this,t,e,""),this.validValues_},goog.inherits(goog.tweak.StringSetting,goog.tweak.BasePrimitiveSetting),goog.tweak.StringSetting.prototype.logger=goog.log.getLogger("goog.tweak.StringSetting"),goog.tweak.StringSetting.prototype.getValue,goog.tweak.StringSetting.prototype.getNewValue,goog.tweak.StringSetting.prototype.setValue,goog.tweak.StringSetting.prototype.setDefaultValue,goog.tweak.StringSetting.prototype.getDefaultValue,goog.tweak.StringSetting.prototype.encodeNewValue=function(){return this.getNewValue()},goog.tweak.StringSetting.prototype.setValidValues=function(t){this.assertNotInitialized("setValidValues"),this.validValues_=t,t&&!goog.array.contains(t,this.getDefaultValue())&&this.setDefaultValue(t[0])},goog.tweak.StringSetting.prototype.getValidValues=function(){return this.validValues_},goog.tweak.StringSetting.prototype.initialize=function(t){if(null==t)this.setValue(this.getDefaultValue());else{var e=this.validValues_;if(e){t=t.toLowerCase();for(var o=0,i=e.length;o<i;++o)if(t==e[o].toLowerCase())return void this.setValue(e[o]);goog.log.warning(this.logger,"Tweak "+this.getId()+" has value outside of expected range:"+t)}this.setValue(t)}},goog.tweak.NumericSetting=function(t,e){goog.tweak.BasePrimitiveSetting.call(this,t,e,0),this.validValues_},goog.inherits(goog.tweak.NumericSetting,goog.tweak.BasePrimitiveSetting),goog.tweak.NumericSetting.prototype.logger=goog.log.getLogger("goog.tweak.NumericSetting"),goog.tweak.NumericSetting.prototype.getValue,goog.tweak.NumericSetting.prototype.getNewValue,goog.tweak.NumericSetting.prototype.setValue,goog.tweak.NumericSetting.prototype.setDefaultValue,goog.tweak.NumericSetting.prototype.getDefaultValue,goog.tweak.NumericSetting.prototype.encodeNewValue=function(){return""+this.getNewValue()},goog.tweak.NumericSetting.prototype.setValidValues=function(t){this.assertNotInitialized("setValidValues"),this.validValues_=t,t&&!goog.array.contains(t,this.getDefaultValue())&&this.setDefaultValue(t[0])},goog.tweak.NumericSetting.prototype.getValidValues=function(){return this.validValues_},goog.tweak.NumericSetting.prototype.initialize=function(t){if(null==t)this.setValue(this.getDefaultValue());else{var e=+t;this.validValues_&&!goog.array.contains(this.validValues_,e)&&goog.log.warning(this.logger,"Tweak "+this.getId()+" has value outside of expected range: "+t),isNaN(e)?(goog.log.warning(this.logger,"Tweak "+this.getId()+" has value of NaN, resetting to "+this.getDefaultValue()),this.setValue(this.getDefaultValue())):this.setValue(e)}},goog.tweak.BooleanSetting=function(t,e){goog.tweak.BasePrimitiveSetting.call(this,t,e,!1)},goog.inherits(goog.tweak.BooleanSetting,goog.tweak.BasePrimitiveSetting),goog.tweak.BooleanSetting.prototype.logger=goog.log.getLogger("goog.tweak.BooleanSetting"),goog.tweak.BooleanSetting.prototype.getValue,goog.tweak.BooleanSetting.prototype.getNewValue,goog.tweak.BooleanSetting.prototype.setValue,goog.tweak.BooleanSetting.prototype.setDefaultValue,goog.tweak.BooleanSetting.prototype.getDefaultValue,goog.tweak.BooleanSetting.prototype.encodeNewValue=function(){return this.getNewValue()?"1":"0"},goog.tweak.BooleanSetting.prototype.initialize=function(t){null==t?this.setValue(this.getDefaultValue()):(t=t.toLowerCase(),this.setValue("true"==t||"1"==t))},goog.tweak.BooleanInGroupSetting=function(t,e,o){goog.tweak.BooleanSetting.call(this,t,e),this.token_=this.getId().toLowerCase(),this.group_=o,goog.tweak.BooleanInGroupSetting.superClass_.setParamName.call(this,null)},goog.inherits(goog.tweak.BooleanInGroupSetting,goog.tweak.BooleanSetting),goog.tweak.BooleanInGroupSetting.prototype.logger=goog.log.getLogger("goog.tweak.BooleanInGroupSetting"),goog.tweak.BooleanInGroupSetting.prototype.setParamName=function(t){goog.asserts.fail("Use setToken() for BooleanInGroupSetting.")},goog.tweak.BooleanInGroupSetting.prototype.setToken=function(t){this.token_=t},goog.tweak.BooleanInGroupSetting.prototype.getToken=function(){return this.token_},goog.tweak.BooleanInGroupSetting.prototype.getGroup=function(){return this.group_},goog.tweak.BooleanGroup=function(t,e){goog.tweak.BaseSetting.call(this,t,e),this.entriesByToken_={},this.queryParamValues_={}},goog.inherits(goog.tweak.BooleanGroup,goog.tweak.BaseSetting),goog.tweak.BooleanGroup.prototype.logger=goog.log.getLogger("goog.tweak.BooleanGroup"),goog.tweak.BooleanGroup.prototype.getChildEntries=function(){return this.entriesByToken_},goog.tweak.BooleanGroup.prototype.addChild=function(t){this.ensureInitialized();var e=t.getToken(),o=e.toLowerCase();goog.asserts.assert(!this.entriesByToken_[o],'Multiple bools registered with token "%s" in group: %s',e,this.getId()),this.entriesByToken_[o]=t;var i=this.queryParamValues_[o];null!=i&&(t.initialQueryParamValue=i?"1":"0")},goog.tweak.BooleanGroup.prototype.initialize=function(t){var e={};if(t)for(var o=t.split(/\s*,\s*/),i=0;i<o.length;++i){var g=o[i].toLowerCase(),a="-"==g.charAt(0);a&&(g=g.substr(1)),e[g]=!a}this.queryParamValues_=e},goog.tweak.BooleanGroup.prototype.getNewValueEncoded=function(){this.ensureInitialized();var t=[],e=goog.object.getKeys(this.entriesByToken_);e.sort();for(var o,i=0;o=this.entriesByToken_[e[i]];++i){null!=o.getNewValueEncoded()&&t.push((o.getNewValue()?"":"-")+o.getToken())}return t.length?t.join(","):null},goog.tweak.ButtonAction=function(t,e,o){goog.tweak.BaseEntry.call(this,t,e),this.addCallback(o),this.setRestartRequired(!1)},goog.inherits(goog.tweak.ButtonAction,goog.tweak.BaseEntry);