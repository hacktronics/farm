goog.provide("goog.graphics.CanvasEllipseElement"),goog.provide("goog.graphics.CanvasGroupElement"),goog.provide("goog.graphics.CanvasImageElement"),goog.provide("goog.graphics.CanvasPathElement"),goog.provide("goog.graphics.CanvasRectElement"),goog.provide("goog.graphics.CanvasTextElement"),goog.forwardDeclare("goog.graphics.CanvasGraphics"),goog.require("goog.array"),goog.require("goog.dom"),goog.require("goog.dom.TagName"),goog.require("goog.dom.safe"),goog.require("goog.graphics.EllipseElement"),goog.require("goog.graphics.Font"),goog.require("goog.graphics.GroupElement"),goog.require("goog.graphics.ImageElement"),goog.require("goog.graphics.Path"),goog.require("goog.graphics.PathElement"),goog.require("goog.graphics.RectElement"),goog.require("goog.graphics.TextElement"),goog.require("goog.html.SafeHtml"),goog.require("goog.html.uncheckedconversions"),goog.require("goog.math"),goog.require("goog.string"),goog.require("goog.string.Const"),goog.graphics.CanvasGroupElement=function(t){goog.graphics.GroupElement.call(this,null,t),this.children_=[]},goog.inherits(goog.graphics.CanvasGroupElement,goog.graphics.GroupElement),goog.graphics.CanvasGroupElement.prototype.clear=function(){this.children_.length&&(this.children_.length=0,this.getGraphics().redraw())},goog.graphics.CanvasGroupElement.prototype.setSize=function(t,e){},goog.graphics.CanvasGroupElement.prototype.appendChild=function(t){this.children_.push(t)},goog.graphics.CanvasGroupElement.prototype.draw=function(t){for(var e=0,o=this.children_.length;e<o;e++)this.getGraphics().drawElement(this.children_[e])},goog.graphics.CanvasGroupElement.prototype.removeElement=function(t){goog.array.removeIf(this.children_,function(e){return e.children_?(e.removeElement(t),!1):e===t})},goog.graphics.CanvasEllipseElement=function(t,e,o,g,i,a,s,h){goog.graphics.EllipseElement.call(this,t,e,s,h),this.cx_=o,this.cy_=g,this.rx_=i,this.ry_=a,this.path_=new goog.graphics.Path,this.setUpPath_(),this.pathElement_=new goog.graphics.CanvasPathElement(null,e,this.path_,s,h)},goog.inherits(goog.graphics.CanvasEllipseElement,goog.graphics.EllipseElement),goog.graphics.CanvasEllipseElement.prototype.setUpPath_=function(){this.path_.clear(),this.path_.moveTo(this.cx_+goog.math.angleDx(0,this.rx_),this.cy_+goog.math.angleDy(0,this.ry_)),this.path_.arcTo(this.rx_,this.ry_,0,360),this.path_.close()},goog.graphics.CanvasEllipseElement.prototype.setCenter=function(t,e){this.cx_=t,this.cy_=e,this.setUpPath_(),this.pathElement_.setPath(this.path_)},goog.graphics.CanvasEllipseElement.prototype.setRadius=function(t,e){this.rx_=t,this.ry_=e,this.setUpPath_(),this.pathElement_.setPath(this.path_)},goog.graphics.CanvasEllipseElement.prototype.draw=function(t){this.pathElement_.draw(t)},goog.graphics.CanvasRectElement=function(t,e,o,g,i,a,s,h){goog.graphics.RectElement.call(this,t,e,s,h),this.x_=o,this.y_=g,this.w_=i,this.h_=a},goog.inherits(goog.graphics.CanvasRectElement,goog.graphics.RectElement),goog.graphics.CanvasRectElement.prototype.setPosition=function(t,e){this.x_=t,this.y_=e,this.drawn_&&this.getGraphics().redraw()},goog.graphics.CanvasRectElement.prototype.drawn_=!1,goog.graphics.CanvasRectElement.prototype.setSize=function(t,e){this.w_=t,this.h_=e,this.drawn_&&this.getGraphics().redraw()},goog.graphics.CanvasRectElement.prototype.draw=function(t){this.drawn_=!0,t.beginPath(),t.moveTo(this.x_,this.y_),t.lineTo(this.x_,this.y_+this.h_),t.lineTo(this.x_+this.w_,this.y_+this.h_),t.lineTo(this.x_+this.w_,this.y_),t.closePath()},goog.graphics.CanvasPathElement=function(t,e,o,g,i){goog.graphics.PathElement.call(this,t,e,g,i),this.setPath(o)},goog.inherits(goog.graphics.CanvasPathElement,goog.graphics.PathElement),goog.graphics.CanvasPathElement.prototype.drawn_=!1,goog.graphics.CanvasPathElement.prototype.path_,goog.graphics.CanvasPathElement.prototype.setPath=function(t){this.path_=t.isSimple()?t:goog.graphics.Path.createSimplifiedPath(t),this.drawn_&&this.getGraphics().redraw()},goog.graphics.CanvasPathElement.prototype.draw=function(t){this.drawn_=!0,t.beginPath(),this.path_.forEachSegment(function(e,o){switch(e){case goog.graphics.Path.Segment.MOVETO:t.moveTo(o[0],o[1]);break;case goog.graphics.Path.Segment.LINETO:for(var g=0;g<o.length;g+=2)t.lineTo(o[g],o[g+1]);break;case goog.graphics.Path.Segment.CURVETO:for(g=0;g<o.length;g+=6)t.bezierCurveTo(o[g],o[g+1],o[g+2],o[g+3],o[g+4],o[g+5]);break;case goog.graphics.Path.Segment.ARCTO:throw new Error("Canvas paths cannot contain arcs");case goog.graphics.Path.Segment.CLOSE:t.closePath()}})},goog.graphics.CanvasTextElement=function(t,e,o,g,i,a,s,h,n,r){var p=goog.dom.createDom(goog.dom.TagName.DIV,{style:"display:table;position:absolute;padding:0;margin:0;border:0"});goog.graphics.TextElement.call(this,p,t,n,r),this.text_=e,this.x1_=o,this.y1_=g,this.x2_=i,this.y2_=a,this.align_=s||"left",this.font_=h,this.innerElement_=goog.dom.createDom(goog.dom.TagName.DIV,{style:"display:table-cell;padding: 0;margin: 0;border: 0"}),this.updateStyle_(),this.updateText_(),t.getElement().appendChild(p),p.appendChild(this.innerElement_)},goog.inherits(goog.graphics.CanvasTextElement,goog.graphics.TextElement),goog.graphics.CanvasTextElement.prototype.setText=function(t){this.text_=t,this.updateText_()},goog.graphics.CanvasTextElement.prototype.setFill=function(t){this.fill=t;var e=this.getElement();e&&(e.style.color=t.getColor()||t.getColor1())},goog.graphics.CanvasTextElement.prototype.setStroke=function(t){},goog.graphics.CanvasTextElement.prototype.draw=function(t){},goog.graphics.CanvasTextElement.prototype.updateStyle_=function(){var t=this.x1_,e=this.x2_,o=this.y1_,g=this.y2_,i=this.align_,a=this.font_,s=this.getElement().style,h=this.getGraphics().getPixelScaleX(),n=this.getGraphics().getPixelScaleY();if(t==e){s.lineHeight="90%",this.innerElement_.style.verticalAlign="center"==i?"middle":"left"==i?o<g?"top":"bottom":o<g?"bottom":"top",s.textAlign="center";var r=a.size*h;s.top=Math.round(Math.min(o,g)*n)+"px",s.left=Math.round((t-r/2)*h)+"px",s.width=Math.round(r)+"px",s.height=Math.abs(o-g)*n+"px",s.fontSize=.6*a.size*n+"pt"}else s.lineHeight="100%",this.innerElement_.style.verticalAlign="top",s.textAlign=i,s.top=Math.round(((o+g)/2-2*a.size/3)*n)+"px",s.left=Math.round(t*h)+"px",s.width=Math.round(Math.abs(e-t)*h)+"px",s.height="auto",s.fontSize=a.size*n+"pt";s.fontWeight=a.bold?"bold":"normal",s.fontStyle=a.italic?"italic":"normal",s.fontFamily=a.family;var p=this.getFill();s.color=p.getColor()||p.getColor1()},goog.graphics.CanvasTextElement.prototype.updateText_=function(){if(this.x1_==this.x2_){var t=goog.array.map(this.text_.split(""),function(t){return goog.string.htmlEscape(t)}).join("<br>"),e=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Concatenate escaped chars and <br>"),t);goog.dom.safe.setInnerHtml(this.innerElement_,e)}else goog.dom.safe.setInnerHtml(this.innerElement_,goog.html.SafeHtml.htmlEscape(this.text_))},goog.graphics.CanvasImageElement=function(t,e,o,g,i,a,s){goog.graphics.ImageElement.call(this,t,e),this.x_=o,this.y_=g,this.w_=i,this.h_=a,this.src_=s},goog.inherits(goog.graphics.CanvasImageElement,goog.graphics.ImageElement),goog.graphics.CanvasImageElement.prototype.drawn_=!1,goog.graphics.CanvasImageElement.prototype.setPosition=function(t,e){this.x_=t,this.y_=e,this.drawn_&&this.getGraphics().redraw()},goog.graphics.CanvasImageElement.prototype.setSize=function(t,e){this.w_=t,this.h_=e,this.drawn_&&this.getGraphics().redraw()},goog.graphics.CanvasImageElement.prototype.setSource=function(t){this.src_=t,this.drawn_&&this.getGraphics().redraw()},goog.graphics.CanvasImageElement.prototype.draw=function(t){if(this.img_)this.w_&&this.h_&&t.drawImage(this.img_,this.x_,this.y_,this.w_,this.h_),this.drawn_=!0;else{var e=new Image;e.onload=goog.bind(this.handleImageLoad_,this,e),e.src=this.src_}},goog.graphics.CanvasImageElement.prototype.handleImageLoad_=function(t){this.img_=t,this.getGraphics().redraw()};