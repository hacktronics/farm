goog.provide("goog.graphics.Path"),goog.provide("goog.graphics.Path.Segment"),goog.require("goog.array"),goog.require("goog.graphics.AffineTransform"),goog.require("goog.math"),goog.graphics.Path=function(){this.segments_=[],this.count_=[],this.arguments_=[]},goog.graphics.Path.prototype.closePoint_=null,goog.graphics.Path.prototype.currentPoint_=null,goog.graphics.Path.prototype.simple_=!0,goog.graphics.Path.Segment={MOVETO:0,LINETO:1,CURVETO:2,ARCTO:3,CLOSE:4},goog.graphics.Path.segmentArgCounts_=function(){var t=[];return t[goog.graphics.Path.Segment.MOVETO]=2,t[goog.graphics.Path.Segment.LINETO]=2,t[goog.graphics.Path.Segment.CURVETO]=6,t[goog.graphics.Path.Segment.ARCTO]=6,t[goog.graphics.Path.Segment.CLOSE]=0,t}(),goog.graphics.Path.getSegmentCount=function(t){return goog.graphics.Path.segmentArgCounts_[t]},goog.graphics.Path.prototype.appendPath=function(t){return t.currentPoint_&&(Array.prototype.push.apply(this.segments_,t.segments_),Array.prototype.push.apply(this.count_,t.count_),Array.prototype.push.apply(this.arguments_,t.arguments_),this.currentPoint_=t.currentPoint_.concat(),this.closePoint_=t.closePoint_.concat(),this.simple_=this.simple_&&t.simple_),this},goog.graphics.Path.prototype.clear=function(){return this.segments_.length=0,this.count_.length=0,this.arguments_.length=0,delete this.closePoint_,delete this.currentPoint_,delete this.simple_,this},goog.graphics.Path.prototype.moveTo=function(t,o){return goog.array.peek(this.segments_)==goog.graphics.Path.Segment.MOVETO?this.arguments_.length-=2:(this.segments_.push(goog.graphics.Path.Segment.MOVETO),this.count_.push(1)),this.arguments_.push(t,o),this.currentPoint_=this.closePoint_=[t,o],this},goog.graphics.Path.prototype.lineTo=function(t){var o=goog.array.peek(this.segments_);if(null==o)throw new Error("Path cannot start with lineTo");o!=goog.graphics.Path.Segment.LINETO&&(this.segments_.push(goog.graphics.Path.Segment.LINETO),this.count_.push(0));for(var g=0;g<arguments.length;g+=2){var r=arguments[g],e=arguments[g+1];this.arguments_.push(r,e)}return this.count_[this.count_.length-1]+=g/2,this.currentPoint_=[r,e],this},goog.graphics.Path.prototype.curveTo=function(t){var o=goog.array.peek(this.segments_);if(null==o)throw new Error("Path cannot start with curve");o!=goog.graphics.Path.Segment.CURVETO&&(this.segments_.push(goog.graphics.Path.Segment.CURVETO),this.count_.push(0));for(var g=0;g<arguments.length;g+=6){var r=arguments[g+4],e=arguments[g+5];this.arguments_.push(arguments[g],arguments[g+1],arguments[g+2],arguments[g+3],r,e)}return this.count_[this.count_.length-1]+=g/6,this.currentPoint_=[r,e],this},goog.graphics.Path.prototype.close=function(){var t=goog.array.peek(this.segments_);if(null==t)throw new Error("Path cannot start with close");return t!=goog.graphics.Path.Segment.CLOSE&&(this.segments_.push(goog.graphics.Path.Segment.CLOSE),this.count_.push(1),this.currentPoint_=this.closePoint_),this},goog.graphics.Path.prototype.arc=function(t,o,g,r,e,s,n){var h=t+goog.math.angleDx(e,g),i=o+goog.math.angleDy(e,r);return n?this.currentPoint_&&h==this.currentPoint_[0]&&i==this.currentPoint_[1]||this.lineTo(h,i):this.moveTo(h,i),this.arcTo(g,r,e,s)},goog.graphics.Path.prototype.arcTo=function(t,o,g,r){var e=this.currentPoint_[0]-goog.math.angleDx(g,t),s=this.currentPoint_[1]-goog.math.angleDy(g,o),n=e+goog.math.angleDx(g+r,t),h=s+goog.math.angleDy(g+r,o);return this.segments_.push(goog.graphics.Path.Segment.ARCTO),this.count_.push(1),this.arguments_.push(t,o,g,r,n,h),this.simple_=!1,this.currentPoint_=[n,h],this},goog.graphics.Path.prototype.arcToAsCurves=function(t,o,g,r){for(var e=this.currentPoint_[0]-goog.math.angleDx(g,t),s=this.currentPoint_[1]-goog.math.angleDy(g,o),n=goog.math.toRadians(r),h=Math.ceil(Math.abs(n)/Math.PI*2),i=n/h,a=goog.math.toRadians(g),c=0;c<h;c++){var p=Math.cos(a),u=Math.sin(a),P=4/3*Math.sin(i/2)/(1+Math.cos(i/2)),_=e+(p-P*u)*t,m=s+(u+P*p)*o;a+=i,p=Math.cos(a),u=Math.sin(a),this.curveTo(_,m,e+(p+P*u)*t,s+(u-P*p)*o,e+p*t,s+u*o)}return this},goog.graphics.Path.prototype.forEachSegment=function(t){for(var o=this.arguments_,g=0,r=0,e=this.segments_.length;r<e;r++){var s=this.segments_[r],n=goog.graphics.Path.segmentArgCounts_[s]*this.count_[r];t(s,o.slice(g,g+n)),g+=n}},goog.graphics.Path.prototype.getCurrentPoint=function(){return this.currentPoint_&&this.currentPoint_.concat()},goog.graphics.Path.prototype.clone=function(){var t=new this.constructor;return t.segments_=this.segments_.concat(),t.count_=this.count_.concat(),t.arguments_=this.arguments_.concat(),t.closePoint_=this.closePoint_&&this.closePoint_.concat(),t.currentPoint_=this.currentPoint_&&this.currentPoint_.concat(),t.simple_=this.simple_,t},goog.graphics.Path.prototype.isSimple=function(){return this.simple_},goog.graphics.Path.simplifySegmentMap_=function(){var t={};return t[goog.graphics.Path.Segment.MOVETO]=goog.graphics.Path.prototype.moveTo,t[goog.graphics.Path.Segment.LINETO]=goog.graphics.Path.prototype.lineTo,t[goog.graphics.Path.Segment.CLOSE]=goog.graphics.Path.prototype.close,t[goog.graphics.Path.Segment.CURVETO]=goog.graphics.Path.prototype.curveTo,t[goog.graphics.Path.Segment.ARCTO]=goog.graphics.Path.prototype.arcToAsCurves,t}(),goog.graphics.Path.createSimplifiedPath=function(t){if(t.isSimple())return t.clone();var o=new goog.graphics.Path;return t.forEachSegment(function(t,g){goog.graphics.Path.simplifySegmentMap_[t].apply(o,g)}),o},goog.graphics.Path.prototype.createTransformedPath=function(t){var o=goog.graphics.Path.createSimplifiedPath(this);return o.transform(t),o},goog.graphics.Path.prototype.transform=function(t){if(!this.isSimple())throw new Error("Non-simple path");return t.transform(this.arguments_,0,this.arguments_,0,this.arguments_.length/2),this.closePoint_&&t.transform(this.closePoint_,0,this.closePoint_,0,1),this.currentPoint_&&this.closePoint_!=this.currentPoint_&&t.transform(this.currentPoint_,0,this.currentPoint_,0,1),this},goog.graphics.Path.prototype.isEmpty=function(){return 0==this.segments_.length};