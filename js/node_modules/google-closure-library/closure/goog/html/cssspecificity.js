goog.module("goog.html.CssSpecificity"),goog.module.declareLegacyNamespace();var userAgent=goog.require("goog.userAgent"),userAgentProduct=goog.require("goog.userAgent.product"),specificityCache={};function getSpecificity(e){if(userAgentProduct.IE&&!userAgent.isVersionOrHigher(9))return[0,0,0,0];var t=specificityCache.hasOwnProperty(e)?specificityCache[e]:null;return t||(Object.keys(specificityCache).length>65536&&(specificityCache={}),t=calculateSpecificity(e),specificityCache[e]=t,t)}function replaceWithEmptyText(e,t,i,r){return e.replace(i,function(e){return t[r]+=1,Array(e.length+1).join(" ")})}function replaceWithPlainText(e,t){return e.replace(t,function(e){return Array(e.length+1).join("A")})}function calculateSpecificity(e){var t=[0,0,0,0],i=new RegExp("\\\\[0-9A-Fa-f]{6}\\s?","g"),r=new RegExp("\\\\[0-9A-Fa-f]{1,5}\\s","g");e=replaceWithPlainText(e,i),e=replaceWithPlainText(e,r),e=replaceWithPlainText(e,/\\./g);var c=new RegExp(":not\\(([^\\)]*)\\)","g");e=e.replace(c,"     $1 ");var g=new RegExp("{[^]*","gm");e=replaceWithEmptyText(e=e.replace(g,""),t,new RegExp("(\\[[^\\]]+\\])","g"),2),e=replaceWithEmptyText(e,t,new RegExp("(#[^\\#\\s\\+>~\\.\\[:]+)","g"),1),e=replaceWithEmptyText(e,t,new RegExp("(\\.[^\\s\\+>~\\.\\[:]+)","g"),2);e=replaceWithEmptyText(e,t,/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,3);e=replaceWithEmptyText(e,t,/(:[\w-]+\([^\)]*\))/gi,2);e=replaceWithEmptyText(e,t,/(:[^\s\+>~\.\[:]+)/g,2);return e=replaceWithEmptyText(e=(e=e.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),t,/([^\s\+>~\.\[:]+)/g,3),t}exports={getSpecificity:getSpecificity};