goog.module("goog.html.sanitizer.noclobber"),goog.module.declareLegacyNamespace();var NodeType=goog.require("goog.dom.NodeType"),googAsserts=goog.require("goog.asserts"),userAgentProduct=goog.require("goog.userAgent.product");function getterOrNull(e,t){var r=goog.global[e];if(!r||!r.prototype)return null;var o=Object.getOwnPropertyDescriptor(r.prototype,t);return o&&o.get||null}function prototypeMethodOrNull(e,t){var r=goog.global[e];return r&&r.prototype&&r.prototype[t]||null}var Methods={ATTRIBUTES_GETTER:getterOrNull("Element","attributes")||getterOrNull("Node","attributes"),HAS_ATTRIBUTE:prototypeMethodOrNull("Element","hasAttribute"),GET_ATTRIBUTE:prototypeMethodOrNull("Element","getAttribute"),SET_ATTRIBUTE:prototypeMethodOrNull("Element","setAttribute"),REMOVE_ATTRIBUTE:prototypeMethodOrNull("Element","removeAttribute"),INNER_HTML_GETTER:getterOrNull("Element","innerHTML")||getterOrNull("HTMLElement","innerHTML"),GET_ELEMENTS_BY_TAG_NAME:prototypeMethodOrNull("Element","getElementsByTagName"),MATCHES:prototypeMethodOrNull("Element","matches")||prototypeMethodOrNull("Element","msMatchesSelector"),NODE_NAME_GETTER:getterOrNull("Node","nodeName"),NODE_TYPE_GETTER:getterOrNull("Node","nodeType"),PARENT_NODE_GETTER:getterOrNull("Node","parentNode"),CHILD_NODES_GETTER:getterOrNull("Node","childNodes"),APPEND_CHILD:prototypeMethodOrNull("Node","appendChild"),STYLE_GETTER:getterOrNull("HTMLElement","style")||getterOrNull("Element","style"),SHEET_GETTER:getterOrNull("HTMLStyleElement","sheet"),GET_PROPERTY_VALUE:prototypeMethodOrNull("CSSStyleDeclaration","getPropertyValue"),SET_PROPERTY:prototypeMethodOrNull("CSSStyleDeclaration","setProperty")};function genericPropertyGet(e,t,r,o){if(e)return e.apply(t);var n=t[r];if(!o(n))throw new Error("Clobbering detected");return n}function genericMethodCall(e,t,r,o){if(e)return e.apply(t,o);if(userAgentProduct.IE&&document.documentMode<10){if(!t[r].call)throw new Error("IE Clobbering detected")}else if("function"!=typeof t[r])throw new Error("Clobbering detected");return t[r].apply(t,o)}function getElementAttributes(e){return genericPropertyGet(Methods.ATTRIBUTES_GETTER,e,"attributes",function(e){return e instanceof NamedNodeMap})}function hasElementAttribute(e,t){return genericMethodCall(Methods.HAS_ATTRIBUTE,e,"hasAttribute",[t])}function getElementAttribute(e,t){return genericMethodCall(Methods.GET_ATTRIBUTE,e,"getAttribute",[t])||null}function setElementAttribute(e,t,r){try{genericMethodCall(Methods.SET_ATTRIBUTE,e,"setAttribute",[t,r])}catch(e){if(-1!=e.message.indexOf("A security problem occurred"))return;throw e}}function removeElementAttribute(e,t){genericMethodCall(Methods.REMOVE_ATTRIBUTE,e,"removeAttribute",[t])}function getElementInnerHTML(e){return genericPropertyGet(Methods.INNER_HTML_GETTER,e,"innerHTML",function(e){return"string"==typeof e})}function getElementStyle(e){return assertHTMLElement(e),genericPropertyGet(Methods.STYLE_GETTER,e,"style",function(e){return e instanceof CSSStyleDeclaration})}function assertHTMLElement(e){if(googAsserts.ENABLE_ASSERTS&&!(e instanceof HTMLElement))throw new Error("Not an HTMLElement")}function getElementsByTagName(e,t){return Array.from(genericMethodCall(Methods.GET_ELEMENTS_BY_TAG_NAME,e,"getElementsByTagName",[t]))}function getElementStyleSheet(e){return assertHTMLElement(e),genericPropertyGet(Methods.SHEET_GETTER,e,"sheet",function(e){return e instanceof CSSStyleSheet})}function elementMatches(e,t){return genericMethodCall(Methods.MATCHES,e,e.matches?"matches":"msMatchesSelector",[t])}function assertNodeIsElement(e){return googAsserts.ENABLE_ASSERTS&&!isNodeElement(e)&&googAsserts.fail("Expected Node of type Element but got Node of type %s",getNodeType(e)),e}function isNodeElement(e){return getNodeType(e)==NodeType.ELEMENT}function getNodeName(e){return genericPropertyGet(Methods.NODE_NAME_GETTER,e,"nodeName",function(e){return"string"==typeof e})}function getNodeType(e){return genericPropertyGet(Methods.NODE_TYPE_GETTER,e,"nodeType",function(e){return"number"==typeof e})}function getParentNode(e){return genericPropertyGet(Methods.PARENT_NODE_GETTER,e,"parentNode",function(e){return!(e&&"string"==typeof e.name&&e.name&&"parentnode"==e.name.toLowerCase())})}function getChildNodes(e){return genericPropertyGet(Methods.CHILD_NODES_GETTER,e,"childNodes",function(e){return e instanceof NodeList})}function appendNodeChild(e,t){return genericMethodCall(Methods.APPEND_CHILD,e,"appendChild",[t])}function getCssPropertyValue(e,t){return genericMethodCall(Methods.GET_PROPERTY_VALUE,e,e.getPropertyValue?"getPropertyValue":"getAttribute",[t])||""}function setCssProperty(e,t,r){genericMethodCall(Methods.SET_PROPERTY,e,e.setProperty?"setProperty":"setAttribute",[t,r])}exports={getElementAttributes:getElementAttributes,hasElementAttribute:hasElementAttribute,getElementAttribute:getElementAttribute,setElementAttribute:setElementAttribute,removeElementAttribute:removeElementAttribute,getElementInnerHTML:getElementInnerHTML,getElementStyle:getElementStyle,getElementsByTagName:getElementsByTagName,getElementStyleSheet:getElementStyleSheet,elementMatches:elementMatches,assertNodeIsElement:assertNodeIsElement,isNodeElement:isNodeElement,getNodeName:getNodeName,getNodeType:getNodeType,getParentNode:getParentNode,getChildNodes:getChildNodes,appendNodeChild:appendNodeChild,getCssPropertyValue:getCssPropertyValue,setCssProperty:setCssProperty,Methods:Methods};