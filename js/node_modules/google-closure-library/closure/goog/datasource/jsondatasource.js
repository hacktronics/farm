goog.provide("goog.ds.JsonDataSource"),goog.require("goog.dom"),goog.require("goog.dom.TagName"),goog.require("goog.dom.safe"),goog.require("goog.ds.DataManager"),goog.require("goog.ds.JsDataSource"),goog.require("goog.ds.LoadState"),goog.require("goog.ds.logger"),goog.require("goog.log"),goog.ds.JsonDataSource=function(o,a,g){goog.ds.JsDataSource.call(this,null,a,null),this.uri_=o,this.callbackParamName_=g||"callback"},goog.inherits(goog.ds.JsonDataSource,goog.ds.JsDataSource),goog.ds.JsonDataSource.prototype.loadState_=goog.ds.LoadState.NOT_LOADED,goog.ds.JsonDataSource.dataSources={},goog.ds.JsonDataSource.prototype.load=function(){if(this.uri_){goog.ds.JsonDataSource.dataSources[this.dataName_]=this,goog.log.info(goog.ds.logger,"Sending JS request for DataSource "+this.getDataName()+" to "+this.uri_.getTypedStringValue()),this.loadState_=goog.ds.LoadState.LOADING;var o={};o[this.callbackParamName_]="JsonReceive."+this.dataName_;var a=this.uri_.cloneWithParams(o);goog.global.JsonReceive[this.dataName_]=goog.bind(this.receiveData,this);var g=goog.dom.createDom(goog.dom.TagName.SCRIPT);goog.dom.safe.setScriptSrc(g,a),goog.dom.getElementsByTagNameAndClass(goog.dom.TagName.HEAD)[0].appendChild(g)}else this.root_={},this.loadState_=goog.ds.LoadState.NOT_LOADED},goog.ds.JsonDataSource.prototype.getLoadState=function(){return this.loadState_},goog.ds.JsonDataSource.prototype.receiveData=function(o){this.setRoot(o),this.loadState_=goog.ds.LoadState.LOADED,goog.ds.DataManager.getInstance().fireDataChange(this.getDataName())},goog.global.JsonReceive={};