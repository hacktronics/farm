goog.provide("goog.debug.DevCss"),goog.provide("goog.debug.DevCss.UserAgent"),goog.require("goog.asserts"),goog.require("goog.cssom"),goog.require("goog.dom.classlist"),goog.require("goog.events"),goog.require("goog.events.EventType"),goog.require("goog.string"),goog.require("goog.userAgent"),goog.debug.DevCss=function(e,s){switch(e||(goog.userAgent.IE?e=goog.debug.DevCss.UserAgent.IE:goog.userAgent.GECKO?e=goog.debug.DevCss.UserAgent.GECKO:goog.userAgent.WEBKIT?e=goog.debug.DevCss.UserAgent.WEBKIT:goog.userAgent.MOBILE?e=goog.debug.DevCss.UserAgent.MOBILE:goog.userAgent.OPERA?e=goog.debug.DevCss.UserAgent.OPERA:goog.userAgent.EDGE&&(e=goog.debug.DevCss.UserAgent.EDGE)),e){case goog.debug.DevCss.UserAgent.OPERA:case goog.debug.DevCss.UserAgent.IE:case goog.debug.DevCss.UserAgent.GECKO:case goog.debug.DevCss.UserAgent.FIREFOX:case goog.debug.DevCss.UserAgent.WEBKIT:case goog.debug.DevCss.UserAgent.SAFARI:case goog.debug.DevCss.UserAgent.MOBILE:case goog.debug.DevCss.UserAgent.EDGE:break;default:throw new Error("Could not determine the user agent from known UserAgents")}this.userAgent_=e,this.userAgentTokens_={},this.userAgentVersion_=s||goog.userAgent.VERSION,this.generateUserAgentTokens_(),this.isIe6OrLess_=this.userAgent_==goog.debug.DevCss.UserAgent.IE&&goog.string.compareVersions("7",this.userAgentVersion_)>0,this.isIe6OrLess_&&(this.ie6CombinedMatches_=[])},goog.debug.DevCss.prototype.activateBrowserSpecificCssRules=function(e){for(var s=void 0===e||e,o=goog.cssom.getAllCssStyleRules(),g=0;t=o[g];g++)this.replaceBrowserSpecificClassNames_(t);if(this.isIe6OrLess_){o=goog.cssom.getAllCssStyleRules();var t;for(g=0;t=o[g];g++)this.replaceIe6CombinedSelectors_(t)}this.isIe6OrLess_&&s&&goog.events.listen(document,goog.events.EventType.LOAD,goog.bind(this.addIe6CombinedClassNames_,this))},goog.debug.DevCss.UserAgent={OPERA:"OPERA",IE:"IE",GECKO:"GECKO",FIREFOX:"GECKO",WEBKIT:"WEBKIT",SAFARI:"WEBKIT",MOBILE:"MOBILE",EDGE:"EDGE"},goog.debug.DevCss.CssToken_={USERAGENT:"USERAGENT",SEPARATOR:"-",LESS_THAN:"LT",GREATER_THAN:"GT",LESS_THAN_OR_EQUAL:"LTE",GREATER_THAN_OR_EQUAL:"GTE",IE6_SELECTOR_TEXT:"goog-ie6-selector",IE6_COMBINED_GLUE:"_"},goog.debug.DevCss.prototype.generateUserAgentTokens_=function(){this.userAgentTokens_.ANY=goog.debug.DevCss.CssToken_.USERAGENT+goog.debug.DevCss.CssToken_.SEPARATOR+this.userAgent_,this.userAgentTokens_.EQUALS=this.userAgentTokens_.ANY+goog.debug.DevCss.CssToken_.SEPARATOR,this.userAgentTokens_.LESS_THAN=this.userAgentTokens_.ANY+goog.debug.DevCss.CssToken_.SEPARATOR+goog.debug.DevCss.CssToken_.LESS_THAN,this.userAgentTokens_.LESS_THAN_OR_EQUAL=this.userAgentTokens_.ANY+goog.debug.DevCss.CssToken_.SEPARATOR+goog.debug.DevCss.CssToken_.LESS_THAN_OR_EQUAL,this.userAgentTokens_.GREATER_THAN=this.userAgentTokens_.ANY+goog.debug.DevCss.CssToken_.SEPARATOR+goog.debug.DevCss.CssToken_.GREATER_THAN,this.userAgentTokens_.GREATER_THAN_OR_EQUAL=this.userAgentTokens_.ANY+goog.debug.DevCss.CssToken_.SEPARATOR+goog.debug.DevCss.CssToken_.GREATER_THAN_OR_EQUAL},goog.debug.DevCss.prototype.getVersionNumberFromSelectorText_=function(e,s){var o=new RegExp(s+"([\\d\\.]+)").exec(e);if(o&&2==o.length)return o[1]},goog.debug.DevCss.prototype.getRuleVersionAndCompare_=function(e,s){if(e.selectorText&&e.selectorText.match(s)){var o=this.getVersionNumberFromSelectorText_(e.selectorText,s);if(o)return[goog.string.compareVersions(this.userAgentVersion_,o),o]}},goog.debug.DevCss.prototype.replaceBrowserSpecificClassNames_=function(e){if(e.selectorText&&e.selectorText.match(this.userAgentTokens_.ANY)){var s,o=this.getRuleVersionAndCompare_(e,this.userAgentTokens_.LESS_THAN_OR_EQUAL);if(o&&o.length){if(o[0]>0)return;s=this.userAgentTokens_.LESS_THAN_OR_EQUAL+o[1]}if((o=this.getRuleVersionAndCompare_(e,this.userAgentTokens_.LESS_THAN))&&o.length){if(o[0]>-1)return;s=this.userAgentTokens_.LESS_THAN+o[1]}if((o=this.getRuleVersionAndCompare_(e,this.userAgentTokens_.GREATER_THAN_OR_EQUAL))&&o.length){if(o[0]<0)return;s=this.userAgentTokens_.GREATER_THAN_OR_EQUAL+o[1]}if((o=this.getRuleVersionAndCompare_(e,this.userAgentTokens_.GREATER_THAN))&&o.length){if(o[0]<1)return;s=this.userAgentTokens_.GREATER_THAN+o[1]}if((o=this.getRuleVersionAndCompare_(e,this.userAgentTokens_.EQUALS))&&o.length){if(0!=o[0])return;s=this.userAgentTokens_.EQUALS+o[1]}s||(s=this.userAgentTokens_.ANY);var g=new RegExp("\\."+s+"\\s+","g"),t=goog.cssom.getCssTextFromCssRule(e),n=t.replace(g,"");n!=t&&goog.cssom.replaceCssRule(e,n)}},goog.debug.DevCss.prototype.replaceIe6CombinedSelectors_=function(e){if(e.style&&e.style.cssText&&e.style.cssText.match(goog.debug.DevCss.CssToken_.IE6_SELECTOR_TEXT)){var s=goog.cssom.getCssTextFromCssRule(e),o=this.getIe6CombinedSelectorText_(s);if(o){var g=o+"{"+e.style.cssText+"}";goog.cssom.replaceCssRule(e,g)}}},goog.debug.DevCss.prototype.getIe6CombinedSelectorText_=function(e){var s=new RegExp(goog.debug.DevCss.CssToken_.IE6_SELECTOR_TEXT+'\\s*:\\s*\\"([^\\"]+)\\"',"gi").exec(e);if(s){for(var o,g=s[1],t=g.split(/\s*\,\s*/),n=0;o=t[n];n++){var r=o.substr(1),i={classNames:r.split(goog.debug.DevCss.CssToken_.IE6_COMBINED_GLUE),combinedClassName:r,els:[]};this.ie6CombinedMatches_.push(i)}return g}return null},goog.debug.DevCss.prototype.addIe6CombinedClassNames_=function(){if(this.ie6CombinedMatches_.length)for(var e,s=document.getElementsByTagName("*"),o=0;e=this.ie6CombinedMatches_[o];o++){for(var g=0;i=s[g];g++)for(var t,n=e.classNames.length,r=0;(t=e.classNames[r])&&goog.dom.classlist.contains(i,t);r++)r==n-1&&e.els.push(i);if(e.els.length){var i;for(g=0;i=e.els[g];g++)goog.asserts.assert(i),goog.dom.classlist.contains(i,e.combinedClassName)||goog.dom.classlist.add(i,e.combinedClassName)}}};