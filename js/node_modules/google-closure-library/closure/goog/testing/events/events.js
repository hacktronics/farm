goog.setTestOnly("goog.testing.events"),goog.provide("goog.testing.events"),goog.provide("goog.testing.events.Event"),goog.require("goog.Disposable"),goog.require("goog.asserts"),goog.require("goog.dom.NodeType"),goog.require("goog.events"),goog.require("goog.events.BrowserEvent"),goog.require("goog.events.BrowserFeature"),goog.require("goog.events.EventTarget"),goog.require("goog.events.EventType"),goog.require("goog.events.KeyCodes"),goog.require("goog.object"),goog.require("goog.style"),goog.require("goog.userAgent"),goog.testing.events.Event=function(e,t){this.type=e,this.target=t||null,this.currentTarget=this.target},goog.testing.events.Event.prototype.propagationStopped_=!1,goog.testing.events.Event.prototype.defaultPrevented=!1,goog.testing.events.Event.prototype.returnValue_=!0,goog.testing.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0},goog.testing.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0,this.returnValue_=!1},goog.testing.events.assertEventTarget_=function(e){return goog.asserts.assert(e,"EventTarget should be defined.")},goog.testing.events.setEventClientXY_=function(e,t){if(!t&&e.target&&e.target.nodeType==goog.dom.NodeType.ELEMENT)try{t=goog.style.getClientPosition(e.target)}catch(e){}e.clientX=t?t.x:0,e.clientY=t?t.y:0,e.screenX=e.clientX,e.screenY=e.clientY},goog.testing.events.fireClickSequence=function(e,t,o,n){return goog.testing.events.eagerAnd_(goog.testing.events.fireMouseDownEvent(e,t,o,n),goog.testing.events.fireMouseUpEvent(e,t,o,n),goog.testing.events.fireClickEvent(e,t,o,n))},goog.testing.events.fireDoubleClickSequence=function(e,t,o){var n=goog.events.BrowserEvent.MouseButton.LEFT;return goog.testing.events.eagerAnd_(goog.testing.events.fireMouseDownEvent(e,n,t,o),goog.testing.events.fireMouseUpEvent(e,n,t,o),goog.testing.events.fireClickEvent(e,n,t,o),goog.userAgent.IE||goog.testing.events.fireMouseDownEvent(e,n,t,o),goog.testing.events.fireMouseUpEvent(e,n,t,o),goog.userAgent.IE||goog.testing.events.fireClickEvent(e,n,t,o),goog.testing.events.fireDoubleClickEvent(e,t,o))},goog.testing.events.KEY_TO_KEYCODE_MAPPING_={0:goog.events.KeyCodes.ZERO,1:goog.events.KeyCodes.ONE,2:goog.events.KeyCodes.TWO,3:goog.events.KeyCodes.THREE,4:goog.events.KeyCodes.FOUR,5:goog.events.KeyCodes.FIVE,6:goog.events.KeyCodes.SIX,7:goog.events.KeyCodes.SEVEN,8:goog.events.KeyCodes.EIGHT,9:goog.events.KeyCodes.NINE,a:goog.events.KeyCodes.A,b:goog.events.KeyCodes.B,c:goog.events.KeyCodes.C,d:goog.events.KeyCodes.D,e:goog.events.KeyCodes.E,f:goog.events.KeyCodes.F,g:goog.events.KeyCodes.G,h:goog.events.KeyCodes.H,i:goog.events.KeyCodes.I,j:goog.events.KeyCodes.J,k:goog.events.KeyCodes.K,l:goog.events.KeyCodes.L,m:goog.events.KeyCodes.M,n:goog.events.KeyCodes.N,o:goog.events.KeyCodes.O,p:goog.events.KeyCodes.P,q:goog.events.KeyCodes.Q,r:goog.events.KeyCodes.R,s:goog.events.KeyCodes.S,t:goog.events.KeyCodes.T,u:goog.events.KeyCodes.U,v:goog.events.KeyCodes.V,w:goog.events.KeyCodes.W,x:goog.events.KeyCodes.X,y:goog.events.KeyCodes.Y,z:goog.events.KeyCodes.Z},goog.testing.events.fireKeySequence=function(e,t,o){return goog.testing.events.fireNonAsciiKeySequence(e,t,t,o)},goog.testing.events.fireNonAsciiKeySequence=function(e,t,o,n){var g=new goog.testing.events.Event(goog.events.EventType.KEYDOWN,e),s=new goog.testing.events.Event(goog.events.EventType.KEYUP,e),v=new goog.testing.events.Event(goog.events.EventType.KEYPRESS,e);if("string"==typeof t){g.key=s.key=t,v.key=o;var r=goog.testing.events.KEY_TO_KEYCODE_MAPPING_[t.toLowerCase()];r&&(g.keyCode=s.keyCode=r);var i=goog.testing.events.KEY_TO_KEYCODE_MAPPING_[o.toLowerCase()];i&&(v.keyCode=i)}else g.keyCode=s.keyCode=t,v.keyCode=o;n&&(goog.object.extend(g,n),goog.object.extend(s,n),goog.object.extend(v,n));var E=goog.testing.events.fireBrowserEvent(g);return"string"==typeof t?""!=o&&E&&(E=goog.testing.events.eagerAnd_(E,goog.testing.events.fireBrowserEvent(v))):goog.events.KeyCodes.firesKeyPressEvent(t,void 0,g.shiftKey,g.ctrlKey,g.altKey,g.metaKey)&&E&&(E=goog.testing.events.eagerAnd_(E,goog.testing.events.fireBrowserEvent(v))),goog.testing.events.eagerAnd_(E,goog.testing.events.fireBrowserEvent(s))},goog.testing.events.fireMouseEnterEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.MOUSEENTER,e);return n.relatedTarget=t,goog.testing.events.setEventClientXY_(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireMouseLeaveEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.MOUSELEAVE,e);return n.relatedTarget=t,goog.testing.events.setEventClientXY_(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireMouseOverEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.MOUSEOVER,e);return n.relatedTarget=t,goog.testing.events.setEventClientXY_(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireMouseMoveEvent=function(e,t){var o=new goog.testing.events.Event(goog.events.EventType.MOUSEMOVE,e);return goog.testing.events.setEventClientXY_(o,t),goog.testing.events.fireBrowserEvent(o)},goog.testing.events.fireMouseOutEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.MOUSEOUT,e);return n.relatedTarget=t,goog.testing.events.setEventClientXY_(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireMouseDownEvent=function(e,t,o,n){var g=t||goog.events.BrowserEvent.MouseButton.LEFT;return g=goog.events.BrowserFeature.HAS_W3C_BUTTON?g:goog.events.BrowserEvent.IE_BUTTON_MAP[g],goog.testing.events.fireMouseButtonEvent_(goog.events.EventType.MOUSEDOWN,e,g,o,n)},goog.testing.events.fireMouseUpEvent=function(e,t,o,n){var g=t||goog.events.BrowserEvent.MouseButton.LEFT;return g=goog.events.BrowserFeature.HAS_W3C_BUTTON?g:goog.events.BrowserEvent.IE_BUTTON_MAP[g],goog.testing.events.fireMouseButtonEvent_(goog.events.EventType.MOUSEUP,e,g,o,n)},goog.testing.events.fireClickEvent=function(e,t,o,n){return goog.testing.events.fireMouseButtonEvent_(goog.events.EventType.CLICK,e,t,o,n)},goog.testing.events.fireDoubleClickEvent=function(e,t,o){return goog.testing.events.fireMouseButtonEvent_(goog.events.EventType.DBLCLICK,e,goog.events.BrowserEvent.MouseButton.LEFT,t,o)},goog.testing.events.fireMouseButtonEvent_=function(e,t,o,n,g){var s=new goog.testing.events.Event(e,t);return s.button=o||goog.events.BrowserEvent.MouseButton.LEFT,goog.testing.events.setEventClientXY_(s,n),g&&goog.object.extend(s,g),goog.testing.events.fireBrowserEvent(s)},goog.testing.events.fireContextMenuEvent=function(e,t){var o=goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.BrowserEvent.MouseButton.LEFT:goog.events.BrowserEvent.MouseButton.RIGHT,n=new goog.testing.events.Event(goog.events.EventType.CONTEXTMENU,e);return n.button=goog.events.BrowserFeature.HAS_W3C_BUTTON?o:goog.events.BrowserEvent.IE_BUTTON_MAP[o],n.ctrlKey=goog.userAgent.MAC,goog.testing.events.setEventClientXY_(n,t),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireContextMenuSequence=function(e,t){var o=goog.userAgent.MAC?{ctrlKey:!0}:{},n=goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.BrowserEvent.MouseButton.LEFT:goog.events.BrowserEvent.MouseButton.RIGHT,g=goog.testing.events.fireMouseDownEvent(e,n,t,o);return goog.userAgent.WINDOWS?g=goog.testing.events.eagerAnd_(g,goog.testing.events.fireMouseUpEvent(e,n,t),goog.testing.events.fireContextMenuEvent(e,t)):(g=goog.testing.events.eagerAnd_(g,goog.testing.events.fireContextMenuEvent(e,t)),g=goog.testing.events.eagerAnd_(g,goog.testing.events.fireMouseUpEvent(e,n,t,o)),goog.userAgent.WEBKIT&&goog.userAgent.MAC&&(g=goog.testing.events.eagerAnd_(g,goog.testing.events.fireClickEvent(e,n,t,o)))),g},goog.testing.events.firePopStateEvent=function(e,t){var o=new goog.testing.events.Event(goog.events.EventType.POPSTATE,e);return o.state=t,goog.testing.events.fireBrowserEvent(o)},goog.testing.events.fireBlurEvent=function(e){var t=new goog.testing.events.Event(goog.events.EventType.BLUR,e);return goog.testing.events.fireBrowserEvent(t)},goog.testing.events.fireFocusEvent=function(e){var t=new goog.testing.events.Event(goog.events.EventType.FOCUS,e);return goog.testing.events.fireBrowserEvent(t)},goog.testing.events.fireFocusInEvent=function(e){var t=new goog.testing.events.Event(goog.events.EventType.FOCUSIN,e);return goog.testing.events.fireBrowserEvent(t)},goog.testing.events.fireBrowserEvent=function(e){e.returnValue_=!0;for(var t=[],o=e.target;o;o=o.parentNode)t.push(o);for(var n=t.length-1;n>=0&&!e.propagationStopped_;n--)goog.events.fireListeners(t[n],e.type,!0,new goog.events.BrowserEvent(e,t[n]));for(n=0;n<t.length&&!e.propagationStopped_;n++)goog.events.fireListeners(t[n],e.type,!1,new goog.events.BrowserEvent(e,t[n]));return e.returnValue_},goog.testing.events.fireTouchStartEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.TOUCHSTART,e);return goog.testing.events.setEventClientXY_(n,t),o&&goog.object.extend(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireTouchMoveEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.TOUCHMOVE,e);return goog.testing.events.setEventClientXY_(n,t),o&&goog.object.extend(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireTouchEndEvent=function(e,t,o){var n=new goog.testing.events.Event(goog.events.EventType.TOUCHEND,e);return goog.testing.events.setEventClientXY_(n,t),o&&goog.object.extend(n,o),goog.testing.events.fireBrowserEvent(n)},goog.testing.events.fireTouchSequence=function(e,t,o){return goog.testing.events.eagerAnd_(goog.testing.events.fireTouchStartEvent(e,t,o),goog.testing.events.fireTouchEndEvent(e,t,o))},goog.testing.events.mixinListenable=function(e){var t=new goog.events.EventTarget;t.setTargetForTesting(e);var o=goog.events.EventTarget.prototype,n=goog.Disposable.prototype;for(var g in o)if(o.hasOwnProperty(g)||n.hasOwnProperty(g)){var s=o[g];goog.isFunction(s)?e[g]=goog.bind(s,t):e[g]=s}},goog.testing.events.eagerAnd_=function(e,t){for(var o=1;o<arguments.length;o++)e=e&&arguments[o];return e};