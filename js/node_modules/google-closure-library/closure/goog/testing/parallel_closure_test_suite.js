goog.module("goog.testing.parallelClosureTestSuite"),goog.setTestOnly("goog.testing.parallelClosureTestSuite");const MultiTestRunner=goog.require("goog.testing.MultiTestRunner"),Promise=goog.require("goog.Promise"),TestCase=goog.require("goog.testing.TestCase"),asserts=goog.require("goog.asserts"),events=goog.require("goog.events"),json=goog.require("goog.json"),testSuite=goog.require("goog.testing.testSuite");let ParallelTestResults,testRunner=null;function processAllTestResults(e){let t=0,s=0;const l={};let o="";for(let n=0;n<e.length;n++){const r=e[n];for(const e in r){t++,l[e]=r[e];const n=r[e];if(n.length){s++;for(let e=0;e<n.length;e++)o+=n[e]+"\n"}}}return{totalTests:t,totalFailures:s,failureReports:o,allResults:l}}const testObj={setUpPage:function(){const e=goog.global.G_parallelTestRunner.testTimeout,t=goog.global.G_parallelTestRunner.allTests,s=goog.global.G_parallelTestRunner.parallelFrames,l=goog.global.G_parallelTestRunner.parallelTimeout;return testRunner=(new MultiTestRunner).setName(document.title).setBasePath("/google3/").setPoolSize(s).setStatsBucketSizes(5,500).setTimeout(1e3*e).addTests(t),testRunner.render(document.getElementById("runner")),TestCase.getActiveTestCase().promiseTimeout=1e3*l,testRunner},testRunAllTests:function(){asserts.assert(testRunner,'Was "setUpPage" called?');const e=new Promise(function(e,t){events.listen(testRunner,"testsFinished",e)});testRunner.start();let t={};return window.G_testRunner.getTestResults=function(){return t},window.G_testRunner.getTestResultsAsJson=function(){return json.serialize(t)},e.then(function(e){const s=processAllTestResults(e.allTestResults);t=s.allResults,s.totalFailures&&fail(s.totalFailures+" of "+s.totalTests+" test(s) failed!\n\n"+s.failureReports)})}};goog.global.G_parallelTestRunner&&testSuite(testObj),testObj.processAllTestResults=processAllTestResults,exports=testObj;