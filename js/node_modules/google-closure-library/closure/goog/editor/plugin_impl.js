goog.provide("goog.editor.PluginImpl"),goog.forwardDeclare("goog.editor.Field"),goog.require("goog.events.EventTarget"),goog.require("goog.functions"),goog.require("goog.log"),goog.require("goog.object"),goog.require("goog.reflect"),goog.require("goog.userAgent"),goog.editor.PluginImpl=function(){goog.events.EventTarget.call(this),this.enabled_=this.activeOnUneditableFields(),this.fieldObject=null,this.autoDispose_=!0,this.logger=goog.log.getLogger("goog.editor.Plugin")},goog.inherits(goog.editor.PluginImpl,goog.events.EventTarget),goog.editor.PluginImpl.prototype.getFieldDomHelper=function(){return this.getFieldObject()&&this.getFieldObject().getEditableDomHelper()},goog.editor.PluginImpl.prototype.getFieldObject=function(){return this.fieldObject},goog.editor.PluginImpl.prototype.setFieldObject=function(o){this.fieldObject=o},goog.editor.PluginImpl.prototype.registerFieldObject=function(o){this.setFieldObject(o)},goog.editor.PluginImpl.prototype.unregisterFieldObject=function(o){this.getFieldObject()&&(this.disable(this.getFieldObject()),this.setFieldObject(null))},goog.editor.PluginImpl.prototype.enable=function(o){this.getFieldObject()==o?this.enabled_=!0:goog.log.error(this.logger,"Trying to enable an unregistered field with this plugin.")},goog.editor.PluginImpl.prototype.disable=function(o){this.getFieldObject()==o?this.enabled_=!1:goog.log.error(this.logger,"Trying to disable an unregistered field with this plugin.")},goog.editor.PluginImpl.prototype.isEnabled=function(o){return this.getFieldObject()==o&&this.enabled_},goog.editor.PluginImpl.prototype.setAutoDispose=function(o){this.autoDispose_=o},goog.editor.PluginImpl.prototype.isAutoDispose=function(){return this.autoDispose_},goog.editor.PluginImpl.prototype.activeOnUneditableFields=goog.functions.FALSE,goog.editor.PluginImpl.prototype.isSilentCommand=goog.functions.FALSE,goog.editor.PluginImpl.prototype.disposeInternal=function(){this.getFieldObject()&&this.unregisterFieldObject(this.getFieldObject()),goog.editor.PluginImpl.superClass_.disposeInternal.call(this)},goog.editor.PluginImpl.prototype.getTrogClassId,goog.editor.PluginImpl.Op={KEYDOWN:1,KEYPRESS:2,KEYUP:3,SELECTION:4,SHORTCUT:5,EXEC_COMMAND:6,QUERY_COMMAND:7,PREPARE_CONTENTS_HTML:8,CLEAN_CONTENTS_HTML:10,CLEAN_CONTENTS_DOM:11},goog.editor.PluginImpl.OPCODE=goog.object.transpose(goog.reflect.object(goog.editor.PluginImpl,{handleKeyDown:goog.editor.PluginImpl.Op.KEYDOWN,handleKeyPress:goog.editor.PluginImpl.Op.KEYPRESS,handleKeyUp:goog.editor.PluginImpl.Op.KEYUP,handleSelectionChange:goog.editor.PluginImpl.Op.SELECTION,handleKeyboardShortcut:goog.editor.PluginImpl.Op.SHORTCUT,execCommand:goog.editor.PluginImpl.Op.EXEC_COMMAND,queryCommandValue:goog.editor.PluginImpl.Op.QUERY_COMMAND,prepareContentsHtml:goog.editor.PluginImpl.Op.PREPARE_CONTENTS_HTML,cleanContentsHtml:goog.editor.PluginImpl.Op.CLEAN_CONTENTS_HTML,cleanContentsDom:goog.editor.PluginImpl.Op.CLEAN_CONTENTS_DOM})),goog.editor.PluginImpl.IRREPRESSIBLE_OPS=goog.object.createSet(goog.editor.PluginImpl.Op.PREPARE_CONTENTS_HTML,goog.editor.PluginImpl.Op.CLEAN_CONTENTS_HTML,goog.editor.PluginImpl.Op.CLEAN_CONTENTS_DOM),goog.editor.PluginImpl.prototype.handleKeyDown,goog.editor.PluginImpl.prototype.handleKeyPress,goog.editor.PluginImpl.prototype.handleKeyUp,goog.editor.PluginImpl.prototype.handleSelectionChange,goog.editor.PluginImpl.prototype.handleKeyboardShortcut,goog.editor.PluginImpl.prototype.execCommand=function(o,e){var t=this.isSilentCommand(o);t||(goog.userAgent.GECKO&&this.getFieldObject().stopChangeEvents(!0,!0),this.getFieldObject().dispatchBeforeChange());try{var g=this.execCommandInternal.apply(this,arguments)}finally{t||(this.getFieldObject().dispatchChange(),this.getFieldObject().dispatchSelectionChangeEvent())}return g},goog.editor.PluginImpl.prototype.execCommandInternal,goog.editor.PluginImpl.prototype.queryCommandValue,goog.editor.PluginImpl.prototype.prepareContentsHtml,goog.editor.PluginImpl.prototype.cleanContentsDom,goog.editor.PluginImpl.prototype.cleanContentsHtml,goog.editor.PluginImpl.prototype.isSupportedCommand=function(o){return!1},goog.editor.PluginImpl.prototype.saveScrollPosition=function(){if(this.getFieldObject()&&goog.userAgent.EDGE){var o=this.getFieldObject().getEditableDomHelper().getWindow();return o.scrollTo.bind(o,o.scrollX,o.scrollY)}return function(){}};