goog.provide("goog.i18n.BidiFormatter"),goog.require("goog.html.SafeHtml"),goog.require("goog.i18n.bidi"),goog.require("goog.i18n.bidi.Dir"),goog.require("goog.i18n.bidi.Format"),goog.i18n.BidiFormatter=function(i,t){this.contextDir_=goog.i18n.bidi.toDir(i,!0),this.alwaysSpan_=!!t},goog.i18n.BidiFormatter.prototype.getContextDir=function(){return this.contextDir_},goog.i18n.BidiFormatter.prototype.getAlwaysSpan=function(){return this.alwaysSpan_},goog.i18n.BidiFormatter.prototype.setContextDir=function(i){this.contextDir_=goog.i18n.bidi.toDir(i,!0)},goog.i18n.BidiFormatter.prototype.setAlwaysSpan=function(i){this.alwaysSpan_=i},goog.i18n.BidiFormatter.prototype.estimateDirection=goog.i18n.bidi.estimateDirection,goog.i18n.BidiFormatter.prototype.areDirectionalitiesOpposite_=function(i,t){return Number(i)*Number(t)<0},goog.i18n.BidiFormatter.prototype.dirResetIfNeeded_=function(i,t,o,r){return r&&(this.areDirectionalitiesOpposite_(t,this.contextDir_)||this.contextDir_==goog.i18n.bidi.Dir.LTR&&goog.i18n.bidi.endsWithRtl(i,o)||this.contextDir_==goog.i18n.bidi.Dir.RTL&&goog.i18n.bidi.endsWithLtr(i,o))?this.contextDir_==goog.i18n.bidi.Dir.LTR?goog.i18n.bidi.Format.LRM:goog.i18n.bidi.Format.RLM:""},goog.i18n.BidiFormatter.prototype.dirAttrValue=function(i,t){return this.knownDirAttrValue(this.estimateDirection(i,t))},goog.i18n.BidiFormatter.prototype.knownDirAttrValue=function(i){return(i==goog.i18n.bidi.Dir.NEUTRAL?this.contextDir_:i)==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"},goog.i18n.BidiFormatter.prototype.dirAttr=function(i,t){return this.knownDirAttr(this.estimateDirection(i,t))},goog.i18n.BidiFormatter.prototype.knownDirAttr=function(i){return i!=this.contextDir_?i==goog.i18n.bidi.Dir.RTL?'dir="rtl"':i==goog.i18n.bidi.Dir.LTR?'dir="ltr"':"":""},goog.i18n.BidiFormatter.prototype.spanWrapSafeHtml=function(i,t){return this.spanWrapSafeHtmlWithKnownDir(null,i,t)},goog.i18n.BidiFormatter.prototype.spanWrapSafeHtmlWithKnownDir=function(i,t,o){return null==i&&(i=this.estimateDirection(goog.html.SafeHtml.unwrap(t),!0)),this.spanWrapWithKnownDir_(i,t,o)},goog.i18n.BidiFormatter.prototype.spanWrapWithKnownDir_=function(i,t,o){var r;o=o||null==o;var n,e=i!=goog.i18n.bidi.Dir.NEUTRAL&&i!=this.contextDir_;this.alwaysSpan_||e?(e&&(n=i==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"),r=goog.html.SafeHtml.create("span",{dir:n},t)):r=t;var g=goog.html.SafeHtml.unwrap(t);return r=goog.html.SafeHtml.concatWithDir(goog.i18n.bidi.Dir.NEUTRAL,r,this.dirResetIfNeeded_(g,i,!0,o))},goog.i18n.BidiFormatter.prototype.unicodeWrap=function(i,t,o){return this.unicodeWrapWithKnownDir(null,i,t,o)},goog.i18n.BidiFormatter.prototype.unicodeWrapWithKnownDir=function(i,t,o,r){return null==i&&(i=this.estimateDirection(t,o)),this.unicodeWrapWithKnownDir_(i,t,o,r)},goog.i18n.BidiFormatter.prototype.unicodeWrapWithKnownDir_=function(i,t,o,r){r=r||null==r;var n=[];return i!=goog.i18n.bidi.Dir.NEUTRAL&&i!=this.contextDir_?(n.push(i==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.Format.RLE:goog.i18n.bidi.Format.LRE),n.push(t),n.push(goog.i18n.bidi.Format.PDF)):n.push(t),n.push(this.dirResetIfNeeded_(t,i,o,r)),n.join("")},goog.i18n.BidiFormatter.prototype.markAfter=function(i,t){return this.markAfterKnownDir(null,i,t)},goog.i18n.BidiFormatter.prototype.markAfterKnownDir=function(i,t,o){return null==i&&(i=this.estimateDirection(t,o)),this.dirResetIfNeeded_(t,i,o,!0)},goog.i18n.BidiFormatter.prototype.mark=function(){switch(this.contextDir_){case goog.i18n.bidi.Dir.LTR:return goog.i18n.bidi.Format.LRM;case goog.i18n.bidi.Dir.RTL:return goog.i18n.bidi.Format.RLM;default:return""}},goog.i18n.BidiFormatter.prototype.startEdge=function(){return this.contextDir_==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT},goog.i18n.BidiFormatter.prototype.endEdge=function(){return this.contextDir_==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT};