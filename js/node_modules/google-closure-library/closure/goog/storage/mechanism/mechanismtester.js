goog.provide("goog.storage.mechanism.mechanismTester"),goog.setTestOnly(),goog.require("goog.storage.mechanism.ErrorCode"),goog.require("goog.testing.asserts"),goog.require("goog.userAgent"),goog.require("goog.userAgent.product"),goog.require("goog.userAgent.product.isVersion");var mechanism=null,minimumQuota=0;function testSetGet(){mechanism&&(mechanism.set("first","one"),assertEquals("one",mechanism.get("first")))}function testChange(){mechanism&&(mechanism.set("first","one"),mechanism.set("first","two"),assertEquals("two",mechanism.get("first")))}function testRemove(){mechanism&&(mechanism.set("first","one"),mechanism.remove("first"),assertNull(mechanism.get("first")))}function testSetRemoveSet(){mechanism&&(mechanism.set("first","one"),mechanism.remove("first"),mechanism.set("first","one"),assertEquals("one",mechanism.get("first")))}function testRemoveRemove(){mechanism&&(mechanism.remove("first"),mechanism.remove("first"),assertNull(mechanism.get("first")))}function testSetTwo(){mechanism&&(mechanism.set("first","one"),mechanism.set("second","two"),assertEquals("one",mechanism.get("first")),assertEquals("two",mechanism.get("second")))}function testChangeTwo(){mechanism&&(mechanism.set("first","one"),mechanism.set("second","two"),mechanism.set("second","three"),mechanism.set("first","four"),assertEquals("four",mechanism.get("first")),assertEquals("three",mechanism.get("second")))}function testSetRemoveThree(){mechanism&&(mechanism.set("first","one"),mechanism.set("second","two"),mechanism.set("third","three"),mechanism.remove("second"),assertNull(mechanism.get("second")),assertEquals("one",mechanism.get("first")),assertEquals("three",mechanism.get("third")),mechanism.remove("first"),assertNull(mechanism.get("first")),assertEquals("three",mechanism.get("third")),mechanism.remove("third"),assertNull(mechanism.get("third")))}function testEmptyValue(){mechanism&&(mechanism.set("third",""),assertEquals("",mechanism.get("third")))}function testWeirdKeys(){mechanism&&(mechanism.set(" ","space"),mechanism.set("=+!@#$%^&*()-_\\|;:'\",./<>?[]{}~`","control"),mechanism.set("一二三四五六七八九十","ten"),mechanism.set("\0","null"),mechanism.set("\0\0","double null"),mechanism.set("\0A","null A"),mechanism.set("","zero"),assertEquals("space",mechanism.get(" ")),assertEquals("control",mechanism.get("=+!@#$%^&*()-_\\|;:'\",./<>?[]{}~`")),assertEquals("ten",mechanism.get("一二三四五六七八九十")),goog.userAgent.IE||(assertEquals("null",mechanism.get("\0")),assertEquals("double null",mechanism.get("\0\0")),assertEquals("null A",mechanism.get("\0A"))),goog.userAgent.GECKO||assertEquals("zero",mechanism.get("")))}function testQuota(){if(mechanism&&(!goog.userAgent.product.SAFARI||!goog.userAgent.product.isVersion(4)||goog.userAgent.product.isVersion(5))){var e="Ͽ",s=0;try{for(;e.length<minimumQuota;)e+=e,mechanism.set("foo",e),s=e.length}catch(e){if(e!=goog.storage.mechanism.ErrorCode.QUOTA_EXCEEDED)throw e}mechanism.remove("foo"),assertTrue(s>=minimumQuota)}}