goog.provide("goog.structs.Map"),goog.require("goog.iter.Iterator"),goog.require("goog.iter.StopIteration"),goog.structs.Map=function(t,s){this.map_={},this.keys_=[],this.count_=0,this.version_=0;var o=arguments.length;if(o>1){if(o%2)throw new Error("Uneven number of arguments");for(var r=0;r<o;r+=2)this.set(arguments[r],arguments[r+1])}else t&&this.addAll(t)},goog.structs.Map.prototype.getCount=function(){return this.count_},goog.structs.Map.prototype.getValues=function(){this.cleanupKeysArray_();for(var t=[],s=0;s<this.keys_.length;s++){var o=this.keys_[s];t.push(this.map_[o])}return t},goog.structs.Map.prototype.getKeys=function(){return this.cleanupKeysArray_(),this.keys_.concat()},goog.structs.Map.prototype.containsKey=function(t){return goog.structs.Map.hasKey_(this.map_,t)},goog.structs.Map.prototype.containsValue=function(t){for(var s=0;s<this.keys_.length;s++){var o=this.keys_[s];if(goog.structs.Map.hasKey_(this.map_,o)&&this.map_[o]==t)return!0}return!1},goog.structs.Map.prototype.equals=function(t,s){if(this===t)return!0;if(this.count_!=t.getCount())return!1;var o=s||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var r,e=0;r=this.keys_[e];e++)if(!o(this.get(r),t.get(r)))return!1;return!0},goog.structs.Map.defaultEquals=function(t,s){return t===s},goog.structs.Map.prototype.isEmpty=function(){return 0==this.count_},goog.structs.Map.prototype.clear=function(){this.map_={},this.keys_.length=0,this.count_=0,this.version_=0},goog.structs.Map.prototype.remove=function(t){return!!goog.structs.Map.hasKey_(this.map_,t)&&(delete this.map_[t],this.count_--,this.version_++,this.keys_.length>2*this.count_&&this.cleanupKeysArray_(),!0)},goog.structs.Map.prototype.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){for(var t=0,s=0;t<this.keys_.length;){var o=this.keys_[t];goog.structs.Map.hasKey_(this.map_,o)&&(this.keys_[s++]=o),t++}this.keys_.length=s}if(this.count_!=this.keys_.length){var r={};for(t=0,s=0;t<this.keys_.length;){o=this.keys_[t];goog.structs.Map.hasKey_(r,o)||(this.keys_[s++]=o,r[o]=1),t++}this.keys_.length=s}},goog.structs.Map.prototype.get=function(t,s){return goog.structs.Map.hasKey_(this.map_,t)?this.map_[t]:s},goog.structs.Map.prototype.set=function(t,s){goog.structs.Map.hasKey_(this.map_,t)||(this.count_++,this.keys_.push(t),this.version_++),this.map_[t]=s},goog.structs.Map.prototype.addAll=function(t){if(t instanceof goog.structs.Map)for(var s=t.getKeys(),o=0;o<s.length;o++)this.set(s[o],t.get(s[o]));else for(var r in t)this.set(r,t[r])},goog.structs.Map.prototype.forEach=function(t,s){for(var o=this.getKeys(),r=0;r<o.length;r++){var e=o[r],n=this.get(e);t.call(s,n,e,this)}},goog.structs.Map.prototype.clone=function(){return new goog.structs.Map(this)},goog.structs.Map.prototype.transpose=function(){for(var t=new goog.structs.Map,s=0;s<this.keys_.length;s++){var o=this.keys_[s],r=this.map_[o];t.set(r,o)}return t},goog.structs.Map.prototype.toObject=function(){this.cleanupKeysArray_();for(var t={},s=0;s<this.keys_.length;s++){var o=this.keys_[s];t[o]=this.map_[o]}return t},goog.structs.Map.prototype.getKeyIterator=function(){return this.__iterator__(!0)},goog.structs.Map.prototype.getValueIterator=function(){return this.__iterator__(!1)},goog.structs.Map.prototype.__iterator__=function(t){this.cleanupKeysArray_();var s=0,o=this.version_,r=this,e=new goog.iter.Iterator;return e.next=function(){if(o!=r.version_)throw new Error("The map has changed since the iterator was created");if(s>=r.keys_.length)throw goog.iter.StopIteration;var e=r.keys_[s++];return t?e:r.map_[e]},e},goog.structs.Map.hasKey_=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)};