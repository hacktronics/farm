goog.provide("goog.events.ListenerMap"),goog.require("goog.array"),goog.require("goog.events.Listener"),goog.require("goog.object"),goog.events.ListenerMap=function(e){this.src=e,this.listeners={},this.typeCount_=0},goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_},goog.events.ListenerMap.prototype.getListenerCount=function(){var e=0;for(var t in this.listeners)e+=this.listeners[t].length;return e},goog.events.ListenerMap.prototype.add=function(e,t,r,n,o){var s,i=e.toString(),g=this.listeners[i];g||(g=this.listeners[i]=[],this.typeCount_++);var a=goog.events.ListenerMap.findListenerIndex_(g,t,n,o);return a>-1?(s=g[a],r||(s.callOnce=!1)):((s=new goog.events.Listener(t,null,this.src,i,!!n,o)).callOnce=r,g.push(s)),s},goog.events.ListenerMap.prototype.remove=function(e,t,r,n){var o=e.toString();if(!(o in this.listeners))return!1;var s=this.listeners[o],i=goog.events.ListenerMap.findListenerIndex_(s,t,r,n);return i>-1&&(s[i].markAsRemoved(),goog.array.removeAt(s,i),0==s.length&&(delete this.listeners[o],this.typeCount_--),!0)},goog.events.ListenerMap.prototype.removeByKey=function(e){var t=e.type;if(!(t in this.listeners))return!1;var r=goog.array.remove(this.listeners[t],e);return r&&(e.markAsRemoved(),0==this.listeners[t].length&&(delete this.listeners[t],this.typeCount_--)),r},goog.events.ListenerMap.prototype.removeAll=function(e){var t=e&&e.toString(),r=0;for(var n in this.listeners)if(!t||n==t){for(var o=this.listeners[n],s=0;s<o.length;s++)++r,o[s].markAsRemoved();delete this.listeners[n],this.typeCount_--}return r},goog.events.ListenerMap.prototype.getListeners=function(e,t){var r=this.listeners[e.toString()],n=[];if(r)for(var o=0;o<r.length;++o){var s=r[o];s.capture==t&&n.push(s)}return n},goog.events.ListenerMap.prototype.getListener=function(e,t,r,n){var o=this.listeners[e.toString()],s=-1;return o&&(s=goog.events.ListenerMap.findListenerIndex_(o,t,r,n)),s>-1?o[s]:null},goog.events.ListenerMap.prototype.hasListener=function(e,t){var r=void 0!==e,n=r?e.toString():"",o=void 0!==t;return goog.object.some(this.listeners,function(e,s){for(var i=0;i<e.length;++i)if(!(r&&e[i].type!=n||o&&e[i].capture!=t))return!0;return!1})},goog.events.ListenerMap.findListenerIndex_=function(e,t,r,n){for(var o=0;o<e.length;++o){var s=e[o];if(!s.removed&&s.listener==t&&s.capture==!!r&&s.handler==n)return o}return-1};