goog.provide("goog.events.FileDropHandler"),goog.provide("goog.events.FileDropHandler.EventType"),goog.require("goog.array"),goog.require("goog.dom"),goog.require("goog.events.BrowserEvent"),goog.require("goog.events.EventHandler"),goog.require("goog.events.EventTarget"),goog.require("goog.events.EventType"),goog.require("goog.log"),goog.require("goog.log.Level"),goog.events.FileDropHandler=function(e,o){goog.events.EventTarget.call(this),this.eventHandler_=new goog.events.EventHandler(this);var t=e;o&&(t=goog.dom.getOwnerDocument(e)),this.eventHandler_.listen(t,goog.events.EventType.DRAGENTER,this.onDocDragEnter_),t!=e&&this.eventHandler_.listen(t,goog.events.EventType.DRAGOVER,this.onDocDragOver_),this.eventHandler_.listen(e,goog.events.EventType.DRAGOVER,this.onElemDragOver_),this.eventHandler_.listen(e,goog.events.EventType.DROP,this.onElemDrop_)},goog.inherits(goog.events.FileDropHandler,goog.events.EventTarget),goog.events.FileDropHandler.prototype.dndContainsFiles_=!1,goog.events.FileDropHandler.prototype.logger_=goog.log.getLogger("goog.events.FileDropHandler"),goog.events.FileDropHandler.EventType={DROP:goog.events.EventType.DROP},goog.events.FileDropHandler.prototype.disposeInternal=function(){goog.events.FileDropHandler.superClass_.disposeInternal.call(this),this.eventHandler_.dispose()},goog.events.FileDropHandler.prototype.dispatch_=function(e){goog.log.fine(this.logger_,"Firing DROP event...");var o=new goog.events.BrowserEvent(e.getBrowserEvent());o.type=goog.events.FileDropHandler.EventType.DROP,this.dispatchEvent(o)},goog.events.FileDropHandler.prototype.onDocDragEnter_=function(e){goog.log.log(this.logger_,goog.log.Level.FINER,'"'+e.target.id+'" ('+e.target+") dispatched: "+e.type);var o=e.getBrowserEvent().dataTransfer;this.dndContainsFiles_=!(!o||!(o.types&&(goog.array.contains(o.types,"Files")||goog.array.contains(o.types,"public.file-url"))||o.files&&o.files.length>0)),this.dndContainsFiles_&&e.preventDefault(),goog.log.log(this.logger_,goog.log.Level.FINER,"dndContainsFiles_: "+this.dndContainsFiles_)},goog.events.FileDropHandler.prototype.onDocDragOver_=function(e){(goog.log.log(this.logger_,goog.log.Level.FINEST,'"'+e.target.id+'" ('+e.target+") dispatched: "+e.type),this.dndContainsFiles_)&&(e.preventDefault(),e.getBrowserEvent().dataTransfer.dropEffect="none")},goog.events.FileDropHandler.prototype.onElemDragOver_=function(e){if(goog.log.log(this.logger_,goog.log.Level.FINEST,'"'+e.target.id+'" ('+e.target+") dispatched: "+e.type),this.dndContainsFiles_){e.preventDefault(),e.stopPropagation();var o=e.getBrowserEvent().dataTransfer;try{o.effectAllowed="all"}catch(e){}o.dropEffect="copy"}},goog.events.FileDropHandler.prototype.onElemDrop_=function(e){goog.log.log(this.logger_,goog.log.Level.FINER,'"'+e.target.id+'" ('+e.target+") dispatched: "+e.type),this.dndContainsFiles_&&(e.preventDefault(),e.stopPropagation(),this.dispatch_(e))};