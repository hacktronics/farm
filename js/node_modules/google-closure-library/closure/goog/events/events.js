goog.provide("goog.events"),goog.provide("goog.events.CaptureSimulationMode"),goog.provide("goog.events.Key"),goog.provide("goog.events.ListenableType"),goog.forwardDeclare("goog.debug.ErrorHandler"),goog.forwardDeclare("goog.events.EventWrapper"),goog.require("goog.asserts"),goog.require("goog.debug.entryPointRegistry"),goog.require("goog.events.BrowserEvent"),goog.require("goog.events.BrowserFeature"),goog.require("goog.events.Listenable"),goog.require("goog.events.ListenerMap"),goog.events.Key,goog.events.ListenableType,goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1e6*Math.random()|0),goog.events.onString_="on",goog.events.onStringMap_={},goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2},goog.events.CAPTURE_SIMULATION_MODE=goog.define("goog.events.CAPTURE_SIMULATION_MODE",2),goog.events.listenerCountEstimate_=0,goog.events.listen=function(e,n,t,o,r){if(o&&o.once)return goog.events.listenOnce(e,n,t,o,r);if(goog.isArray(n)){for(var g=0;g<n.length;g++)goog.events.listen(e,n[g],t,o,r);return null}if(t=goog.events.wrapListener(t),goog.events.Listenable.isImplementedBy(e)){var s=goog.isObject(o)?!!o.capture:!!o;return e.listen(n,t,s,r)}return goog.events.listen_(e,n,t,!1,o,r)},goog.events.listen_=function(e,n,t,o,r,g){if(!n)throw new Error("Invalid event type");var s=goog.isObject(r)?!!r.capture:!!r;if(s&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL)return goog.asserts.fail("Can not register capture listener in IE8-."),null;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT)return null}var i=goog.events.getListenerMap_(e);i||(e[goog.events.LISTENER_MAP_PROP_]=i=new goog.events.ListenerMap(e));var v=i.add(n,t,o,s,g);if(v.proxy)return v;var a=goog.events.getProxy();if(v.proxy=a,a.src=e,a.listener=v,e.addEventListener)goog.events.BrowserFeature.PASSIVE_EVENTS||(r=s),void 0===r&&(r=!1),e.addEventListener(n.toString(),a,r);else if(e.attachEvent)e.attachEvent(goog.events.getOnString_(n.toString()),a);else{if(!e.addListener||!e.removeListener)throw new Error("addEventListener and attachEvent are unavailable.");goog.asserts.assert("change"===n,"MediaQueryList only has a change event"),e.addListener(a)}return goog.events.listenerCountEstimate_++,v},goog.events.getProxy=function(){var e=goog.events.handleBrowserEvent_,n=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(t){return e.call(n.src,n.listener,t)}:function(t){var o=e.call(n.src,n.listener,t);if(!o)return o};return n},goog.events.listenOnce=function(e,n,t,o,r){if(goog.isArray(n)){for(var g=0;g<n.length;g++)goog.events.listenOnce(e,n[g],t,o,r);return null}if(t=goog.events.wrapListener(t),goog.events.Listenable.isImplementedBy(e)){var s=goog.isObject(o)?!!o.capture:!!o;return e.listenOnce(n,t,s,r)}return goog.events.listen_(e,n,t,!0,o,r)},goog.events.listenWithWrapper=function(e,n,t,o,r){n.listen(e,t,o,r)},goog.events.unlisten=function(e,n,t,o,r){if(goog.isArray(n)){for(var g=0;g<n.length;g++)goog.events.unlisten(e,n[g],t,o,r);return null}var s=goog.isObject(o)?!!o.capture:!!o;if(t=goog.events.wrapListener(t),goog.events.Listenable.isImplementedBy(e))return e.unlisten(n,t,s,r);if(!e)return!1;var i=goog.events.getListenerMap_(e);if(i){var v=i.getListener(n,t,s,r);if(v)return goog.events.unlistenByKey(v)}return!1},goog.events.unlistenByKey=function(e){if("number"==typeof e)return!1;var n=e;if(!n||n.removed)return!1;var t=n.src;if(goog.events.Listenable.isImplementedBy(t))return t.unlistenByKey(n);var o=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(o,r,n.capture):t.detachEvent?t.detachEvent(goog.events.getOnString_(o),r):t.addListener&&t.removeListener&&t.removeListener(r),goog.events.listenerCountEstimate_--;var g=goog.events.getListenerMap_(t);return g?(g.removeByKey(n),0==g.getTypeCount()&&(g.src=null,t[goog.events.LISTENER_MAP_PROP_]=null)):n.markAsRemoved(),!0},goog.events.unlistenWithWrapper=function(e,n,t,o,r){n.unlisten(e,t,o,r)},goog.events.removeAll=function(e,n){if(!e)return 0;if(goog.events.Listenable.isImplementedBy(e))return e.removeAllListeners(n);var t=goog.events.getListenerMap_(e);if(!t)return 0;var o=0,r=n&&n.toString();for(var g in t.listeners)if(!r||g==r)for(var s=t.listeners[g].concat(),i=0;i<s.length;++i)goog.events.unlistenByKey(s[i])&&++o;return o},goog.events.getListeners=function(e,n,t){if(goog.events.Listenable.isImplementedBy(e))return e.getListeners(n,t);if(!e)return[];var o=goog.events.getListenerMap_(e);return o?o.getListeners(n,t):[]},goog.events.getListener=function(e,n,t,o,r){t=goog.events.wrapListener(t);var g=!!o;if(goog.events.Listenable.isImplementedBy(e))return e.getListener(n,t,g,r);if(!e)return null;var s=goog.events.getListenerMap_(e);return s?s.getListener(n,t,g,r):null},goog.events.hasListener=function(e,n,t){if(goog.events.Listenable.isImplementedBy(e))return e.hasListener(n,t);var o=goog.events.getListenerMap_(e);return!!o&&o.hasListener(n,t)},goog.events.expose=function(e){var n=[];for(var t in e)e[t]&&e[t].id?n.push(t+" = "+e[t]+" ("+e[t].id+")"):n.push(t+" = "+e[t]);return n.join("\n")},goog.events.getOnString_=function(e){return e in goog.events.onStringMap_?goog.events.onStringMap_[e]:goog.events.onStringMap_[e]=goog.events.onString_+e},goog.events.fireListeners=function(e,n,t,o){return goog.events.Listenable.isImplementedBy(e)?e.fireListeners(n,t,o):goog.events.fireListeners_(e,n,t,o)},goog.events.fireListeners_=function(e,n,t,o){var r=!0,g=goog.events.getListenerMap_(e);if(g){var s=g.listeners[n.toString()];if(s){s=s.concat();for(var i=0;i<s.length;i++){var v=s[i];if(v&&v.capture==t&&!v.removed){var a=goog.events.fireListener(v,o);r=r&&!1!==a}}}}return r},goog.events.fireListener=function(e,n){var t=e.listener,o=e.handler||e.src;return e.callOnce&&goog.events.unlistenByKey(e),t.call(o,n)},goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_},goog.events.dispatchEvent=function(e,n){return goog.asserts.assert(goog.events.Listenable.isImplementedBy(e),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance."),e.dispatchEvent(n)},goog.events.protectBrowserEventEntryPoint=function(e){goog.events.handleBrowserEvent_=e.protectEntryPoint(goog.events.handleBrowserEvent_)},goog.events.handleBrowserEvent_=function(e,n){if(e.removed)return!0;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var t=n||goog.getObjectByName("window.event"),o=new goog.events.BrowserEvent(t,this),r=!0;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(t)){goog.events.markIeEvent_(t);for(var g=[],s=o.currentTarget;s;s=s.parentNode)g.push(s);for(var i=e.type,v=g.length-1;!o.propagationStopped_&&v>=0;v--){o.currentTarget=g[v];var a=goog.events.fireListeners_(g[v],i,!0,o);r=r&&a}for(v=0;!o.propagationStopped_&&v<g.length;v++){o.currentTarget=g[v];a=goog.events.fireListeners_(g[v],i,!1,o);r=r&&a}}}else r=goog.events.fireListener(e,o);return r}return goog.events.fireListener(e,new goog.events.BrowserEvent(n,this))},goog.events.markIeEvent_=function(e){var n=!1;if(0==e.keyCode)try{return void(e.keyCode=-1)}catch(e){n=!0}(n||null==e.returnValue)&&(e.returnValue=!0)},goog.events.isMarkedIeEvent_=function(e){return e.keyCode<0||null!=e.returnValue},goog.events.uniqueIdCounter_=0,goog.events.getUniqueId=function(e){return e+"_"+goog.events.uniqueIdCounter_++},goog.events.getListenerMap_=function(e){var n=e[goog.events.LISTENER_MAP_PROP_];return n instanceof goog.events.ListenerMap?n:null},goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1e9*Math.random()>>>0),goog.events.wrapListener=function(e){return goog.asserts.assert(e,"Listener can not be null."),goog.isFunction(e)?e:(goog.asserts.assert(e.handleEvent,"An object listener must have handleEvent method."),e[goog.events.LISTENER_WRAPPER_PROP_]||(e[goog.events.LISTENER_WRAPPER_PROP_]=function(n){return e.handleEvent(n)}),e[goog.events.LISTENER_WRAPPER_PROP_])},goog.debug.entryPointRegistry.register(function(e){goog.events.handleBrowserEvent_=e(goog.events.handleBrowserEvent_)});