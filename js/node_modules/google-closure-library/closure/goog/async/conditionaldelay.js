goog.provide("goog.async.ConditionalDelay"),goog.require("goog.Disposable"),goog.require("goog.async.Delay"),goog.async.ConditionalDelay=function(o,i){goog.async.ConditionalDelay.base(this,"constructor"),this.interval_=0,this.runUntil_=0,this.isDone_=!1,this.listener_=o,this.handler_=i,this.delay_=new goog.async.Delay(goog.bind(this.onTick_,this),0,this)},goog.inherits(goog.async.ConditionalDelay,goog.Disposable),goog.async.ConditionalDelay.prototype.disposeInternal=function(){this.delay_.dispose(),delete this.listener_,delete this.handler_,goog.async.ConditionalDelay.superClass_.disposeInternal.call(this)},goog.async.ConditionalDelay.prototype.start=function(o,i){this.stop(),this.isDone_=!1;var t=i||0;this.interval_=Math.max(o||0,0),this.runUntil_=t<0?-1:goog.now()+t,this.delay_.start(t<0?this.interval_:Math.min(this.interval_,t))},goog.async.ConditionalDelay.prototype.stop=function(){this.delay_.stop()},goog.async.ConditionalDelay.prototype.isActive=function(){return this.delay_.isActive()},goog.async.ConditionalDelay.prototype.isDone=function(){return this.isDone_},goog.async.ConditionalDelay.prototype.onSuccess=function(){},goog.async.ConditionalDelay.prototype.onFailure=function(){},goog.async.ConditionalDelay.prototype.onTick_=function(){if(this.listener_.call(this.handler_))this.isDone_=!0,this.onSuccess();else if(this.runUntil_<0)this.delay_.start(this.interval_);else{var o=this.runUntil_-goog.now();o<=0?this.onFailure():this.delay_.start(Math.min(this.interval_,o))}};