goog.provide("goog.async.AnimationDelay"),goog.require("goog.Disposable"),goog.require("goog.events"),goog.require("goog.functions"),goog.async.AnimationDelay=function(i,t,n){goog.async.AnimationDelay.base(this,"constructor"),this.id_=null,this.usingListeners_=!1,this.listener_=i,this.handler_=n,this.win_=t||window,this.callback_=goog.bind(this.doAction_,this)},goog.inherits(goog.async.AnimationDelay,goog.Disposable),goog.async.AnimationDelay.TIMEOUT=20,goog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_="MozBeforePaint",goog.async.AnimationDelay.prototype.start=function(){this.stop(),this.usingListeners_=!1;var i=this.getRaf_(),t=this.getCancelRaf_();i&&!t&&this.win_.mozRequestAnimationFrame?(this.id_=goog.events.listen(this.win_,goog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_,this.callback_),this.win_.mozRequestAnimationFrame(null),this.usingListeners_=!0):this.id_=i&&t?i.call(this.win_,this.callback_):this.win_.setTimeout(goog.functions.lock(this.callback_),goog.async.AnimationDelay.TIMEOUT)},goog.async.AnimationDelay.prototype.startIfNotActive=function(){this.isActive()||this.start()},goog.async.AnimationDelay.prototype.stop=function(){if(this.isActive()){var i=this.getRaf_(),t=this.getCancelRaf_();i&&!t&&this.win_.mozRequestAnimationFrame?goog.events.unlistenByKey(this.id_):i&&t?t.call(this.win_,this.id_):this.win_.clearTimeout(this.id_)}this.id_=null},goog.async.AnimationDelay.prototype.fire=function(){this.stop(),this.doAction_()},goog.async.AnimationDelay.prototype.fireIfActive=function(){this.isActive()&&this.fire()},goog.async.AnimationDelay.prototype.isActive=function(){return null!=this.id_},goog.async.AnimationDelay.prototype.doAction_=function(){this.usingListeners_&&this.id_&&goog.events.unlistenByKey(this.id_),this.id_=null,this.listener_.call(this.handler_,goog.now())},goog.async.AnimationDelay.prototype.disposeInternal=function(){this.stop(),goog.async.AnimationDelay.base(this,"disposeInternal")},goog.async.AnimationDelay.prototype.getRaf_=function(){var i=this.win_;return i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame||null},goog.async.AnimationDelay.prototype.getCancelRaf_=function(){var i=this.win_;return i.cancelAnimationFrame||i.cancelRequestAnimationFrame||i.webkitCancelRequestAnimationFrame||i.mozCancelRequestAnimationFrame||i.oCancelRequestAnimationFrame||i.msCancelRequestAnimationFrame||null};