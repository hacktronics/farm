goog.provide("goog.fx.Animation"),goog.provide("goog.fx.Animation.EventType"),goog.provide("goog.fx.Animation.State"),goog.provide("goog.fx.AnimationEvent"),goog.require("goog.array"),goog.require("goog.asserts"),goog.require("goog.events.Event"),goog.require("goog.fx.Transition"),goog.require("goog.fx.TransitionBase"),goog.require("goog.fx.anim"),goog.require("goog.fx.anim.Animated"),goog.fx.Animation=function(t,o,i,s){if(goog.fx.Animation.base(this,"constructor"),!goog.isArray(t)||!goog.isArray(o))throw new Error("Start and end parameters must be arrays");if(t.length!=o.length)throw new Error("Start and end points must be the same length");this.startPoint=t,this.endPoint=o,this.duration=i,this.accel_=s,this.coords=[],this.useRightPositioningForRtl_=!1,this.fps_=0,this.progress=0,this.lastFrame=null},goog.inherits(goog.fx.Animation,goog.fx.TransitionBase),goog.fx.Animation.prototype.getDuration=function(){return this.duration},goog.fx.Animation.prototype.enableRightPositioningForRtl=function(t){this.useRightPositioningForRtl_=t},goog.fx.Animation.prototype.isRightPositioningForRtlEnabled=function(){return this.useRightPositioningForRtl_},goog.fx.Animation.EventType={PLAY:goog.fx.Transition.EventType.PLAY,BEGIN:goog.fx.Transition.EventType.BEGIN,RESUME:goog.fx.Transition.EventType.RESUME,END:goog.fx.Transition.EventType.END,STOP:goog.fx.Transition.EventType.STOP,FINISH:goog.fx.Transition.EventType.FINISH,PAUSE:goog.fx.Transition.EventType.PAUSE,ANIMATE:"animate",DESTROY:"destroy"},goog.fx.Animation.TIMEOUT=goog.fx.anim.TIMEOUT,goog.fx.Animation.State=goog.fx.TransitionBase.State,goog.fx.Animation.setAnimationWindow=function(t){goog.fx.anim.setAnimationWindow(t)},goog.fx.Animation.prototype.play=function(t){if(t||this.isStopped())this.progress=0,this.coords=this.startPoint;else if(this.isPlaying())return!1;goog.fx.anim.unregisterAnimation(this);var o=goog.now();return this.startTime=o,this.isPaused()&&(this.startTime-=this.duration*this.progress),this.endTime=this.startTime+this.duration,this.lastFrame=this.startTime,this.progress||this.onBegin(),this.onPlay(),this.isPaused()&&this.onResume(),this.setStatePlaying(),goog.fx.anim.registerAnimation(this),this.cycle(o),!0},goog.fx.Animation.prototype.stop=function(t){goog.fx.anim.unregisterAnimation(this),this.setStateStopped(),t&&(this.progress=1),this.updateCoords_(this.progress),this.onStop(),this.onEnd()},goog.fx.Animation.prototype.pause=function(){this.isPlaying()&&(goog.fx.anim.unregisterAnimation(this),this.setStatePaused(),this.onPause())},goog.fx.Animation.prototype.getProgress=function(){return this.progress},goog.fx.Animation.prototype.setProgress=function(t){if(this.progress=t,this.isPlaying()){var o=goog.now();this.startTime=o-this.duration*this.progress,this.endTime=this.startTime+this.duration}},goog.fx.Animation.prototype.disposeInternal=function(){this.isStopped()||this.stop(!1),this.onDestroy(),goog.fx.Animation.base(this,"disposeInternal")},goog.fx.Animation.prototype.destroy=function(){this.dispose()},goog.fx.Animation.prototype.onAnimationFrame=function(t){this.cycle(t)},goog.fx.Animation.prototype.cycle=function(t){goog.asserts.assertNumber(this.startTime),goog.asserts.assertNumber(this.endTime),goog.asserts.assertNumber(this.lastFrame),t<this.startTime&&(this.endTime=t+this.endTime-this.startTime,this.startTime=t),this.progress=(t-this.startTime)/(this.endTime-this.startTime),this.progress>1&&(this.progress=1),this.fps_=1e3/(t-this.lastFrame),this.lastFrame=t,this.updateCoords_(this.progress),1==this.progress?(this.setStateStopped(),goog.fx.anim.unregisterAnimation(this),this.onFinish(),this.onEnd()):this.isPlaying()&&this.onAnimate()},goog.fx.Animation.prototype.updateCoords_=function(t){goog.isFunction(this.accel_)&&(t=this.accel_(t)),this.coords=new Array(this.startPoint.length);for(var o=0;o<this.startPoint.length;o++)this.coords[o]=(this.endPoint[o]-this.startPoint[o])*t+this.startPoint[o]},goog.fx.Animation.prototype.onAnimate=function(){this.dispatchAnimationEvent(goog.fx.Animation.EventType.ANIMATE)},goog.fx.Animation.prototype.onDestroy=function(){this.dispatchAnimationEvent(goog.fx.Animation.EventType.DESTROY)},goog.fx.Animation.prototype.dispatchAnimationEvent=function(t){this.dispatchEvent(new goog.fx.AnimationEvent(t,this))},goog.fx.AnimationEvent=function(t,o){goog.fx.AnimationEvent.base(this,"constructor",t),this.coords=o.coords,this.x=o.coords[0],this.y=o.coords[1],this.z=o.coords[2],this.duration=o.duration,this.progress=o.getProgress(),this.fps=o.fps_,this.state=o.getStateInternal(),this.anim=o},goog.inherits(goog.fx.AnimationEvent,goog.events.Event),goog.fx.AnimationEvent.prototype.coordsAsInts=function(){return goog.array.map(this.coords,Math.round)};