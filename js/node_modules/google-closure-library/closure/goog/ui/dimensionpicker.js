goog.provide("goog.ui.DimensionPicker"),goog.require("goog.events.BrowserEvent.PointerType"),goog.require("goog.events.EventType"),goog.require("goog.events.KeyCodes"),goog.require("goog.math.Size"),goog.require("goog.ui.Component"),goog.require("goog.ui.ComponentUtil"),goog.require("goog.ui.Control"),goog.require("goog.ui.DimensionPickerRenderer"),goog.require("goog.ui.registry"),goog.ui.DimensionPicker=function(e,i){goog.ui.Control.call(this,null,e||goog.ui.DimensionPickerRenderer.getInstance(),i),this.size_=new goog.math.Size(this.minColumns,this.minRows)},goog.inherits(goog.ui.DimensionPicker,goog.ui.Control),goog.ui.DimensionPicker.prototype.minColumns=5,goog.ui.DimensionPicker.prototype.minRows=5,goog.ui.DimensionPicker.prototype.maxColumns=20,goog.ui.DimensionPicker.prototype.maxRows=20,goog.ui.DimensionPicker.prototype.size_,goog.ui.DimensionPicker.prototype.highlightedRows_=1,goog.ui.DimensionPicker.prototype.highlightedColumns_=1,goog.ui.DimensionPicker.prototype.enterDocument=function(){goog.ui.DimensionPicker.superClass_.enterDocument.call(this);var e=goog.ui.ComponentUtil.getMouseEventType(this),i=this.getHandler();i.listen(this.getRenderer().getMouseMoveElement(this),e.MOUSEMOVE,this.handleMouseMove).listen(this.getDomHelper().getWindow(),goog.events.EventType.RESIZE,this.handleWindowResize);var o=this.getParent();o&&i.listen(o,goog.ui.Component.EventType.SHOW,this.handleShow_)},goog.ui.DimensionPicker.prototype.exitDocument=function(){goog.ui.DimensionPicker.superClass_.exitDocument.call(this);var e=goog.ui.ComponentUtil.getMouseEventType(this),i=this.getHandler();i.unlisten(this.getRenderer().getMouseMoveElement(this),e.MOUSEMOVE,this.handleMouseMove).unlisten(this.getDomHelper().getWindow(),goog.events.EventType.RESIZE,this.handleWindowResize);var o=this.getParent();o&&i.unlisten(o,goog.ui.Component.EventType.SHOW,this.handleShow_)},goog.ui.DimensionPicker.prototype.handleShow_=function(){this.isVisible()&&this.setValue(1,1)},goog.ui.DimensionPicker.prototype.disposeInternal=function(){goog.ui.DimensionPicker.superClass_.disposeInternal.call(this),delete this.size_},goog.ui.DimensionPicker.prototype.handleMouseMove=function(e){var i=this.getRenderer().getGridOffsetX(this,this.isRightToLeft()?e.target.offsetWidth-e.offsetX:e.offsetX),o=this.getRenderer().getGridOffsetY(this,e.offsetY);this.setValue(i,o)},goog.ui.DimensionPicker.prototype.handleMouseDown=function(e){goog.ui.DimensionPicker.isTouchEvent_(e)&&!this.isEventOnGrid_(e)||(goog.ui.DimensionPicker.base(this,"handleMouseDown",e),goog.ui.DimensionPicker.isTouchEvent_(e)&&this.handleMouseMove(e))},goog.ui.DimensionPicker.prototype.handleMouseUp=function(e){goog.ui.DimensionPicker.isTouchEvent_(e)&&!this.isEventOnGrid_(e)||goog.ui.DimensionPicker.base(this,"handleMouseUp",e)},goog.ui.DimensionPicker.prototype.handleWindowResize=function(e){this.getRenderer().positionMouseCatcher(this)},goog.ui.DimensionPicker.prototype.handleKeyEvent=function(e){var i=this.highlightedRows_,o=this.highlightedColumns_;switch(e.keyCode){case goog.events.KeyCodes.DOWN:i++;break;case goog.events.KeyCodes.UP:i--;break;case goog.events.KeyCodes.LEFT:if(this.isRightToLeft())o++;else{if(1==o)return!1;o--}break;case goog.events.KeyCodes.RIGHT:if(this.isRightToLeft()){if(1==o)return!1;o--}else o++;break;default:return goog.ui.DimensionPicker.superClass_.handleKeyEvent.call(this,e)}return this.setValue(o,i),!0},goog.ui.DimensionPicker.prototype.getSize=function(){return this.size_},goog.ui.DimensionPicker.prototype.getValue=function(){return new goog.math.Size(this.highlightedColumns_,this.highlightedRows_)},goog.ui.DimensionPicker.prototype.setValue=function(e,i){if(void 0===i&&(i=e.height,e=e.width),e=Math.max(1,e),i=Math.max(1,i),e=Math.min(this.maxColumns,e),i=Math.min(this.maxRows,i),this.highlightedColumns_!=e||this.highlightedRows_!=i){var o=this.getRenderer();this.size_.width=Math.max(Math.min(e+1,this.maxColumns),this.minColumns),this.size_.height=Math.max(Math.min(i+1,this.maxRows),this.minRows),o.updateSize(this,this.getElement()),this.highlightedColumns_=e,this.highlightedRows_=i,o.setHighlightedSize(this,e,i)}},goog.ui.DimensionPicker.prototype.isEventOnGrid_=function(e){var i=this.getRenderer().getMouseMoveElement(this).getBoundingClientRect();return e.clientX>=i.left&&e.clientX<=i.right&&e.clientY>=i.top&&e.clientY<=i.bottom},goog.ui.DimensionPicker.isTouchEvent_=function(e){return e.pointerType&&e.pointerType!=goog.events.BrowserEvent.PointerType.MOUSE},goog.ui.registry.setDecoratorByClassName(goog.ui.DimensionPickerRenderer.CSS_CLASS,function(){return new goog.ui.DimensionPicker});