goog.provide("goog.ui.editor.ToolbarController"),goog.require("goog.editor.Field"),goog.require("goog.events.EventHandler"),goog.require("goog.events.EventTarget"),goog.require("goog.ui.Component"),goog.ui.editor.ToolbarController=function(o,t){goog.events.EventTarget.call(this),this.handler_=new goog.events.EventHandler(this),this.field_=o,this.toolbar_=t,this.queryCommands_=[],this.toolbar_.forEachChild(function(o){o.queryable&&this.queryCommands_.push(this.getComponentId(o.getId()))},this),this.toolbar_.setFocusable(!1),this.handler_.listen(this.field_,goog.editor.Field.EventType.COMMAND_VALUE_CHANGE,this.updateToolbar).listen(this.toolbar_,goog.ui.Component.EventType.ACTION,this.handleAction)},goog.inherits(goog.ui.editor.ToolbarController,goog.events.EventTarget),goog.ui.editor.ToolbarController.prototype.getComponentId=function(o){return o},goog.ui.editor.ToolbarController.prototype.getCommand=function(o){return o},goog.ui.editor.ToolbarController.prototype.getHandler=function(){return this.handler_},goog.ui.editor.ToolbarController.prototype.getField=function(){return this.field_},goog.ui.editor.ToolbarController.prototype.getToolbar=function(){return this.toolbar_},goog.ui.editor.ToolbarController.prototype.isVisible=function(){return this.toolbar_.isVisible()},goog.ui.editor.ToolbarController.prototype.setVisible=function(o){this.toolbar_.setVisible(o)},goog.ui.editor.ToolbarController.prototype.isEnabled=function(){return this.toolbar_.isEnabled()},goog.ui.editor.ToolbarController.prototype.setEnabled=function(o){this.toolbar_.setEnabled(o)},goog.ui.editor.ToolbarController.prototype.blur=function(){this.toolbar_.handleBlur(null)},goog.ui.editor.ToolbarController.prototype.disposeInternal=function(){goog.ui.editor.ToolbarController.superClass_.disposeInternal.call(this),this.handler_&&(this.handler_.dispose(),delete this.handler_),this.toolbar_&&(this.toolbar_.dispose(),delete this.toolbar_),delete this.field_,delete this.queryCommands_},goog.ui.editor.ToolbarController.prototype.updateToolbar=function(o){if(this.toolbar_.isEnabled()&&this.field_.isSelectionEditable()&&this.dispatchEvent(goog.ui.Component.EventType.CHANGE)){var t;try{o.commands,t=this.field_.queryCommandValue(o.commands||this.queryCommands_)}catch(o){t={}}this.updateToolbarFromState(t)}},goog.ui.editor.ToolbarController.prototype.updateToolbarFromState=function(o){for(var t in o){var e=this.toolbar_.getChild(this.getComponentId(t));if(e){var r=o[t];e.updateFromValue?e.updateFromValue(r):e.setChecked(!!r)}}},goog.ui.editor.ToolbarController.prototype.handleAction=function(o){var t=this.getCommand(o.target.getId());this.field_.execCommand(t,o.target.getValue())};