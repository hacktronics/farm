goog.provide("goog.ui.ac.ArrayMatcher"),goog.require("goog.string"),goog.ui.ac.ArrayMatcher=function(r,o){this.rows_=r||[],this.useSimilar_=!o},goog.ui.ac.ArrayMatcher.prototype.setRows=function(r){this.rows_=r||[]},goog.ui.ac.ArrayMatcher.prototype.requestMatchingRows=function(r,o,t,e){t(r,this.useSimilar_?goog.ui.ac.ArrayMatcher.getMatchesForRows(r,o,this.rows_):this.getPrefixMatches(r,o))},goog.ui.ac.ArrayMatcher.getMatchesForRows=function(r,o,t){var e=goog.ui.ac.ArrayMatcher.getPrefixMatchesForRows(r,o,t);return 0==e.length&&(e=goog.ui.ac.ArrayMatcher.getSimilarMatchesForRows(r,o,t)),e},goog.ui.ac.ArrayMatcher.prototype.getPrefixMatches=function(r,o){return goog.ui.ac.ArrayMatcher.getPrefixMatchesForRows(r,o,this.rows_)},goog.ui.ac.ArrayMatcher.getPrefixMatchesForRows=function(r,o,t){var e=[];if(""!=r)for(var a=goog.string.regExpEscape(r),i=new RegExp("(^|\\W+)"+a,"i"),g=0;g<t.length&&e.length<o;g++){var s=t[g];String(s).match(i)&&e.push(s)}return e},goog.ui.ac.ArrayMatcher.prototype.getSimilarRows=function(r,o){return goog.ui.ac.ArrayMatcher.getSimilarMatchesForRows(r,o,this.rows_)},goog.ui.ac.ArrayMatcher.getSimilarMatchesForRows=function(r,o,t){for(var e=[],a=0;a<t.length;a++){var i=t[a],g=r.toLowerCase(),s=String(i).toLowerCase(),c=0;if(-1!=s.indexOf(g))c=parseInt((s.indexOf(g)/4).toString(),10);else for(var n,h=g.split(""),u=-1,M=10,f=0;n=h[f];f++){var w=s.indexOf(n);if(w>u){var y=w-u-1;y>M-5&&(y=M-5),c+=y,u=w}else c+=M,M+=5}c<6*g.length&&e.push({str:i,score:c,index:a})}e.sort(function(r,o){var t=r.score-o.score;return 0!=t?t:r.index-o.index});var p=[];for(f=0;f<o&&f<e.length;f++)p.push(e[f].str);return p};