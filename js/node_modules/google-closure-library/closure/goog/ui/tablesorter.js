goog.provide("goog.ui.TableSorter"),goog.provide("goog.ui.TableSorter.EventType"),goog.require("goog.array"),goog.require("goog.dom"),goog.require("goog.dom.TagName"),goog.require("goog.dom.classlist"),goog.require("goog.events.EventType"),goog.require("goog.functions"),goog.require("goog.ui.Component"),goog.ui.TableSorter=function(o){goog.ui.Component.call(this,o),this.header_=null,this.reversed_=!1,this.defaultSortFunction_=goog.ui.TableSorter.numericSort,this.sortFunctions_=[]},goog.inherits(goog.ui.TableSorter,goog.ui.Component),goog.tagUnsealableClass(goog.ui.TableSorter),goog.ui.TableSorter.prototype.sortableHeaderRowIndex_=0,goog.ui.TableSorter.prototype.setSortableHeaderRowIndex=function(o){if(this.isInDocument())throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);this.sortableHeaderRowIndex_=o},goog.ui.TableSorter.EventType={BEFORESORT:"beforesort",SORT:"sort"},goog.ui.TableSorter.prototype.canDecorate=function(o){return o.tagName==goog.dom.TagName.TABLE},goog.ui.TableSorter.prototype.enterDocument=function(){goog.ui.TableSorter.superClass_.enterDocument.call(this);var o=this.getElement().tHead.rows[this.sortableHeaderRowIndex_];this.getHandler().listen(o,goog.events.EventType.CLICK,this.sort_)},goog.ui.TableSorter.prototype.getSortColumn=function(){return this.header_?this.header_.cellIndex:-1},goog.ui.TableSorter.prototype.isSortReversed=function(){return this.reversed_},goog.ui.TableSorter.prototype.getDefaultSortFunction=function(){return this.defaultSortFunction_},goog.ui.TableSorter.prototype.setDefaultSortFunction=function(o){this.defaultSortFunction_=o},goog.ui.TableSorter.prototype.getSortFunction=function(o){return this.sortFunctions_[o]||this.defaultSortFunction_},goog.ui.TableSorter.prototype.setSortFunction=function(o,e){this.sortFunctions_[o]=e},goog.ui.TableSorter.prototype.sort_=function(o){var e=o.target,t=goog.dom.getAncestorByTagNameAndClass(e,goog.dom.TagName.TH),r=t==this.header_&&!this.reversed_;this.dispatchEvent(goog.ui.TableSorter.EventType.BEFORESORT)&&this.sort(t.cellIndex,r)&&this.dispatchEvent(goog.ui.TableSorter.EventType.SORT)},goog.ui.TableSorter.prototype.sort=function(o,e){var t=this.getSortFunction(o);if(t===goog.ui.TableSorter.noSort)return!1;this.header_&&goog.dom.classlist.remove(this.header_,this.reversed_?goog.getCssName("goog-tablesorter-sorted-reverse"):goog.getCssName("goog-tablesorter-sorted")),this.reversed_=!!e;var r=this.reversed_?-1:1,g=function(o,e){return r*t(o[0],e[0])||o[1]-e[1]},n=this.getElement();return goog.array.forEach(n.tBodies,function(e){var t=goog.array.map(e.rows,function(e,t){return[goog.dom.getTextContent(e.cells[o]),t,e]});goog.array.sort(t,g);var r=e.nextSibling;n.removeChild(e),goog.array.forEach(t,function(o){e.appendChild(o[2])}),n.insertBefore(e,r)}),this.header_=n.tHead.rows[this.sortableHeaderRowIndex_].cells[o],goog.dom.classlist.add(this.header_,this.reversed_?goog.getCssName("goog-tablesorter-sorted-reverse"):goog.getCssName("goog-tablesorter-sorted")),!0},goog.ui.TableSorter.noSort=goog.functions.error("no sort"),goog.ui.TableSorter.numericSort=function(o,e){return o=parseFloat(o),e=parseFloat(e),o==o?e==e?o-e:-1:e==e?1:0},goog.ui.TableSorter.alphaSort=goog.array.defaultCompare,goog.ui.TableSorter.createReverseSort=function(o){return function(e,t){return-1*o(e,t)}};