goog.provide("goog.ui.ControlRenderer"),goog.forwardDeclare("goog.ui.Control"),goog.require("goog.a11y.aria"),goog.require("goog.a11y.aria.Role"),goog.require("goog.a11y.aria.State"),goog.require("goog.array"),goog.require("goog.asserts"),goog.require("goog.dom"),goog.require("goog.dom.TagName"),goog.require("goog.dom.classlist"),goog.require("goog.object"),goog.require("goog.string"),goog.require("goog.style"),goog.require("goog.ui.Component"),goog.require("goog.ui.ControlContent"),goog.require("goog.userAgent"),goog.ui.ControlRenderer=function(){},goog.addSingletonGetter(goog.ui.ControlRenderer),goog.tagUnsealableClass(goog.ui.ControlRenderer),goog.ui.ControlRenderer.getCustomRenderer=function(o,e){var t=new o;return t.getCssClass=function(){return e},t},goog.ui.ControlRenderer.CSS_CLASS=goog.getCssName("goog-control"),goog.ui.ControlRenderer.IE6_CLASS_COMBINATIONS=[],goog.ui.ControlRenderer.ariaAttributeMap_,goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_=goog.object.create(goog.a11y.aria.Role.BUTTON,goog.a11y.aria.State.PRESSED,goog.a11y.aria.Role.CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.MENU_ITEM_CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM_RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.TAB,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.TREEITEM,goog.a11y.aria.State.SELECTED),goog.ui.ControlRenderer.prototype.getAriaRole=function(){},goog.ui.ControlRenderer.prototype.createDom=function(o){return o.getDomHelper().createDom(goog.dom.TagName.DIV,this.getClassNames(o).join(" "),o.getContent())},goog.ui.ControlRenderer.prototype.getContentElement=function(o){return o},goog.ui.ControlRenderer.prototype.enableClassName=function(o,e,t){var r=o.getElement?o.getElement():o;if(r){var a=[e];goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&(a=this.getAppliedCombinedClassNames_(goog.dom.classlist.get(r),e)).push(e),goog.dom.classlist.enableAll(r,a,t)}},goog.ui.ControlRenderer.prototype.enableExtraClassName=function(o,e,t){this.enableClassName(o,e,t)},goog.ui.ControlRenderer.prototype.canDecorate=function(o){return!0},goog.ui.ControlRenderer.prototype.decorate=function(o,e){e.id&&o.setId(e.id);var t=this.getContentElement(e);t&&t.firstChild?o.setContentInternal(t.firstChild.nextSibling?goog.array.clone(t.childNodes):t.firstChild):o.setContentInternal(null);var r=0,a=this.getCssClass(),g=this.getStructuralCssClass(),s=!1,n=!1,i=!1,l=goog.array.toArray(goog.dom.classlist.get(e));goog.array.forEach(l,function(o){s||o!=a?n||o!=g?r|=this.getStateFromClass(o):n=!0:(s=!0,g==a&&(n=!0)),this.getStateFromClass(o)==goog.ui.Component.State.DISABLED&&(goog.asserts.assertElement(t),goog.dom.isFocusableTabIndex(t)&&goog.dom.setFocusableTabIndex(t,!1))},this),o.setStateInternal(r),s||(l.push(a),g==a&&(n=!0)),n||l.push(g);var u=o.getExtraClassNames();if(u&&l.push.apply(l,u),goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")){var C=this.getAppliedCombinedClassNames_(l);C.length>0&&(l.push.apply(l,C),i=!0)}return s&&n&&!u&&!i||goog.dom.classlist.set(e,l.join(" ")),e},goog.ui.ControlRenderer.prototype.initializeDom=function(o){o.isRightToLeft()&&this.setRightToLeft(o.getElement(),!0),o.isEnabled()&&this.setFocusable(o,o.isVisible())},goog.ui.ControlRenderer.prototype.setAriaRole=function(o,e){var t=e||this.getAriaRole();if(t){if(goog.asserts.assert(o,"The element passed as a first parameter cannot be null."),t==goog.a11y.aria.getRole(o))return;goog.a11y.aria.setRole(o,t)}},goog.ui.ControlRenderer.prototype.setAriaStates=function(o,e){goog.asserts.assert(o),goog.asserts.assert(e);var t=o.getAriaLabel();null!=t&&this.setAriaLabel(e,t),o.isVisible()||goog.a11y.aria.setState(e,goog.a11y.aria.State.HIDDEN,!o.isVisible()),o.isEnabled()||this.updateAriaState(e,goog.ui.Component.State.DISABLED,!o.isEnabled()),o.isSupportedState(goog.ui.Component.State.SELECTED)&&this.updateAriaState(e,goog.ui.Component.State.SELECTED,o.isSelected()),o.isSupportedState(goog.ui.Component.State.CHECKED)&&this.updateAriaState(e,goog.ui.Component.State.CHECKED,o.isChecked()),o.isSupportedState(goog.ui.Component.State.OPENED)&&this.updateAriaState(e,goog.ui.Component.State.OPENED,o.isOpen())},goog.ui.ControlRenderer.prototype.setAriaLabel=function(o,e){goog.a11y.aria.setLabel(o,e)},goog.ui.ControlRenderer.prototype.setAllowTextSelection=function(o,e){goog.style.setUnselectable(o,!e,!goog.userAgent.IE&&!goog.userAgent.OPERA)},goog.ui.ControlRenderer.prototype.setRightToLeft=function(o,e){this.enableClassName(o,goog.getCssName(this.getStructuralCssClass(),"rtl"),e)},goog.ui.ControlRenderer.prototype.isFocusable=function(o){var e;return!(!o.isSupportedState(goog.ui.Component.State.FOCUSED)||!(e=o.getKeyEventTarget()))&&goog.dom.isFocusableTabIndex(e)},goog.ui.ControlRenderer.prototype.setFocusable=function(o,e){var t;if(o.isSupportedState(goog.ui.Component.State.FOCUSED)&&(t=o.getKeyEventTarget())){if(!e&&o.isFocused()){try{t.blur()}catch(o){}o.isFocused()&&o.handleBlur(null)}goog.dom.isFocusableTabIndex(t)!=e&&goog.dom.setFocusableTabIndex(t,e)}},goog.ui.ControlRenderer.prototype.setVisible=function(o,e){goog.style.setElementShown(o,e),o&&goog.a11y.aria.setState(o,goog.a11y.aria.State.HIDDEN,!e)},goog.ui.ControlRenderer.prototype.setState=function(o,e,t){var r=o.getElement();if(r){var a=this.getClassForState(e);a&&this.enableClassName(o,a,t),this.updateAriaState(r,e,t)}},goog.ui.ControlRenderer.prototype.updateAriaState=function(o,e,t){goog.ui.ControlRenderer.ariaAttributeMap_||(goog.ui.ControlRenderer.ariaAttributeMap_=goog.object.create(goog.ui.Component.State.DISABLED,goog.a11y.aria.State.DISABLED,goog.ui.Component.State.SELECTED,goog.a11y.aria.State.SELECTED,goog.ui.Component.State.CHECKED,goog.a11y.aria.State.CHECKED,goog.ui.Component.State.OPENED,goog.a11y.aria.State.EXPANDED)),goog.asserts.assert(o,"The element passed as a first parameter cannot be null.");var r=goog.ui.ControlRenderer.getAriaStateForAriaRole_(o,goog.ui.ControlRenderer.ariaAttributeMap_[e]);r&&goog.a11y.aria.setState(o,r,t)},goog.ui.ControlRenderer.getAriaStateForAriaRole_=function(o,e){var t=goog.a11y.aria.getRole(o);if(!t)return e;var r=goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_[t]||e;return goog.ui.ControlRenderer.isAriaState_(e)?r:e},goog.ui.ControlRenderer.isAriaState_=function(o){return o==goog.a11y.aria.State.CHECKED||o==goog.a11y.aria.State.SELECTED},goog.ui.ControlRenderer.prototype.setContent=function(o,e){var t=this.getContentElement(o);if(t&&(goog.dom.removeChildren(t),e))if("string"==typeof e)goog.dom.setTextContent(t,e);else{var r=function(o){if(o){var e=goog.dom.getOwnerDocument(t);t.appendChild("string"==typeof o?e.createTextNode(o):o)}};goog.isArray(e)?goog.array.forEach(e,r):goog.isArrayLike(e)&&!("nodeType"in e)?goog.array.forEach(goog.array.clone(e),r):r(e)}},goog.ui.ControlRenderer.prototype.getKeyEventTarget=function(o){return o.getElement()},goog.ui.ControlRenderer.prototype.getCssClass=function(){return goog.ui.ControlRenderer.CSS_CLASS},goog.ui.ControlRenderer.prototype.getIe6ClassCombinations=function(){return[]},goog.ui.ControlRenderer.prototype.getStructuralCssClass=function(){return this.getCssClass()},goog.ui.ControlRenderer.prototype.getClassNames=function(o){var e=this.getCssClass(),t=[e],r=this.getStructuralCssClass();r!=e&&t.push(r);var a=this.getClassNamesForState(o.getState());t.push.apply(t,a);var g=o.getExtraClassNames();return g&&t.push.apply(t,g),goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&t.push.apply(t,this.getAppliedCombinedClassNames_(t)),t},goog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_=function(o,e){var t=[];return e&&(o=goog.array.concat(o,[e])),goog.array.forEach(this.getIe6ClassCombinations(),function(r){!goog.array.every(r,goog.partial(goog.array.contains,o))||e&&!goog.array.contains(r,e)||t.push(r.join("_"))}),t},goog.ui.ControlRenderer.prototype.getClassNamesForState=function(o){for(var e=[];o;){var t=o&-o;e.push(this.getClassForState(t)),o&=~t}return e},goog.ui.ControlRenderer.prototype.getClassForState=function(o){return this.classByState_||this.createClassByStateMap_(),this.classByState_[o]},goog.ui.ControlRenderer.prototype.getStateFromClass=function(o){this.stateByClass_||this.createStateByClassMap_();var e=parseInt(this.stateByClass_[o],10);return isNaN(e)?0:e},goog.ui.ControlRenderer.prototype.createClassByStateMap_=function(){var o=this.getStructuralCssClass(),e=!goog.string.contains(goog.string.normalizeWhitespace(o)," ");goog.asserts.assert(e,"ControlRenderer has an invalid css class: '"+o+"'"),this.classByState_=goog.object.create(goog.ui.Component.State.DISABLED,goog.getCssName(o,"disabled"),goog.ui.Component.State.HOVER,goog.getCssName(o,"hover"),goog.ui.Component.State.ACTIVE,goog.getCssName(o,"active"),goog.ui.Component.State.SELECTED,goog.getCssName(o,"selected"),goog.ui.Component.State.CHECKED,goog.getCssName(o,"checked"),goog.ui.Component.State.FOCUSED,goog.getCssName(o,"focused"),goog.ui.Component.State.OPENED,goog.getCssName(o,"open"))},goog.ui.ControlRenderer.prototype.createStateByClassMap_=function(){this.classByState_||this.createClassByStateMap_(),this.stateByClass_=goog.object.transpose(this.classByState_)};