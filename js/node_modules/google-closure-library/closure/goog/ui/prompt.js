goog.provide("goog.ui.Prompt"),goog.require("goog.Timer"),goog.require("goog.dom"),goog.require("goog.dom.InputType"),goog.require("goog.dom.TagName"),goog.require("goog.events"),goog.require("goog.events.EventType"),goog.require("goog.functions"),goog.require("goog.html.SafeHtml"),goog.require("goog.ui.Component"),goog.require("goog.ui.Dialog"),goog.require("goog.userAgent"),goog.ui.Prompt=function(o,t,e,g,i,s,u){goog.ui.Prompt.base(this,"constructor",i,s,u),this.inputElementId_=this.makeId("ie"),this.setTitle(o);var r=goog.html.SafeHtml.create("label",{for:this.inputElementId_},goog.html.SafeHtml.htmlEscapePreservingNewlines(t)),n=goog.html.SafeHtml.BR;this.setSafeHtmlContent(goog.html.SafeHtml.concat(r,n,n)),this.callback_=e,this.defaultValue_=void 0!==g?g:"";var l=goog.getMsg("OK"),p=goog.getMsg("Cancel"),a=new goog.ui.Dialog.ButtonSet(u);a.set(goog.ui.Dialog.DefaultButtonKeys.OK,l,!0),a.set(goog.ui.Dialog.DefaultButtonKeys.CANCEL,p,!1,!0),this.setButtonSet(a)},goog.inherits(goog.ui.Prompt,goog.ui.Dialog),goog.tagUnsealableClass(goog.ui.Prompt),goog.ui.Prompt.prototype.callback_=goog.nullFunction,goog.ui.Prompt.prototype.defaultValue_="",goog.ui.Prompt.prototype.userInputEl_=null,goog.ui.Prompt.prototype.isClosing_=!1,goog.ui.Prompt.prototype.rows_=1,goog.ui.Prompt.prototype.cols_=0,goog.ui.Prompt.prototype.inputDecoratorFn_=null,goog.ui.Prompt.prototype.validationFn_=goog.functions.TRUE,goog.ui.Prompt.prototype.setValidationFunction=function(o){this.validationFn_=o},goog.ui.Prompt.prototype.enterDocument=function(){this.inputDecoratorFn_&&this.inputDecoratorFn_(this.userInputEl_),goog.ui.Prompt.superClass_.enterDocument.call(this),this.getHandler().listen(this,goog.ui.Dialog.EventType.SELECT,this.onPromptExit_),this.getHandler().listen(this.userInputEl_,[goog.events.EventType.KEYUP,goog.events.EventType.CHANGE],this.handleInputChanged_)},goog.ui.Prompt.prototype.getInputElement=function(){return this.userInputEl_},goog.ui.Prompt.prototype.setInputDecoratorFn=function(o){this.inputDecoratorFn_=o},goog.ui.Prompt.prototype.setRows=function(o){if(this.isInDocument())if(this.userInputEl_.tagName==goog.dom.TagName.INPUT){if(o>1)throw new Error(goog.ui.Component.Error.ALREADY_RENDERED)}else{if(o<=1)throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);this.userInputEl_.rows=o}this.rows_=o},goog.ui.Prompt.prototype.getRows=function(){return this.rows_},goog.ui.Prompt.prototype.setCols=function(o){this.cols_=o,this.userInputEl_&&(this.userInputEl_.tagName==goog.dom.TagName.INPUT?this.userInputEl_.size=o:this.userInputEl_.cols=o)},goog.ui.Prompt.prototype.getCols=function(){return this.cols_},goog.ui.Prompt.prototype.createDom=function(){goog.ui.Prompt.superClass_.createDom.call(this);var o=this.getClass();1==this.rows_?(this.userInputEl_=this.getDomHelper().createDom(goog.dom.TagName.INPUT,{className:goog.getCssName(o,"userInput"),value:this.defaultValue_}),this.userInputEl_.type=goog.dom.InputType.TEXT,this.cols_&&(this.userInputEl_.size=this.cols_)):(this.userInputEl_=this.getDomHelper().createDom(goog.dom.TagName.TEXTAREA,{className:goog.getCssName(o,"userInput"),value:this.defaultValue_}),this.userInputEl_.rows=this.rows_,this.cols_&&(this.userInputEl_.cols=this.cols_)),this.userInputEl_.id=this.inputElementId_,this.getContentElement().appendChild(this.getDomHelper().createDom(goog.dom.TagName.DIV,{style:"overflow: auto"},this.userInputEl_))},goog.ui.Prompt.prototype.handleInputChanged_=function(){this.updateOkButtonState_()},goog.ui.Prompt.prototype.updateOkButtonState_=function(){var o=this.validationFn_(this.userInputEl_.value);this.getButtonSet().setButtonEnabled(goog.ui.Dialog.DefaultButtonKeys.OK,o)},goog.ui.Prompt.prototype.setVisible=function(o){goog.ui.Prompt.base(this,"setVisible",o),o&&(this.isClosing_=!1,this.userInputEl_.value=this.defaultValue_,this.focus(),this.updateOkButtonState_())},goog.ui.Prompt.prototype.focus=function(){goog.ui.Prompt.base(this,"focus"),goog.userAgent.OPERA&&this.userInputEl_.focus(),this.userInputEl_.select()},goog.ui.Prompt.prototype.setDefaultValue=function(o){this.defaultValue_=o},goog.ui.Prompt.prototype.onPromptExit_=function(o){this.isClosing_||(this.isClosing_=!0,"ok"==o.key?goog.Timer.callOnce(goog.bind(this.callback_,this,this.userInputEl_.value),1):goog.Timer.callOnce(goog.bind(this.callback_,this,null),1))},goog.ui.Prompt.prototype.disposeInternal=function(){goog.dom.removeNode(this.userInputEl_),goog.events.unlisten(this,goog.ui.Dialog.EventType.SELECT,this.onPromptExit_,!0,this),goog.ui.Prompt.superClass_.disposeInternal.call(this),this.userInputEl_=null};