goog.provide("goog.ui.DrilldownRow"),goog.require("goog.asserts"),goog.require("goog.dom"),goog.require("goog.dom.TagName"),goog.require("goog.dom.classlist"),goog.require("goog.dom.safe"),goog.require("goog.html.SafeHtml"),goog.require("goog.string.Unicode"),goog.require("goog.ui.Component"),goog.ui.DrilldownRow=function(o,e){goog.ui.Component.call(this,e);var t,g=o||{};null==g.html?t=goog.html.SafeHtml.EMPTY:(goog.asserts.assert(g.html instanceof goog.html.SafeHtml),t=g.html),this.html_=t,this.expanded_=void 0===g.expanded||g.expanded,this.decoratorFn_=g.decorator||goog.ui.DrilldownRow.decorate,this.displayed_=!0},goog.inherits(goog.ui.DrilldownRow,goog.ui.Component),goog.ui.DrilldownRow.DrilldownRowProperties,goog.ui.DrilldownRow.sampleProperties={html:goog.html.SafeHtml.create(goog.dom.TagName.TR,{},goog.html.SafeHtml.concat(goog.html.SafeHtml.create(goog.dom.TagName.TD,{},"Sample"),goog.html.SafeHtml.create(goog.dom.TagName.TD,{},"Sample"))),loaded:!0,decorator:function(o,e){goog.ui.DrilldownRow.decorate(o);var t=o.getElement();e.listen(t,"mouseover",function(){goog.dom.classlist.add(t,goog.getCssName("goog-drilldown-hover"))}),e.listen(t,"mouseout",function(){goog.dom.classlist.remove(t,goog.getCssName("goog-drilldown-hover"))})}},goog.ui.DrilldownRow.prototype.enterDocument=function(){goog.ui.DrilldownRow.superClass_.enterDocument.call(this),this.decoratorFn_(this,this.getHandler())},goog.ui.DrilldownRow.prototype.createDom=function(){this.setElementInternal(goog.ui.DrilldownRow.createRowNode_(this.html_,this.getDomHelper()))},goog.ui.DrilldownRow.prototype.canDecorate=function(o){return o.tagName==goog.dom.TagName.TR},goog.ui.DrilldownRow.prototype.addChildAt=function(o,e,t){goog.asserts.assertInstanceof(o,goog.ui.DrilldownRow),goog.ui.DrilldownRow.superClass_.addChildAt.call(this,o,e,!1),o.setDisplayable_(this.isVisible_()&&this.isExpanded()),t&&!o.isInDocument()&&o.render()},goog.ui.DrilldownRow.prototype.removeChild=function(o){return goog.dom.removeNode(o.getElement()),goog.ui.DrilldownRow.superClass_.removeChild.call(this,o)},goog.ui.DrilldownRow.prototype.render=function(){if(arguments.length)throw new Error("A DrilldownRow cannot be placed under a specific parent.");var o=this.getParent();if(!o.isInDocument())throw new Error("Cannot render child of un-rendered parent");goog.asserts.assertInstanceof(o,goog.ui.DrilldownRow);var e,t=o.previousRenderedChild_(this);if(t?(goog.asserts.assertInstanceof(t,goog.ui.DrilldownRow),e=t.lastRenderedLeaf_().getElement()):e=o.getElement(),e=e.nextSibling)this.renderBefore(e);else{var g=o.getElement().parentNode;goog.ui.DrilldownRow.superClass_.render.call(this,g)}},goog.ui.DrilldownRow.prototype.findIndex=function(){var o=this.getParent();if(!o)throw new Error("Component has no parent");return o.indexOfChild(this)},goog.ui.DrilldownRow.prototype.isExpanded=function(){return this.expanded_},goog.ui.DrilldownRow.prototype.setExpanded=function(o){if(o!=this.expanded_){this.expanded_=o;var e=this.getElement();goog.asserts.assert(e),goog.dom.classlist.toggle(e,goog.getCssName("goog-drilldown-expanded")),goog.dom.classlist.toggle(e,goog.getCssName("goog-drilldown-collapsed")),this.isVisible_()&&this.forEachChild(function(e){e.setDisplayable_(o)})}},goog.ui.DrilldownRow.prototype.getDepth=function(){for(var o=this,e=0;o instanceof goog.ui.DrilldownRow;o=o.getParent(),e++);return e},goog.ui.DrilldownRow.decorate=function(o){var e=o.getDepth(),t=o.getElement();if(goog.asserts.assert(t),!t.cells)throw new Error("No cells");var g=t.cells[0],i=o.getDomHelper(),r=i.createDom(goog.dom.TagName.DIV,{style:"float: left; width: "+e+"em;"},i.createDom(goog.dom.TagName.DIV,{class:"toggle",style:"width: 1em; float: right;"},goog.string.Unicode.NBSP));g.insertBefore(r,g.firstChild),goog.dom.classlist.add(t,o.isExpanded()?goog.getCssName("goog-drilldown-expanded"):goog.getCssName("goog-drilldown-collapsed"));var n=goog.dom.getElementsByTagName(goog.dom.TagName.DIV,r)[0];o.getHandler().listen(n,"click",function(e){o.setExpanded(!o.isExpanded())})},goog.ui.DrilldownRow.prototype.setDisplayable_=function(o){if(o&&!this.isInDocument()&&this.render(),this.displayed_!=o){this.displayed_=o,this.isInDocument()&&(this.getElement().style.display=o?"":"none");var e=this;this.forEachChild(function(t){t.setDisplayable_(o&&e.expanded_)})}},goog.ui.DrilldownRow.prototype.isVisible_=function(){for(var o=this;o instanceof goog.ui.DrilldownRow;o=o.getParent())if(!o.displayed_)return!1;return!0},goog.ui.DrilldownRow.createRowNode_=function(o,e){var t=goog.html.SafeHtml.create(goog.dom.TagName.TABLE,{},o),g=e.createElement(goog.dom.TagName.DIV);return goog.dom.safe.setInnerHtml(g,t),g.firstChild.rows[0]},goog.ui.DrilldownRow.prototype.lastRenderedLeaf_=function(){for(var o=null,e=this;e&&e.isInDocument();e=e.getChildAt(e.getChildCount()-1))o=e;return o},goog.ui.DrilldownRow.prototype.previousRenderedChild_=function(o){for(var e=this.getChildCount()-1;e>=0;e--)if(this.getChildAt(e)==o)for(var t=e-1;t>=0;t--){var g=this.getChildAt(t);if(g.isInDocument())return g}return null};