goog.provide("goog.ui.LabelInput"),goog.require("goog.Timer"),goog.require("goog.a11y.aria"),goog.require("goog.a11y.aria.State"),goog.require("goog.asserts"),goog.require("goog.dom"),goog.require("goog.dom.InputType"),goog.require("goog.dom.TagName"),goog.require("goog.dom.classlist"),goog.require("goog.events.EventHandler"),goog.require("goog.events.EventType"),goog.require("goog.ui.Component"),goog.require("goog.userAgent"),goog.ui.LabelInput=function(e,t){goog.ui.Component.call(this,t),this.label_=e||""},goog.inherits(goog.ui.LabelInput,goog.ui.Component),goog.tagUnsealableClass(goog.ui.LabelInput),goog.ui.LabelInput.prototype.ffKeyRestoreValue_=null,goog.ui.LabelInput.prototype.labelRestoreDelayMs=10,goog.ui.LabelInput.prototype.inFocusAndSelect_,goog.ui.LabelInput.prototype.formAttached_,goog.ui.LabelInput.supportsPlaceholder_,goog.ui.LabelInput.isPlaceholderSupported_=function(){return null==goog.ui.LabelInput.supportsPlaceholder_&&(goog.ui.LabelInput.supportsPlaceholder_="placeholder"in goog.dom.createElement(goog.dom.TagName.INPUT)),goog.ui.LabelInput.supportsPlaceholder_},goog.ui.LabelInput.prototype.eventHandler_,goog.ui.LabelInput.prototype.hasFocus_=!1,goog.ui.LabelInput.prototype.createDom=function(){this.setElementInternal(this.getDomHelper().createDom(goog.dom.TagName.INPUT,{type:goog.dom.InputType.TEXT}))},goog.ui.LabelInput.prototype.decorateInternal=function(e){if(goog.ui.LabelInput.superClass_.decorateInternal.call(this,e),this.label_||(this.label_=e.getAttribute("label")||""),goog.dom.getActiveElement(goog.dom.getOwnerDocument(e))==e){this.hasFocus_=!0;var t=this.getElement();goog.asserts.assert(t),goog.dom.classlist.remove(t,this.labelCssClassName)}goog.ui.LabelInput.isPlaceholderSupported_()&&(this.getElement().placeholder=this.label_);var o=this.getElement();goog.asserts.assert(o,"The label input element cannot be null."),goog.a11y.aria.setState(o,goog.a11y.aria.State.LABEL,this.label_)},goog.ui.LabelInput.prototype.enterDocument=function(){goog.ui.LabelInput.superClass_.enterDocument.call(this),this.attachEvents_(),this.check_(),this.getElement().labelInput_=this},goog.ui.LabelInput.prototype.exitDocument=function(){goog.ui.LabelInput.superClass_.exitDocument.call(this),this.detachEvents_(),this.getElement().labelInput_=null},goog.ui.LabelInput.prototype.attachEvents_=function(){var e=new goog.events.EventHandler(this);if(e.listen(this.getElement(),goog.events.EventType.FOCUS,this.handleFocus_),e.listen(this.getElement(),goog.events.EventType.BLUR,this.handleBlur_),goog.ui.LabelInput.isPlaceholderSupported_())this.eventHandler_=e;else{goog.userAgent.GECKO&&e.listen(this.getElement(),[goog.events.EventType.KEYPRESS,goog.events.EventType.KEYDOWN,goog.events.EventType.KEYUP],this.handleEscapeKeys_);var t=goog.dom.getOwnerDocument(this.getElement()),o=goog.dom.getWindow(t);e.listen(o,goog.events.EventType.LOAD,this.handleWindowLoad_),this.eventHandler_=e,this.attachEventsToForm_()}},goog.ui.LabelInput.prototype.attachEventsToForm_=function(){!this.formAttached_&&this.eventHandler_&&this.getElement().form&&(this.eventHandler_.listen(this.getElement().form,goog.events.EventType.SUBMIT,this.handleFormSubmit_),this.formAttached_=!0)},goog.ui.LabelInput.prototype.detachEvents_=function(){this.eventHandler_&&(this.eventHandler_.dispose(),this.eventHandler_=null)},goog.ui.LabelInput.prototype.disposeInternal=function(){goog.ui.LabelInput.superClass_.disposeInternal.call(this),this.detachEvents_()},goog.ui.LabelInput.prototype.labelCssClassName=goog.getCssName("label-input-label"),goog.ui.LabelInput.prototype.handleFocus_=function(e){this.hasFocus_=!0;var t=this.getElement();if(goog.asserts.assert(t),goog.dom.classlist.remove(t,this.labelCssClassName),!goog.ui.LabelInput.isPlaceholderSupported_()&&!this.hasChanged()&&!this.inFocusAndSelect_){var o=this,s=function(){o.getElement()&&(o.getElement().value="")};goog.userAgent.IE?goog.Timer.callOnce(s,10):s()}},goog.ui.LabelInput.prototype.handleBlur_=function(e){goog.ui.LabelInput.isPlaceholderSupported_()||(this.eventHandler_.unlisten(this.getElement(),goog.events.EventType.CLICK,this.handleFocus_),this.ffKeyRestoreValue_=null),this.hasFocus_=!1,this.check_()},goog.ui.LabelInput.prototype.handleEscapeKeys_=function(e){27==e.keyCode&&(e.type==goog.events.EventType.KEYDOWN?this.ffKeyRestoreValue_=this.getElement().value:e.type==goog.events.EventType.KEYPRESS?this.getElement().value=this.ffKeyRestoreValue_:e.type==goog.events.EventType.KEYUP&&(this.ffKeyRestoreValue_=null),e.preventDefault())},goog.ui.LabelInput.prototype.handleFormSubmit_=function(e){this.hasChanged()||(this.getElement().value="",goog.Timer.callOnce(this.handleAfterSubmit_,10,this))},goog.ui.LabelInput.prototype.handleAfterSubmit_=function(){this.hasChanged()||(this.getElement().value=this.label_)},goog.ui.LabelInput.prototype.handleWindowLoad_=function(e){this.check_()},goog.ui.LabelInput.prototype.hasFocus=function(){return this.hasFocus_},goog.ui.LabelInput.prototype.hasChanged=function(){return!!this.getElement()&&""!=this.getElement().value&&this.getElement().value!=this.label_},goog.ui.LabelInput.prototype.clear=function(){this.getElement().value="",null!=this.ffKeyRestoreValue_&&(this.ffKeyRestoreValue_="")},goog.ui.LabelInput.prototype.reset=function(){this.hasChanged()&&(this.clear(),this.check_())},goog.ui.LabelInput.prototype.setValue=function(e){null!=this.ffKeyRestoreValue_&&(this.ffKeyRestoreValue_=e),this.getElement().value=e,this.check_()},goog.ui.LabelInput.prototype.getValue=function(){return null!=this.ffKeyRestoreValue_?this.ffKeyRestoreValue_:this.hasChanged()?this.getElement().value:""},goog.ui.LabelInput.prototype.setLabel=function(e){var t=this.getElement();goog.ui.LabelInput.isPlaceholderSupported_()?(t&&(t.placeholder=e),this.label_=e):this.hasChanged()||(t&&(t.value=""),this.label_=e,this.restoreLabel_()),t&&goog.a11y.aria.setState(t,goog.a11y.aria.State.LABEL,this.label_)},goog.ui.LabelInput.prototype.getLabel=function(){return this.label_},goog.ui.LabelInput.prototype.check_=function(){var e=this.getElement();if(goog.asserts.assert(e,"The label input element cannot be null."),goog.ui.LabelInput.isPlaceholderSupported_()?this.getElement().placeholder!=this.label_&&(this.getElement().placeholder=this.label_):this.attachEventsToForm_(),goog.a11y.aria.setState(e,goog.a11y.aria.State.LABEL,this.label_),this.hasChanged()){t=this.getElement();goog.asserts.assert(t),goog.dom.classlist.remove(t,this.labelCssClassName)}else{if(!this.inFocusAndSelect_&&!this.hasFocus_){var t=this.getElement();goog.asserts.assert(t),goog.dom.classlist.add(t,this.labelCssClassName)}goog.ui.LabelInput.isPlaceholderSupported_()||goog.Timer.callOnce(this.restoreLabel_,this.labelRestoreDelayMs,this)}},goog.ui.LabelInput.prototype.focusAndSelect=function(){var e=this.hasChanged();this.inFocusAndSelect_=!0,this.getElement().focus(),e||goog.ui.LabelInput.isPlaceholderSupported_()||(this.getElement().value=this.label_),this.getElement().select(),goog.ui.LabelInput.isPlaceholderSupported_()||(this.eventHandler_&&this.eventHandler_.listenOnce(this.getElement(),goog.events.EventType.CLICK,this.handleFocus_),goog.Timer.callOnce(this.focusAndSelect_,10,this))},goog.ui.LabelInput.prototype.setEnabled=function(e){this.getElement().disabled=!e;var t=this.getElement();goog.asserts.assert(t),goog.dom.classlist.enable(t,goog.getCssName(this.labelCssClassName,"disabled"),!e)},goog.ui.LabelInput.prototype.isEnabled=function(){return!this.getElement().disabled},goog.ui.LabelInput.prototype.focusAndSelect_=function(){this.inFocusAndSelect_=!1},goog.ui.LabelInput.prototype.restoreLabel_=function(){!this.getElement()||this.hasChanged()||this.hasFocus_||(this.getElement().value=this.label_)};