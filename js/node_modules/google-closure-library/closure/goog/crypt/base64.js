goog.provide("goog.crypt.base64"),goog.require("goog.asserts"),goog.require("goog.crypt"),goog.require("goog.string"),goog.require("goog.userAgent"),goog.require("goog.userAgent.product"),goog.crypt.base64.DEFAULT_ALPHABET_COMMON_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",goog.crypt.base64.ENCODED_VALS=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_+"+/=",goog.crypt.base64.ENCODED_VALS_WEBSAFE=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_+"-_.",goog.crypt.base64.Alphabet={DEFAULT:0,NO_PADDING:1,WEBSAFE:2,WEBSAFE_DOT_PADDING:3,WEBSAFE_NO_PADDING:4},goog.crypt.base64.paddingChars_="=.",goog.crypt.base64.isPadding_=function(o){return goog.string.contains(goog.crypt.base64.paddingChars_,o)},goog.crypt.base64.byteToCharMaps_={},goog.crypt.base64.charToByteMap_=null,goog.crypt.base64.ASSUME_NATIVE_SUPPORT_=goog.userAgent.GECKO||goog.userAgent.WEBKIT&&!goog.userAgent.product.SAFARI||goog.userAgent.OPERA,goog.crypt.base64.HAS_NATIVE_ENCODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||"function"==typeof goog.global.btoa,goog.crypt.base64.HAS_NATIVE_DECODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||!goog.userAgent.product.SAFARI&&!goog.userAgent.IE&&"function"==typeof goog.global.atob,goog.crypt.base64.encodeByteArray=function(o,g){goog.asserts.assert(goog.isArrayLike(o),"encodeByteArray takes an array as a parameter"),void 0===g&&(g=goog.crypt.base64.Alphabet.DEFAULT),goog.crypt.base64.init_();for(var r=goog.crypt.base64.byteToCharMaps_[g],e=[],t=0;t<o.length;t+=3){var a=o[t],n=t+1<o.length,s=n?o[t+1]:0,c=t+2<o.length,p=c?o[t+2]:0,y=a>>2,i=(3&a)<<4|s>>4,_=(15&s)<<2|p>>6,A=63&p;c||(A=64,n||(_=64)),e.push(r[y],r[i],r[_]||"",r[A]||"")}return e.join("")},goog.crypt.base64.encodeString=function(o,g){return goog.crypt.base64.HAS_NATIVE_ENCODE_&&!g?goog.global.btoa(o):goog.crypt.base64.encodeByteArray(goog.crypt.stringToByteArray(o),g)},goog.crypt.base64.decodeString=function(o,g){if(goog.crypt.base64.HAS_NATIVE_DECODE_&&!g)return goog.global.atob(o);var r="";return goog.crypt.base64.decodeStringInternal_(o,function(o){r+=String.fromCharCode(o)}),r},goog.crypt.base64.decodeStringToByteArray=function(o,g){var r=[];return goog.crypt.base64.decodeStringInternal_(o,function(o){r.push(o)}),r},goog.crypt.base64.decodeStringToUint8Array=function(o){goog.asserts.assert(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10"),"Browser does not support typed arrays");var g=o.length,r=3*g/4;r%3?r=Math.floor(r):goog.crypt.base64.isPadding_(o[g-1])&&(goog.crypt.base64.isPadding_(o[g-2])?r-=2:r-=1);var e=new Uint8Array(r),t=0;return goog.crypt.base64.decodeStringInternal_(o,function(o){e[t++]=o}),e.subarray(0,t)},goog.crypt.base64.decodeStringInternal_=function(o,g){goog.crypt.base64.init_();var r=0;function e(g){for(;r<o.length;){var e=o.charAt(r++),t=goog.crypt.base64.charToByteMap_[e];if(null!=t)return t;if(!goog.string.isEmptyOrWhitespace(e))throw new Error("Unknown base64 encoding at char: "+e)}return g}for(;;){var t=e(-1),a=e(0),n=e(64),s=e(64);if(64===s&&-1===t)return;if(g(t<<2|a>>4),64!=n)if(g(a<<4&240|n>>2),64!=s)g(n<<6&192|s)}},goog.crypt.base64.init_=function(){if(!goog.crypt.base64.charToByteMap_){goog.crypt.base64.charToByteMap_={};for(var o=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_.split(""),g=["+/=","+/","-_=","-_.","-_"],r=0;r<5;r++){var e=o.concat(g[r].split(""));goog.crypt.base64.byteToCharMaps_[r]=e;for(var t=0;t<e.length;t++){var a=e[t],n=goog.crypt.base64.charToByteMap_[a];void 0===n?goog.crypt.base64.charToByteMap_[a]=t:goog.asserts.assert(n===t)}}}};