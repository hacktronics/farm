goog.provide("goog.db.Cursor"),goog.require("goog.async.Deferred"),goog.require("goog.db.Error"),goog.require("goog.db.KeyRange"),goog.require("goog.debug"),goog.require("goog.events.EventTarget"),goog.db.Cursor=function(){goog.db.Cursor.base(this,"constructor")},goog.inherits(goog.db.Cursor,goog.events.EventTarget),goog.db.Cursor.prototype.cursor_=null,goog.db.Cursor.prototype.next=function(o){o?this.cursor_.continue(o):this.cursor_.continue()},goog.db.Cursor.prototype.update=function(o){var r,e="updating via cursor with value ",g=new goog.async.Deferred;try{r=this.cursor_.update(o)}catch(r){return e+=goog.debug.deepExpose(o),g.errback(goog.db.Error.fromException(r,e)),g}return r.onsuccess=function(o){g.callback()},r.onerror=function(r){e+=goog.debug.deepExpose(o),g.errback(goog.db.Error.fromRequest(r.target,e))},g},goog.db.Cursor.prototype.remove=function(){var o,r="deleting via cursor",e=new goog.async.Deferred;try{o=this.cursor_.delete()}catch(o){return e.errback(goog.db.Error.fromException(o,r)),e}return o.onsuccess=function(o){e.callback()},o.onerror=function(o){e.errback(goog.db.Error.fromRequest(o.target,r))},e},goog.db.Cursor.prototype.getValue=function(){return this.cursor_.value},goog.db.Cursor.prototype.getKey=function(){return this.cursor_.key},goog.db.Cursor.openCursor=function(o,r,e){var g,t=new goog.db.Cursor;try{var n=r?r.range():null;g=e?o.openCursor(n,e):o.openCursor(n)}catch(r){throw t.dispose(),goog.db.Error.fromException(r,o.name)}return g.onsuccess=function(o){t.cursor_=o.target.result||null,t.cursor_?t.dispatchEvent(goog.db.Cursor.EventType.NEW_DATA):t.dispatchEvent(goog.db.Cursor.EventType.COMPLETE)},g.onerror=function(o){t.dispatchEvent(goog.db.Cursor.EventType.ERROR)},t},goog.db.Cursor.Direction={NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},goog.db.Cursor.EventType={COMPLETE:"c",ERROR:"e",NEW_DATA:"n"};