goog.provide("goog.net.IpAddress"),goog.provide("goog.net.Ipv4Address"),goog.provide("goog.net.Ipv6Address"),goog.require("goog.array"),goog.require("goog.math.Integer"),goog.require("goog.object"),goog.require("goog.string"),goog.net.IpAddress=function(t,o){this.ip_=t,this.version_=o},goog.net.IpAddress.prototype.getVersion=function(){return this.version_},goog.net.IpAddress.prototype.equals=function(t){return this.version_==t.getVersion()&&this.ip_.equals(t.toInteger())},goog.net.IpAddress.prototype.toInteger=function(){return goog.object.clone(this.ip_)},goog.net.IpAddress.prototype.toUriString=goog.abstractMethod,goog.net.IpAddress.prototype.toString=goog.abstractMethod,goog.net.IpAddress.prototype.isSiteLocal=goog.abstractMethod,goog.net.IpAddress.prototype.isLinkLocal=goog.abstractMethod,goog.net.IpAddress.fromString=function(t){try{return-1!=t.indexOf(":")?new goog.net.Ipv6Address(t):new goog.net.Ipv4Address(t)}catch(t){return null}},goog.net.IpAddress.fromUriString=function(t){try{return goog.string.startsWith(t,"[")&&goog.string.endsWith(t,"]")?new goog.net.Ipv6Address(t.substring(1,t.length-1)):new goog.net.Ipv4Address(t)}catch(t){return null}},goog.net.Ipv4Address=function(t){this.ipStr_=null;var o=goog.math.Integer.ZERO;if(t instanceof goog.math.Integer){if(0!=t.getSign()||t.lessThan(goog.math.Integer.ZERO)||t.greaterThan(goog.net.Ipv4Address.MAX_ADDRESS_))throw new Error("The address does not look like an IPv4.");o=goog.object.clone(t)}else{if(!goog.net.Ipv4Address.REGEX_.test(t))throw new Error(t+" does not look like an IPv4 address.");var e=t.split(".");if(4!=e.length)throw new Error(t+" does not look like an IPv4 address.");for(var r=0;r<e.length;r++){var g=goog.string.toNumber(e[r]);if(isNaN(g)||g<0||g>255||1!=e[r].length&&goog.string.startsWith(e[r],"0"))throw new Error("In "+t+", octet "+r+" is not valid");var n=goog.math.Integer.fromNumber(g);o=o.shiftLeft(8).or(n)}}goog.net.Ipv4Address.base(this,"constructor",o,4)},goog.inherits(goog.net.Ipv4Address,goog.net.IpAddress),goog.net.Ipv4Address.REGEX_=/^[0-9.]*$/,goog.net.Ipv4Address.MAX_NETMASK_LENGTH=32,goog.net.Ipv4Address.MAX_ADDRESS_=goog.math.Integer.ONE.shiftLeft(goog.net.Ipv4Address.MAX_NETMASK_LENGTH).subtract(goog.math.Integer.ONE),goog.net.Ipv4Address.prototype.toString=function(){if(this.ipStr_)return this.ipStr_;for(var t=this.ip_.getBitsUnsigned(0),o=[],e=3;e>=0;e--)o[e]=String(255&t),t>>>=8;return this.ipStr_=o.join("."),this.ipStr_},goog.net.Ipv4Address.prototype.toUriString=function(){return this.toString()},goog.net.Ipv4Address.prototype.isSiteLocal=function(){var t=this.ip_.toInt();return 10==(t>>>24&255)||172==(t>>>24&255)&&16==(t>>>16&240)||192==(t>>>24&255)&&168==(t>>>16&255)},goog.net.Ipv4Address.prototype.isLinkLocal=function(){var t=this.ip_.toInt();return 169==(t>>>24&255)&&254==(t>>>16&255)},goog.net.Ipv6Address=function(t){this.ipStr_=null;var o=goog.math.Integer.ZERO;if(t instanceof goog.math.Integer){if(0!=t.getSign()||t.lessThan(goog.math.Integer.ZERO)||t.greaterThan(goog.net.Ipv6Address.MAX_ADDRESS_))throw new Error("The address does not look like a valid IPv6.");o=goog.object.clone(t)}else{if(!goog.net.Ipv6Address.REGEX_.test(t))throw new Error(t+" is not a valid IPv6 address.");var e=t.split(":");if(-1!=e[e.length-1].indexOf(".")){var r=goog.net.Ipv6Address.dottedQuadtoHextets_(e[e.length-1]);goog.array.removeAt(e,e.length-1),goog.array.extend(e,r),t=e.join(":")}var g,n=t.split("::");if(n.length>2||1==n.length&&8!=e.length)throw new Error(t+" is not a valid IPv6 address.");if(8!=(g=n.length>1?goog.net.Ipv6Address.explode_(n):e).length)throw new Error(t+" is not a valid IPv6 address");for(var s=0;s<g.length;s++){var i=goog.math.Integer.fromString(g[s],16);if(i.lessThan(goog.math.Integer.ZERO)||i.greaterThan(goog.net.Ipv6Address.MAX_HEXTET_VALUE_))throw new Error(g[s]+" in "+t+" is not a valid hextet.");o=o.shiftLeft(16).or(i)}}goog.net.Ipv6Address.base(this,"constructor",o,6)},goog.inherits(goog.net.Ipv6Address,goog.net.IpAddress),goog.net.Ipv6Address.REGEX_=/^([a-fA-F0-9]*:){2}[a-fA-F0-9:.]*$/,goog.net.Ipv6Address.MAX_NETMASK_LENGTH=128,goog.net.Ipv6Address.MAX_HEXTET_VALUE_=goog.math.Integer.fromInt(65535),goog.net.Ipv6Address.MAX_ADDRESS_=goog.math.Integer.ONE.shiftLeft(goog.net.Ipv6Address.MAX_NETMASK_LENGTH).subtract(goog.math.Integer.ONE),goog.net.Ipv6Address.prototype.toString=function(){if(this.ipStr_)return this.ipStr_;for(var t=[],o=3;o>=0;o--){var e=this.ip_.getBitsUnsigned(o),r=e>>>16,g=65535&e;t.push(r.toString(16)),t.push(g.toString(16))}return t=goog.net.Ipv6Address.compress_(t),this.ipStr_=t.join(":"),this.ipStr_},goog.net.Ipv6Address.prototype.toUriString=function(){return"["+this.toString()+"]"},goog.net.Ipv6Address.prototype.isSiteLocal=function(){return 64768==(65280&this.ip_.getBitsUnsigned(3)>>>16)},goog.net.Ipv6Address.prototype.isLinkLocal=function(){return 65152==(65472&this.ip_.getBitsUnsigned(3)>>>16)},goog.net.Ipv6Address.explode_=function(t){var o=t[0].split(":"),e=t[1].split(":");1==o.length&&""==o[0]&&(o=[]),1==e.length&&""==e[0]&&(e=[]);var r=8-(o.length+e.length);return r<1?[]:goog.array.join(o,goog.array.repeat("0",r),e)},goog.net.Ipv6Address.compress_=function(t){for(var o=-1,e=-1,r=0,g=0,n=0;n<t.length;n++)"0"==t[n]?(-1==e&&(e=n),++g>r&&(r=g,o=e)):(e=-1,g=0);return r>0&&(o+r==t.length&&t.push(""),t.splice(o,r,""),0==o&&(t=[""].concat(t))),t},goog.net.Ipv6Address.dottedQuadtoHextets_=function(t){var o=new goog.net.Ipv4Address(t).toInteger().getBitsUnsigned(0),e=[];return e.push((o>>>16&65535).toString(16)),e.push((65535&o).toString(16)),e},goog.net.Ipv6Address.prototype.isMappedIpv4Address=function(){return 0==this.ip_.getBitsUnsigned(3)&&0==this.ip_.getBitsUnsigned(2)&&65535==this.ip_.getBitsUnsigned(1)},goog.net.Ipv6Address.prototype.getMappedIpv4Address=function(){if(!this.isMappedIpv4Address())return null;var t=new goog.math.Integer([this.ip_.getBitsUnsigned(0)],0);return new goog.net.Ipv4Address(t)};