goog.provide("goog.labs.events.NonDisposableEventTarget"),goog.require("goog.array"),goog.require("goog.asserts"),goog.require("goog.events.Event"),goog.require("goog.events.Listenable"),goog.require("goog.events.ListenerMap"),goog.require("goog.object"),goog.labs.events.NonDisposableEventTarget=function(){this.eventTargetListeners_=new goog.events.ListenerMap(this)},goog.events.Listenable.addImplementation(goog.labs.events.NonDisposableEventTarget),goog.labs.events.NonDisposableEventTarget.MAX_ANCESTORS_=1e3,goog.labs.events.NonDisposableEventTarget.prototype.parentEventTarget_=null,goog.labs.events.NonDisposableEventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_},goog.labs.events.NonDisposableEventTarget.prototype.setParentEventTarget=function(e){this.parentEventTarget_=e},goog.labs.events.NonDisposableEventTarget.prototype.dispatchEvent=function(e){this.assertInitialized_();var t,n=this.getParentEventTarget();if(n){t=[];for(var o=1;n;n=n.getParentEventTarget())t.push(n),goog.asserts.assert(++o<goog.labs.events.NonDisposableEventTarget.MAX_ANCESTORS_,"infinite loop")}return goog.labs.events.NonDisposableEventTarget.dispatchEventInternal_(this,e,t)},goog.labs.events.NonDisposableEventTarget.prototype.listen=function(e,t,n,o){return this.assertInitialized_(),this.eventTargetListeners_.add(String(e),t,!1,n,o)},goog.labs.events.NonDisposableEventTarget.prototype.listenOnce=function(e,t,n,o){return this.eventTargetListeners_.add(String(e),t,!0,n,o)},goog.labs.events.NonDisposableEventTarget.prototype.unlisten=function(e,t,n,o){return this.eventTargetListeners_.remove(String(e),t,n,o)},goog.labs.events.NonDisposableEventTarget.prototype.unlistenByKey=function(e){return this.eventTargetListeners_.removeByKey(e)},goog.labs.events.NonDisposableEventTarget.prototype.removeAllListeners=function(e){return this.eventTargetListeners_.removeAll(e)},goog.labs.events.NonDisposableEventTarget.prototype.fireListeners=function(e,t,n){var o=this.eventTargetListeners_.listeners[String(e)];if(!o)return!0;o=goog.array.clone(o);for(var s=!0,r=0;r<o.length;++r){var g=o[r];if(g&&!g.removed&&g.capture==t){var a=g.listener,i=g.handler||g.src;g.callOnce&&this.unlistenByKey(g),s=!1!==a.call(i,n)&&s}}return s&&0!=n.returnValue_},goog.labs.events.NonDisposableEventTarget.prototype.getListeners=function(e,t){return this.eventTargetListeners_.getListeners(String(e),t)},goog.labs.events.NonDisposableEventTarget.prototype.getListener=function(e,t,n,o){return this.eventTargetListeners_.getListener(String(e),t,n,o)},goog.labs.events.NonDisposableEventTarget.prototype.hasListener=function(e,t){var n=void 0!==e?String(e):void 0;return this.eventTargetListeners_.hasListener(n,t)},goog.labs.events.NonDisposableEventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.labs.events.NonDisposableEventTarget) constructor?")},goog.labs.events.NonDisposableEventTarget.dispatchEventInternal_=function(e,t,n){var o=t.type||t;if("string"==typeof t)t=new goog.events.Event(t,e);else if(t instanceof goog.events.Event)t.target=t.target||e;else{var s=t;t=new goog.events.Event(o,e),goog.object.extend(t,s)}var r,g=!0;if(n)for(var a=n.length-1;!t.propagationStopped_&&a>=0;a--)g=(r=t.currentTarget=n[a]).fireListeners(o,!0,t)&&g;if(t.propagationStopped_||(g=(r=t.currentTarget=e).fireListeners(o,!0,t)&&g,t.propagationStopped_||(g=r.fireListeners(o,!1,t)&&g)),n)for(a=0;!t.propagationStopped_&&a<n.length;a++)g=(r=t.currentTarget=n[a]).fireListeners(o,!1,t)&&g;return g};