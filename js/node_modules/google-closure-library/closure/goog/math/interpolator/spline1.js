goog.provide("goog.math.interpolator.Spline1"),goog.require("goog.array"),goog.require("goog.asserts"),goog.require("goog.math"),goog.require("goog.math.interpolator.Interpolator1"),goog.require("goog.math.tdma"),goog.math.interpolator.Spline1=function(){this.x_=[],this.coeffs_=[[0,0,0,Number.NaN]]},goog.math.interpolator.Spline1.prototype.setData=function(o,t){goog.asserts.assert(o.length==t.length,"input arrays to setData should have the same length"),o.length>0?(this.coeffs_=this.computeSplineCoeffs_(o,t),this.x_=o.slice()):(this.coeffs_=[[0,0,0,Number.NaN]],this.x_=[])},goog.math.interpolator.Spline1.prototype.interpolate=function(o){var t=goog.array.binarySearch(this.x_,o);t<0&&(t=-t-2),t=goog.math.clamp(t,0,this.coeffs_.length-1);var e=o-this.x_[t],r=e*e,a=r*e,i=this.coeffs_[t];return i[0]*a+i[1]*r+i[2]*e+i[3]},goog.math.interpolator.Spline1.prototype.computeSplineCoeffs_=function(o,t){for(var e=o.length-1,r=new Array(e),a=new Array(e),i=0;i<e;++i)r[i]=o[i+1]-o[i],a[i]=(t[i+1]-t[i])/r[i];var n=[];if(0==e)n[0]=[0,0,0,t[0]];else if(1==e)n[0]=[0,0,a[0],t[0]];else if(2==e){var g=0,s=(a[1]-a[0])/(r[0]+r[1]),h=a[0]-s*r[0],p=t[0];n[0]=[g,s,h,p]}else{var l=this.computeDerivatives(r,a);for(i=0;i<e;++i){g=(l[i]-2*a[i]+l[i+1])/(r[i]*r[i]),s=(3*a[i]-2*l[i]-l[i+1])/r[i],h=l[i],p=t[i];n[i]=[g,s,h,p]}}return n},goog.math.interpolator.Spline1.prototype.computeDerivatives=function(o,t){var e=o.length,r=new Array(e+1);r[0]=o[1];for(var a=1;a<e;++a)r[a]=2*(o[a]+o[a-1]);r[e]=o[e-2];var i=new Array(e);for(a=0;a<e;++a)i[a]=o[a+1];i[e-1]=o[e-2]+o[e-1];var n=new Array(e);n[0]=o[0]+o[1];for(a=1;a<e;++a)n[a]=o[a-1];var g=new Array(e+1);g[0]=((o[0]+2*n[0])*o[1]*t[0]+o[0]*o[0]*t[1])/n[0];for(a=1;a<e;++a)g[a]=3*(o[a]*t[a-1]+o[a-1]*t[a]);return g[e]=(o[e-1]*o[e-1]*t[e-2]+(2*i[e-1]+o[e-1])*o[e-2]*t[e-1])/i[e-1],goog.math.tdma.solve(i,r,n,g)},goog.math.interpolator.Spline1.prototype.getInverse=function(){for(var o=new goog.math.interpolator.Spline1,t=[],e=0;e<this.x_.length;e++)t[e]=this.interpolate(this.x_[e]);return o.setData(t,this.x_),o};