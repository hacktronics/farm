goog.provide("goog.math.Path"),goog.provide("goog.math.Path.Segment"),goog.require("goog.array"),goog.require("goog.math"),goog.require("goog.math.AffineTransform"),goog.math.Path=function(){this.segments_=[],this.count_=[],this.arguments_=[],this.closePoint_=null,this.currentPoint_=null,this.simple_=!0},goog.math.Path.Segment={MOVETO:0,LINETO:1,CURVETO:2,ARCTO:3,CLOSE:4},goog.math.Path.segmentArgCounts_=function(){var t=[];return t[goog.math.Path.Segment.MOVETO]=2,t[goog.math.Path.Segment.LINETO]=2,t[goog.math.Path.Segment.CURVETO]=6,t[goog.math.Path.Segment.ARCTO]=6,t[goog.math.Path.Segment.CLOSE]=0,t}(),goog.math.Path.prototype.getSegmentTypes=function(){return this.segments_.concat()},goog.math.Path.prototype.getSegmentCounts=function(){return this.count_.concat()},goog.math.Path.prototype.getSegmentArgs=function(){return this.arguments_.concat()},goog.math.Path.getSegmentCount=function(t){return goog.math.Path.segmentArgCounts_[t]},goog.math.Path.prototype.appendPath=function(t){return t.currentPoint_&&(Array.prototype.push.apply(this.segments_,t.segments_),Array.prototype.push.apply(this.count_,t.count_),Array.prototype.push.apply(this.arguments_,t.arguments_),this.currentPoint_=t.currentPoint_.concat(),this.closePoint_=t.closePoint_.concat(),this.simple_=this.simple_&&t.simple_),this},goog.math.Path.prototype.clear=function(){return this.segments_.length=0,this.count_.length=0,this.arguments_.length=0,this.closePoint_=null,this.currentPoint_=null,this.simple_=!0,this},goog.math.Path.prototype.moveTo=function(t,o){return goog.array.peek(this.segments_)==goog.math.Path.Segment.MOVETO?this.arguments_.length-=2:(this.segments_.push(goog.math.Path.Segment.MOVETO),this.count_.push(1)),this.arguments_.push(t,o),this.currentPoint_=this.closePoint_=[t,o],this},goog.math.Path.prototype.lineTo=function(t){return this.lineTo_(arguments)},goog.math.Path.prototype.lineToFromArray=function(t){return this.lineTo_(t)},goog.math.Path.prototype.lineTo_=function(t){var o=goog.array.peek(this.segments_);if(null==o)throw new Error("Path cannot start with lineTo");o!=goog.math.Path.Segment.LINETO&&(this.segments_.push(goog.math.Path.Segment.LINETO),this.count_.push(0));for(var e=0;e<t.length;e+=2){var n=t[e],h=t[e+1];this.arguments_.push(n,h)}return this.count_[this.count_.length-1]+=e/2,this.currentPoint_=[n,h],this},goog.math.Path.prototype.curveTo=function(t){return this.curveTo_(arguments)},goog.math.Path.prototype.curveToFromArray=function(t){return this.curveTo_(t)},goog.math.Path.prototype.curveTo_=function(t){var o=goog.array.peek(this.segments_);if(null==o)throw new Error("Path cannot start with curve");o!=goog.math.Path.Segment.CURVETO&&(this.segments_.push(goog.math.Path.Segment.CURVETO),this.count_.push(0));for(var e=0;e<t.length;e+=6){var n=t[e+4],h=t[e+5];this.arguments_.push(t[e],t[e+1],t[e+2],t[e+3],n,h)}return this.count_[this.count_.length-1]+=e/6,this.currentPoint_=[n,h],this},goog.math.Path.prototype.close=function(){var t=goog.array.peek(this.segments_);if(null==t)throw new Error("Path cannot start with close");return t!=goog.math.Path.Segment.CLOSE&&(this.segments_.push(goog.math.Path.Segment.CLOSE),this.count_.push(1),this.currentPoint_=this.closePoint_),this},goog.math.Path.prototype.arc=function(t,o,e,n,h,r,g){var a=t+goog.math.angleDx(h,e),s=o+goog.math.angleDy(h,n);return g?this.currentPoint_&&a==this.currentPoint_[0]&&s==this.currentPoint_[1]||this.lineTo(a,s):this.moveTo(a,s),this.arcTo(e,n,h,r)},goog.math.Path.prototype.arcTo=function(t,o,e,n){var h=this.currentPoint_[0]-goog.math.angleDx(e,t),r=this.currentPoint_[1]-goog.math.angleDy(e,o),g=h+goog.math.angleDx(e+n,t),a=r+goog.math.angleDy(e+n,o);return this.segments_.push(goog.math.Path.Segment.ARCTO),this.count_.push(1),this.arguments_.push(t,o,e,n,g,a),this.simple_=!1,this.currentPoint_=[g,a],this},goog.math.Path.prototype.arcToAsCurves=function(t,o,e,n){for(var h=this.currentPoint_[0]-goog.math.angleDx(e,t),r=this.currentPoint_[1]-goog.math.angleDy(e,o),g=goog.math.toRadians(n),a=Math.ceil(Math.abs(g)/Math.PI*2),s=g/a,i=goog.math.toRadians(e),m=0;m<a;m++){var u=Math.cos(i),c=Math.sin(i),p=4/3*Math.sin(s/2)/(1+Math.cos(s/2)),_=h+(u-p*c)*t,P=r+(c+p*u)*o;i+=s,u=Math.cos(i),c=Math.sin(i),this.curveTo(_,P,h+(u+p*c)*t,r+(c-p*u)*o,h+u*t,r+c*o)}return this},goog.math.Path.prototype.forEachSegment=function(t){for(var o=this.arguments_,e=0,n=0,h=this.segments_.length;n<h;n++){var r=this.segments_[n],g=goog.math.Path.segmentArgCounts_[r]*this.count_[n];t(r,o.slice(e,e+g)),e+=g}},goog.math.Path.prototype.getCurrentPoint=function(){return this.currentPoint_&&this.currentPoint_.concat()},goog.math.Path.prototype.clone=function(){var t=new goog.math.Path;return t.segments_=this.segments_.concat(),t.count_=this.count_.concat(),t.arguments_=this.arguments_.concat(),t.closePoint_=this.closePoint_&&this.closePoint_.concat(),t.currentPoint_=this.currentPoint_&&this.currentPoint_.concat(),t.simple_=this.simple_,t},goog.math.Path.prototype.isSimple=function(){return this.simple_},goog.math.Path.simplifySegmentMap_=function(){var t={};return t[goog.math.Path.Segment.MOVETO]=goog.math.Path.prototype.moveTo,t[goog.math.Path.Segment.LINETO]=goog.math.Path.prototype.lineTo,t[goog.math.Path.Segment.CLOSE]=goog.math.Path.prototype.close,t[goog.math.Path.Segment.CURVETO]=goog.math.Path.prototype.curveTo,t[goog.math.Path.Segment.ARCTO]=goog.math.Path.prototype.arcToAsCurves,t}(),goog.math.Path.createSimplifiedPath=function(t){if(t.isSimple())return t.clone();var o=new goog.math.Path;return t.forEachSegment(function(t,e){goog.math.Path.simplifySegmentMap_[t].apply(o,e)}),o},goog.math.Path.prototype.createTransformedPath=function(t){var o=goog.math.Path.createSimplifiedPath(this);return o.transform(t),o},goog.math.Path.prototype.transform=function(t){if(!this.isSimple())throw new Error("Non-simple path");return t.transform(this.arguments_,0,this.arguments_,0,this.arguments_.length/2),this.closePoint_&&t.transform(this.closePoint_,0,this.closePoint_,0,1),this.currentPoint_&&this.closePoint_!=this.currentPoint_&&t.transform(this.currentPoint_,0,this.currentPoint_,0,1),this},goog.math.Path.prototype.isEmpty=function(){return 0==this.segments_.length};