goog.provide("goog.dom.TextRangeIterator"),goog.require("goog.array"),goog.require("goog.dom"),goog.require("goog.dom.NodeType"),goog.require("goog.dom.RangeIterator"),goog.require("goog.dom.TagName"),goog.require("goog.iter.StopIteration"),goog.dom.TextRangeIterator=function(t,e,o,s,r){var g;if(this.startNode_=null,this.endNode_=null,this.startOffset_=0,this.endOffset_=0,this.isReversed_=!!r,t){if(this.startNode_=t,this.startOffset_=e,this.endNode_=o,this.endOffset_=s,t.nodeType==goog.dom.NodeType.ELEMENT&&t.tagName!=goog.dom.TagName.BR){var i=t.childNodes,d=i[e];d?(this.startNode_=d,this.startOffset_=0):(i.length&&(this.startNode_=goog.array.peek(i)),g=!0)}o.nodeType==goog.dom.NodeType.ELEMENT&&(this.endNode_=o.childNodes[s],this.endNode_?this.endOffset_=0:this.endNode_=o)}if(goog.dom.TextRangeIterator.base(this,"constructor",this.isReversed_?this.endNode_:this.startNode_,this.isReversed_),g)try{this.next()}catch(t){if(t!=goog.iter.StopIteration)throw t}},goog.inherits(goog.dom.TextRangeIterator,goog.dom.RangeIterator),goog.dom.TextRangeIterator.prototype.getStartTextOffset=function(){return this.node.nodeType!=goog.dom.NodeType.TEXT?-1:this.node==this.startNode_?this.startOffset_:0},goog.dom.TextRangeIterator.prototype.getEndTextOffset=function(){return this.node.nodeType!=goog.dom.NodeType.TEXT?-1:this.node==this.endNode_?this.endOffset_:this.node.nodeValue.length},goog.dom.TextRangeIterator.prototype.getStartNode=function(){return this.startNode_},goog.dom.TextRangeIterator.prototype.setStartNode=function(t){this.isStarted()||this.setPosition(t),this.startNode_=t,this.startOffset_=0},goog.dom.TextRangeIterator.prototype.getEndNode=function(){return this.endNode_},goog.dom.TextRangeIterator.prototype.setEndNode=function(t){this.endNode_=t,this.endOffset_=0},goog.dom.TextRangeIterator.prototype.isLast=function(){return this.isStarted()&&this.isLastTag_()},goog.dom.TextRangeIterator.prototype.isLastTag_=function(){return this.node==this.lastNode_()&&(this.isReversed_?this.startOffset_?!this.isEndTag():this.isStartTag():!this.endOffset_||!this.isStartTag())},goog.dom.TextRangeIterator.prototype.next=function(){if(this.isLast())throw goog.iter.StopIteration;return goog.dom.TextRangeIterator.superClass_.next.call(this)},goog.dom.TextRangeIterator.prototype.lastNode_=function(){return this.isReversed_?this.startNode_:this.endNode_},goog.dom.TextRangeIterator.prototype.skipTag=function(){if(goog.dom.TextRangeIterator.superClass_.skipTag.apply(this),goog.dom.contains(this.node,this.lastNode_()))throw goog.iter.StopIteration},goog.dom.TextRangeIterator.prototype.copyFrom=function(t){this.startNode_=t.startNode_,this.endNode_=t.endNode_,this.startOffset_=t.startOffset_,this.endOffset_=t.endOffset_,this.isReversed_=t.isReversed_,goog.dom.TextRangeIterator.superClass_.copyFrom.call(this,t)},goog.dom.TextRangeIterator.prototype.clone=function(){var t=new goog.dom.TextRangeIterator(this.startNode_,this.startOffset_,this.endNode_,this.endOffset_,this.isReversed_);return t.copyFrom(this),t};