goog.provide("goog.dom.xml"),goog.require("goog.dom"),goog.require("goog.dom.NodeType"),goog.require("goog.dom.safe"),goog.require("goog.html.legacyconversions"),goog.require("goog.userAgent"),goog.dom.xml.MAX_XML_SIZE_KB=2048,goog.dom.xml.MAX_ELEMENT_DEPTH=256,goog.dom.xml.hasActiveXObjectSupport_=function(){if(!goog.userAgent.IE)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(e){return!1}},goog.dom.xml.ACTIVEX_SUPPORT=goog.userAgent.IE&&goog.dom.xml.hasActiveXObjectSupport_(),goog.dom.xml.createDocument=function(e,o,t){if(o&&!e)throw new Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument&&(!goog.dom.xml.ACTIVEX_SUPPORT||!t))return document.implementation.createDocument(o||"",e||"",null);if(goog.dom.xml.ACTIVEX_SUPPORT){var r=goog.dom.xml.createMsXmlDocument_();if(r)return e&&r.appendChild(r.createNode(goog.dom.NodeType.ELEMENT,e,o||"")),r}throw new Error("Your browser does not support creating new documents")},goog.dom.xml.loadXml=function(e,o){if(!("undefined"==typeof DOMParser||goog.dom.xml.ACTIVEX_SUPPORT&&o))return goog.dom.safe.parseFromString(new DOMParser,goog.html.legacyconversions.safeHtmlFromString(e),"application/xml");if(goog.dom.xml.ACTIVEX_SUPPORT){var t=goog.dom.xml.createMsXmlDocument_();return t.loadXML(e),t}throw new Error("Your browser does not support loading xml documents")},goog.dom.xml.serialize=function(e){var o=e.xml;if(o)return o;if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(e);throw new Error("Your browser does not support serializing XML documents")},goog.dom.xml.selectSingleNode=function(e,o){if(void 0!==e.selectSingleNode)return void 0!==(t=goog.dom.getOwnerDocument(e)).setProperty&&t.setProperty("SelectionLanguage","XPath"),e.selectSingleNode(o);if(document.implementation.hasFeature("XPath","3.0")){var t,r=(t=goog.dom.getOwnerDocument(e)).createNSResolver(t.documentElement);return t.evaluate(o,e,r,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}return null},goog.dom.xml.selectNodes=function(e,o){if(void 0!==e.selectNodes)return void 0!==(t=goog.dom.getOwnerDocument(e)).setProperty&&t.setProperty("SelectionLanguage","XPath"),e.selectNodes(o);if(document.implementation.hasFeature("XPath","3.0")){for(var t,r=(t=goog.dom.getOwnerDocument(e)).createNSResolver(t.documentElement),n=t.evaluate(o,e,r,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),g=[],m=n.snapshotLength,i=0;i<m;i++)g.push(n.snapshotItem(i));return g}return[]},goog.dom.xml.setAttributes=function(e,o){for(var t in o)o.hasOwnProperty(t)&&e.setAttribute(t,o[t])},goog.dom.xml.createMsXmlDocument_=function(){var e=new ActiveXObject("MSXML2.DOMDocument");if(e){e.resolveExternals=!1,e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",goog.dom.xml.MAX_XML_SIZE_KB),e.setProperty("MaxElementDepth",goog.dom.xml.MAX_ELEMENT_DEPTH)}catch(e){}}return e};