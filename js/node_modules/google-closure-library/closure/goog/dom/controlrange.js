goog.provide("goog.dom.ControlRange"),goog.provide("goog.dom.ControlRangeIterator"),goog.require("goog.array"),goog.require("goog.dom"),goog.require("goog.dom.AbstractMultiRange"),goog.require("goog.dom.AbstractRange"),goog.require("goog.dom.RangeIterator"),goog.require("goog.dom.RangeType"),goog.require("goog.dom.SavedRange"),goog.require("goog.dom.TagWalkType"),goog.require("goog.dom.TextRange"),goog.require("goog.iter.StopIteration"),goog.require("goog.userAgent"),goog.dom.ControlRange=function(){this.range_=null,this.elements_=null,this.sortedElements_=null},goog.inherits(goog.dom.ControlRange,goog.dom.AbstractMultiRange),goog.dom.ControlRange.createFromBrowserRange=function(o){var t=new goog.dom.ControlRange;return t.range_=o,t},goog.dom.ControlRange.createFromElements=function(o){for(var t=goog.dom.getOwnerDocument(arguments[0]).body.createControlRange(),e=0,n=arguments.length;e<n;e++)t.addElement(arguments[e]);return goog.dom.ControlRange.createFromBrowserRange(t)},goog.dom.ControlRange.prototype.clearCachedValues_=function(){this.elements_=null,this.sortedElements_=null},goog.dom.ControlRange.prototype.clone=function(){return goog.dom.ControlRange.createFromElements.apply(this,this.getElements())},goog.dom.ControlRange.prototype.getType=function(){return goog.dom.RangeType.CONTROL},goog.dom.ControlRange.prototype.getBrowserRangeObject=function(){return this.range_||document.body.createControlRange()},goog.dom.ControlRange.prototype.setBrowserRangeObject=function(o){return!!goog.dom.AbstractRange.isNativeControlRange(o)&&(this.range_=o,!0)},goog.dom.ControlRange.prototype.getTextRangeCount=function(){return this.range_?this.range_.length:0},goog.dom.ControlRange.prototype.getTextRange=function(o){return goog.dom.TextRange.createFromNodeContents(this.range_.item(o))},goog.dom.ControlRange.prototype.getContainer=function(){return goog.dom.findCommonAncestor.apply(null,this.getElements())},goog.dom.ControlRange.prototype.getStartNode=function(){return this.getSortedElements()[0]},goog.dom.ControlRange.prototype.getStartOffset=function(){return 0},goog.dom.ControlRange.prototype.getEndNode=function(){var o=this.getSortedElements(),t=goog.array.peek(o);return goog.array.find(o,function(o){return goog.dom.contains(o,t)})},goog.dom.ControlRange.prototype.getEndOffset=function(){return this.getEndNode().childNodes.length},goog.dom.ControlRange.prototype.getElements=function(){if(!this.elements_&&(this.elements_=[],this.range_))for(var o=0;o<this.range_.length;o++)this.elements_.push(this.range_.item(o));return this.elements_},goog.dom.ControlRange.prototype.getSortedElements=function(){return this.sortedElements_||(this.sortedElements_=this.getElements().concat(),this.sortedElements_.sort(function(o,t){return o.sourceIndex-t.sourceIndex})),this.sortedElements_},goog.dom.ControlRange.prototype.isRangeInDocument=function(){var o=!1;try{o=goog.array.every(this.getElements(),function(o){return goog.userAgent.IE?!!o.parentNode:goog.dom.contains(o.ownerDocument.body,o)})}catch(o){}return o},goog.dom.ControlRange.prototype.isCollapsed=function(){return!this.range_||!this.range_.length},goog.dom.ControlRange.prototype.getText=function(){return""},goog.dom.ControlRange.prototype.getHtmlFragment=function(){return goog.array.map(this.getSortedElements(),goog.dom.getOuterHtml).join("")},goog.dom.ControlRange.prototype.getValidHtml=function(){return this.getHtmlFragment()},goog.dom.ControlRange.prototype.getPastableHtml=goog.dom.ControlRange.prototype.getValidHtml,goog.dom.ControlRange.prototype.__iterator__=function(o){return new goog.dom.ControlRangeIterator(this)},goog.dom.ControlRange.prototype.select=function(){this.range_&&this.range_.select()},goog.dom.ControlRange.prototype.removeContents=function(){if(this.range_){for(var o=[],t=0,e=this.range_.length;t<e;t++)o.push(this.range_.item(t));goog.array.forEach(o,goog.dom.removeNode),this.collapse(!1)}},goog.dom.ControlRange.prototype.replaceContentsWithNode=function(o){var t=this.insertNode(o,!0);return this.isCollapsed()||this.removeContents(),t},goog.dom.ControlRange.prototype.saveUsingDom=function(){return new goog.dom.DomSavedControlRange_(this)},goog.dom.ControlRange.prototype.collapse=function(o){this.range_=null,this.clearCachedValues_()},goog.dom.DomSavedControlRange_=function(o){this.elements_=o.getElements()},goog.inherits(goog.dom.DomSavedControlRange_,goog.dom.SavedRange),goog.dom.DomSavedControlRange_.prototype.restoreInternal=function(){for(var o=(this.elements_.length?goog.dom.getOwnerDocument(this.elements_[0]):document).body.createControlRange(),t=0,e=this.elements_.length;t<e;t++)o.addElement(this.elements_[t]);return goog.dom.ControlRange.createFromBrowserRange(o)},goog.dom.DomSavedControlRange_.prototype.disposeInternal=function(){goog.dom.DomSavedControlRange_.superClass_.disposeInternal.call(this),delete this.elements_},goog.dom.ControlRangeIterator=function(o){this.startNode_=null,this.endNode_=null,this.elements_=null,o&&(this.elements_=o.getSortedElements(),this.startNode_=this.elements_.shift(),this.endNode_=goog.array.peek(this.elements_)||this.startNode_),goog.dom.ControlRangeIterator.base(this,"constructor",this.startNode_,!1)},goog.inherits(goog.dom.ControlRangeIterator,goog.dom.RangeIterator),goog.dom.ControlRangeIterator.prototype.getStartTextOffset=function(){return 0},goog.dom.ControlRangeIterator.prototype.getEndTextOffset=function(){return 0},goog.dom.ControlRangeIterator.prototype.getStartNode=function(){return this.startNode_},goog.dom.ControlRangeIterator.prototype.getEndNode=function(){return this.endNode_},goog.dom.ControlRangeIterator.prototype.isLast=function(){return!this.depth&&!this.elements_.length},goog.dom.ControlRangeIterator.prototype.next=function(){if(this.isLast())throw goog.iter.StopIteration;if(!this.depth){var o=this.elements_.shift();return this.setPosition(o,goog.dom.TagWalkType.START_TAG,goog.dom.TagWalkType.START_TAG),o}return goog.dom.ControlRangeIterator.superClass_.next.call(this)},goog.dom.ControlRangeIterator.prototype.copyFrom=function(o){var t=o;this.elements_=t.elements_,this.startNode_=t.startNode_,this.endNode_=t.endNode_,goog.dom.ControlRangeIterator.superClass_.copyFrom.call(this,t)},goog.dom.ControlRangeIterator.prototype.clone=function(){var o=new goog.dom.ControlRangeIterator(null);return o.copyFrom(this),o};