goog.provide("goog.proto2.ObjectSerializer"),goog.require("goog.asserts"),goog.require("goog.proto2.FieldDescriptor"),goog.require("goog.proto2.Serializer"),goog.require("goog.string"),goog.proto2.ObjectSerializer=function(e,o,r){this.keyOption_=e,this.serializeBooleanAsNumber_=o,this.ignoreUnknownFields_=r},goog.inherits(goog.proto2.ObjectSerializer,goog.proto2.Serializer),goog.proto2.ObjectSerializer.KeyOption={TAG:0,NAME:1,CAMEL_CASE_NAME:2},goog.proto2.ObjectSerializer.prototype.serialize=function(e){for(var o=e.getDescriptor().getFields(),r={},i=0;i<o.length;i++){var t=o[i],g=t.getTag();switch(this.keyOption_){case goog.proto2.ObjectSerializer.KeyOption.TAG:break;case goog.proto2.ObjectSerializer.KeyOption.NAME:g=t.getName();break;case goog.proto2.ObjectSerializer.KeyOption.CAMEL_CASE_NAME:g=goog.string.toCamelCase(t.getName().replace(/_/g,"-"));break;default:goog.asserts.assert(this.keyOption_!==goog.proto2.ObjectSerializer.KeyOption.TAG&&this.keyOption_!==goog.proto2.ObjectSerializer.KeyOption.NAME&&this.keyOption_!==goog.proto2.ObjectSerializer.KeyOption.CAMEL_CASE_NAME,"keyOption should be one of TAG, NAME, or CAMEL_CASE_NAME")}if(e.has(t))if(t.isRepeated()){var a=[];r[g]=a;for(var s=0;s<e.countOf(t);s++)a.push(this.getSerializedValue(t,e.get(t,s)))}else r[g]=this.getSerializedValue(t,e.get(t))}return e.forEachUnknown(function(e,o){r[e]=o}),r},goog.proto2.ObjectSerializer.prototype.getSerializedValue=function(e,o){return this.serializeBooleanAsNumber_&&e.getFieldType()==goog.proto2.FieldDescriptor.FieldType.BOOL&&"boolean"==typeof o?o?1:0:goog.proto2.ObjectSerializer.base(this,"getSerializedValue",e,o)},goog.proto2.ObjectSerializer.prototype.getDeserializedValue=function(e,o){return e.getFieldType()==goog.proto2.FieldDescriptor.FieldType.BOOL&&"number"==typeof o?Boolean(o):goog.proto2.ObjectSerializer.base(this,"getDeserializedValue",e,o)},goog.proto2.ObjectSerializer.prototype.deserializeTo=function(e,o){var r=e.getDescriptor();for(var i in o){var t,g=o[i],a=goog.string.isNumeric(i);if(a?t=r.findFieldByTag(i):(goog.asserts.assert(this.keyOption_==goog.proto2.ObjectSerializer.KeyOption.NAME||this.keyOption_==goog.proto2.ObjectSerializer.KeyOption.CAMEL_CASE_NAME,"Key mode "+this.keyOption_+"for key "+i+" is not "+goog.proto2.ObjectSerializer.KeyOption.NAME+" nor "+goog.proto2.ObjectSerializer.KeyOption.CAMEL_CASE_NAME),this.keyOption_==goog.proto2.ObjectSerializer.KeyOption.CAMEL_CASE_NAME&&(i=goog.string.toSelectorCase(i).replace(/\-/g,"_")),t=r.findFieldByName(i)),t)if(t.isRepeated()){goog.asserts.assert(goog.isArray(g),"Value for repeated field "+t+" must be an array.");for(var s=0;s<g.length;s++)e.add(t,this.getDeserializedValue(t,g[s]))}else goog.asserts.assert(!goog.isArray(g),"Value for non-repeated field "+t+" must not be an array."),e.set(t,this.getDeserializedValue(t,g));else a?e.setUnknown(Number(i),g):this.ignoreUnknownFields_||goog.asserts.fail("Failed to find field: "+i)}};