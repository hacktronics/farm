"use strict";var arrayProto=require("@sinonjs/commons").prototypes.array,color=require("./color"),match=require("@sinonjs/samsam").createMatcher,timesInWords=require("./util/core/times-in-words"),sinonFormat=require("./util/core/format"),jsDiff=require("diff"),join=arrayProto.join,map=arrayProto.map,push=arrayProto.push,slice=arrayProto.slice;function colorSinonMatchText(r,o,n){var t=n;return r.test(o)||(r.message=color.red(r.message),t&&(t=color.green(t))),t+" "+r.message}function colorDiffText(r){var o=map(r,function(o){var n=o.value;return o.added?n=color.green(n):o.removed&&(n=color.red(n)),2===r.length&&(n+=" "),n});return join(o,"")}function quoteStringValue(r){return"string"==typeof r?JSON.stringify(r):r}module.exports={c:function(r){return timesInWords(r.callCount)},n:function(r){return r.toString()},D:function(r,o){for(var n="",t=0,e=r.callCount;t<e;++t){e>1&&(n+="\nCall "+(t+1)+":");for(var a=r.getCall(t).args,i=slice(o),u=0;u<a.length||u<i.length;++u){a[u]&&(a[u]=quoteStringValue(a[u])),i[u]&&(i[u]=quoteStringValue(i[u])),n+="\n";var s=u<a.length?sinonFormat(a[u]):"";if(match.isMatcher(i[u]))n+=colorSinonMatchText(i[u],a[u],s);else{var l=u<i.length?sinonFormat(i[u]):"";n+=colorDiffText(jsDiff.diffJson(s,l))}}}return n},C:function(r){for(var o=[],n=0,t=r.callCount;n<t;++n){var e="    "+r.getCall(n).toString();/\n/.test(o[n-1])&&(e="\n"+e),push(o,e)}return o.length>0?"\n"+join(o,"\n"):""},t:function(r){for(var o=[],n=0,t=r.callCount;n<t;++n)push(o,sinonFormat(r.thisValues[n]));return join(o,", ")},"*":function(r,o){return join(map(o,function(r){return sinonFormat(r)}),", ")}};