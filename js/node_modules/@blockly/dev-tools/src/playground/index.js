/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const a0_0x358249=a0_0x4839;(function(_0x3b2c37,_0x2cb7f4){const _0x1f3a03=a0_0x4839,_0x20c1f8=_0x3b2c37();while(!![]){try{const _0x337bb3=-parseInt(_0x1f3a03(0x88))/0x1+-parseInt(_0x1f3a03(0xe7))/0x2+parseInt(_0x1f3a03(0xc3))/0x3*(parseInt(_0x1f3a03(0xe4))/0x4)+-parseInt(_0x1f3a03(0xe2))/0x5*(-parseInt(_0x1f3a03(0x8c))/0x6)+-parseInt(_0x1f3a03(0xc1))/0x7*(-parseInt(_0x1f3a03(0xa0))/0x8)+parseInt(_0x1f3a03(0xba))/0x9+parseInt(_0x1f3a03(0x80))/0xa*(-parseInt(_0x1f3a03(0xd2))/0xb);if(_0x337bb3===_0x2cb7f4)break;else _0x20c1f8['push'](_0x20c1f8['shift']());}catch(_0x5c0a7e){_0x20c1f8['push'](_0x20c1f8['shift']());}}}(a0_0x2cff,0x1cbcb));import{toolboxTestBlocks,toolboxTestBlocksInit}from'@blockly/block-test';function a0_0x4839(_0x47358f,_0x53425d){const _0x2cff34=a0_0x2cff();return a0_0x4839=function(_0x4839f0,_0x279d1b){_0x4839f0=_0x4839f0-0x79;let _0x36c7c6=_0x2cff34[_0x4839f0];return _0x36c7c6;},a0_0x4839(_0x47358f,_0x53425d);}import*as a0_0x214a0e from'blockly/core';import*as a0_0xce9889 from'blockly/dart';import*as a0_0x31dd9c from'blockly/javascript';import*as a0_0x5127a2 from'blockly/lua';import*as a0_0x17d2b6 from'blockly/php';import*as a0_0x22779c from'blockly/python';import{downloadWorkspaceScreenshot}from'../screenshot';import a0_0x578409 from'../toolboxCategories';import a0_0x151e2e from'../toolboxSimple';import{id}from'./id';import{addCodeEditor}from'./monaco';import{addGUIControls}from'./options';import{LocalStorageState}from'./state';import{renderCheckbox,renderCodeTab,renderPlayground}from'./ui';let CreateWorkspaceFn,PlaygroundTab,PlaygroundAPI;function a0_0x2cff(){const _0x5b3722=['playground','Export\x20to\x20XML','Range','data-tab','php','state','saveViewState','type','344405tMMApc','restoreViewState','4RyNctC','error','playgroundState_','84914aEYqdC','addAction','generate','setAttribute','Clean\x20XML','utils','none','background','get','domToPrettyText','getWorkspace','forEach','domToWorkspace','setModel','editor','1057820CjPOlT','Enter','setSelection','getModel','then','getValue','vs-dark','save','132913muLJYK','replace','firstChild','textContent','18zHJsNl','toolboxes','lua','viewState','usage:\x20addGenerator(label,\x20generator,\x20language?);','workspaceToCode','monaco','!isEditorXml','warn','CtrlCmd','updateOptions','#1E1E1E','createModel','inject','PHP','usage:\x20removeGenerator(label);','Xml','minWidth','relative','autoGenerate','40HzKdlA','checked','length','set','Import\x20from\x20XML','Download\x20Screenshot','KeyCode','KeyMod','Collapse','KeyCodes','workspaceXml','call','name','JavaScript','getFullModelRange','xml','KEY_S','appendChild','#2D2D2D','Dart','getTopBlocks','model','100%','Lua','Python','removeChild','1610973XyzQLq','activeTab','export-xml','preventDefault','javascript','tabElement','push','142961NDfXiu','keys','50658BjZdJE','configureContextMenu','clean-xml','addEventListener','ctrlKey','isEditorXml','getCurrentTab','ENTER','keyCode','click','load','XML','workspaceToDom','textToDom','getAttribute','22XWpUJr','display','auto','style','Failed\x20to\x20auto\x20import.','Generate','onDidChangeContent','message'];a0_0x2cff=function(){return _0x5b3722;};return a0_0x2cff();}export function createPlayground(_0x31ef70,_0x623508=a0_0x214a0e[a0_0x358249(0x99)],_0x4b6cea={'toolbox':a0_0x578409},_0x564c63={},_0x7f94b3){const _0xc31da3=a0_0x358249,{blocklyDiv:_0xaa8130,minimizeButton:_0xaf3405,monacoDiv:_0x3d3336,guiContainer:_0x2d337a,playgroundDiv:_0x56e055,tabButtons:_0x5bc453,tabsDiv:_0x1b8aa9}=renderPlayground(_0x31ef70);return addCodeEditor(_0x3d3336,{'model':null,'language':_0xc31da3(0xaf),'minimap':{'enabled':!0x1},'theme':_0xc31da3(0x86),'scrollBeyondLastLine':!0x1,'automaticLayout':!0x0},_0x7f94b3)[_0xc31da3(0x84)](_0x57552c=>{const _0xdf9af1=_0xc31da3;let _0x24661e;const _0x29edca=window[_0xdf9af1(0x92)][_0xdf9af1(0x7f)][_0xdf9af1(0x98)](''),_0x4c70f=_0x57552c['createContextKey'](_0xdf9af1(0xc8),!0x0),_0x1c642b=new LocalStorageState(_0xdf9af1(0xe6)+id,{'activeTab':_0xdf9af1(0xce),'autoGenerate':!_0x564c63||null==_0x564c63[_0xdf9af1(0xd4)]||_0x564c63['auto'],'workspaceXml':''});function _0x22ff0e(_0x38b90e,_0x4e55ae,_0x28fc21,_0x2b49e4){const _0x430627=_0xdf9af1,_0x23b7a7=renderCodeTab(_0x38b90e);_0x23b7a7[_0x430627(0xea)](_0x430627(0xdd),_0x38b90e),_0x1b8aa9['appendChild'](_0x23b7a7);const _0x2b6a01=window[_0x430627(0x92)][_0x430627(0x7f)][_0x430627(0x98)]('',_0x4e55ae);return{'generate':function(){const _0x54afbd=_0x430627;let _0x5532cb,_0x5d52de=_0x2b6a01;try{_0x5532cb=_0x28fc21(_0x24661e);}catch(_0x20e4dd){console[_0x54afbd(0xe5)](_0x20e4dd),_0x5532cb=_0x20e4dd[_0x54afbd(0xd9)],_0x5d52de=_0x29edca,_0x57552c[_0x54afbd(0x96)]({'wordWrap':!0x0});}_0x5d52de['pushEditOperations']([],[{'range':_0x5d52de[_0x54afbd(0xae)](),'text':_0x5532cb}],()=>null),_0x57552c[_0x54afbd(0x7e)](_0x5d52de),_0x57552c[_0x54afbd(0x82)](new window[(_0x54afbd(0x92))][(_0x54afbd(0xdc))](0x0,0x0,0x0,0x0));},'state':{'name':_0x38b90e,'model':_0x2b6a01,'language':_0x4e55ae,'viewState':void 0x0},'tabElement':_0x23b7a7};}_0x1c642b[_0xdf9af1(0xcd)]();const _0x80ac5c=_0x1a5c8a=>{const _0x2b58b4=_0xdf9af1;_0x3c4a19=_0x1a5c8a,_0x3d1fa5=_0x1a5c8a['generate'];const _0x3593c6=_0x2b58b4(0xce)==_0x1a5c8a[_0x2b58b4(0xdf)][_0x2b58b4(0xac)];_0x57552c['setModel'](_0x3c4a19[_0x2b58b4(0xdf)][_0x2b58b4(0xb5)]),_0x57552c[_0x2b58b4(0x96)]({'readOnly':!_0x3593c6,'wordWrap':!0x1}),Object['values'](_0x201061)[_0x2b58b4(0x7c)](_0x109ee2=>_0x109ee2[_0x2b58b4(0xbf)][_0x2b58b4(0xd5)][_0x2b58b4(0xee)]=_0x109ee2[_0x2b58b4(0xbf)]==_0x1a5c8a['tabElement']?_0x2b58b4(0x97):_0x2b58b4(0xb2)),_0x4c70f[_0x2b58b4(0xa3)](_0x3593c6),_0x1c642b[_0x2b58b4(0xa3)]('activeTab',_0x1a5c8a[_0x2b58b4(0xdf)][_0x2b58b4(0xac)]),_0x1c642b[_0x2b58b4(0x87)]();},_0x9e461e=()=>{const _0x448d77=_0xdf9af1;if(_0x1c642b[_0x448d77(0x79)](_0x448d77(0x9f))){if(_0x158066&&_0x243285){_0x243285=!0x1;try{a0_0x214a0e[_0x448d77(0x9c)][_0x448d77(0x7d)](a0_0x214a0e[_0x448d77(0x9c)][_0x448d77(0xd0)](_0x158066),_0x24661e);}catch(_0xf62be){console[_0x448d77(0x94)](_0x448d77(0xd6),_0xf62be);}}_0x3d1fa5&&_0x3d1fa5();let _0x3c342e='';try{_0x3c342e=a0_0x214a0e[_0x448d77(0x9c)][_0x448d77(0x7a)](a0_0x214a0e[_0x448d77(0x9c)][_0x448d77(0xcf)](_0x24661e));}catch(_0x10f137){console[_0x448d77(0x94)]('Failed\x20to\x20auto\x20save.',_0x10f137);}_0x1c642b['set'](_0x448d77(0xaa),_0x3c342e),_0x1c642b[_0x448d77(0x87)]();}},_0x201061={'XML':_0x22ff0e('XML',_0xdf9af1(0xaf),_0x471cf3=>a0_0x214a0e[_0xdf9af1(0x9c)]['domToPrettyText'](a0_0x214a0e[_0xdf9af1(0x9c)][_0xdf9af1(0xcf)](_0x471cf3))),'JavaScript':_0x22ff0e(_0xdf9af1(0xad),_0xdf9af1(0xbe),_0xc60b8c=>(a0_0x31dd9c||a0_0x214a0e[_0xdf9af1(0xad)])[_0xdf9af1(0x91)](_0xc60b8c)),'Python':_0x22ff0e(_0xdf9af1(0xb8),'python',_0x1ef217=>(a0_0x22779c||a0_0x214a0e[_0xdf9af1(0xb8)])[_0xdf9af1(0x91)](_0x1ef217)),'Dart':_0x22ff0e(_0xdf9af1(0xb3),'dart',_0x3012ca=>(a0_0xce9889||a0_0x214a0e[_0xdf9af1(0xb3)])[_0xdf9af1(0x91)](_0x3012ca)),'Lua':_0x22ff0e(_0xdf9af1(0xb7),_0xdf9af1(0x8e),_0xabd989=>(a0_0x5127a2||a0_0x214a0e['Lua'])[_0xdf9af1(0x91)](_0xabd989)),'PHP':_0x22ff0e(_0xdf9af1(0x9a),_0xdf9af1(0xde),_0x40e906=>(a0_0x17d2b6||a0_0x214a0e[_0xdf9af1(0x9a)])[_0xdf9af1(0x91)](_0x40e906))};_0x1b8aa9['addEventListener']('click',_0x214542=>{const _0x438a62=_0xdf9af1,_0x50dae4=_0x214542['target'][_0x438a62(0xd1)]('data-tab');if(!_0x50dae4)return;const _0x2d7c62=_0x201061[_0x50dae4];_0x3c4a19['state'][_0x438a62(0x8f)]=_0x57552c[_0x438a62(0xe0)](),_0x80ac5c(_0x2d7c62),_0x9e461e(),_0x57552c[_0x438a62(0xe3)](_0x3c4a19[_0x438a62(0xdf)][_0x438a62(0x8f)]),_0x57552c['focus']();});const _0x158066=_0x1c642b['get'](_0xdf9af1(0xaa))||'',_0x508b6b=_0x201061['XML'][_0xdf9af1(0xdf)][_0xdf9af1(0xb5)];let _0x243285=!0x0;_0x508b6b['setValue'](_0x158066),_0x508b6b[_0xdf9af1(0xd8)](()=>{const _0x16354b=_0xdf9af1;_0x1c642b[_0x16354b(0xa3)](_0x16354b(0xaa),_0x508b6b[_0x16354b(0x85)]()),_0x1c642b[_0x16354b(0x87)]();});const _0x3a4763=_0x1c642b[_0xdf9af1(0x79)](_0xdf9af1(0xbb));let _0x3d1fa5,_0x3c4a19=_0x201061[_0x3a4763];_0x3c4a19&&_0x80ac5c(_0x3c4a19);const _0x1d0a0a=addGUIControls(_0x2bdf70=>{const _0x56988b=_0xdf9af1;_0x24661e=_0x623508(_0xaa8130,_0x2bdf70),toolboxTestBlocksInit(_0x24661e);const _0x2e15b8=_0x24661e[_0x56988b(0xc4)];return _0x24661e[_0x56988b(0xc4)]=(_0x248b35,_0x555521)=>{const _0xf7e005=_0x56988b;_0x2e15b8&&_0x2e15b8[_0xf7e005(0xab)](null,_0x248b35,_0x555521);const _0x454baa={'text':_0xf7e005(0xa5),'enabled':_0x24661e[_0xf7e005(0xb4)]()[_0xf7e005(0xa2)],'callback':function(){downloadWorkspaceScreenshot(_0x24661e);}};_0x248b35[_0xf7e005(0xc0)](_0x454baa);},_0x9e461e(),_0x24661e['addChangeListener'](_0x20d79b=>{const _0x49e40d=_0x56988b;'ui'!==_0x20d79b[_0x49e40d(0xe1)]&&_0x9e461e();}),_0x24661e;},_0x4b6cea,{'disableResize':!0x0,'toolboxes':_0x564c63[_0xdf9af1(0x8d)]||{'categories':a0_0x578409,'simple':a0_0x151e2e,'test\x20blocks':toolboxTestBlocks}}),_0x3189d8=_0x1d0a0a['domElement'];_0x3189d8[_0xdf9af1(0xb9)](_0x3189d8[_0xdf9af1(0x8a)]),_0x3189d8['style']['position']=_0xdf9af1(0x9e),_0x3189d8[_0xdf9af1(0xd5)][_0xdf9af1(0x9d)]=_0xdf9af1(0xb6),_0x2d337a[_0xdf9af1(0xb1)](_0x3189d8),_0xaf3405[_0xdf9af1(0xc6)](_0xdf9af1(0xcc),_0x1652ba=>{const _0x58c48f=_0xdf9af1;_0x58c48f(0xed)===_0x56e055[_0x58c48f(0xd5)][_0x58c48f(0xd3)]?(_0x56e055[_0x58c48f(0xd5)]['display']='flex',_0xaf3405['textContent']=_0x58c48f(0xa8)):(_0x56e055[_0x58c48f(0xd5)][_0x58c48f(0xd3)]='none',_0xaf3405[_0x58c48f(0x8b)]='Expand'),a0_0x214a0e['svgResize'](_0x24661e);});const _0x82867f={'state':_0x1c642b,'addAction':_0x1d0a0a[_0xdf9af1(0xe8)],'addCheckboxAction':_0x1d0a0a['addCheckboxAction'],'addGenerator':function(_0x41ad1f,_0x260c99,_0x44b063){const _0x4aeb77=_0xdf9af1;if(!_0x41ad1f||!_0x260c99)throw Error(_0x4aeb77(0x90));_0x201061[_0x41ad1f]=_0x22ff0e(_0x41ad1f,_0x44b063||_0x4aeb77(0xbe),_0x10cade=>_0x260c99[_0x4aeb77(0x91)](_0x10cade)),_0x3a4763===_0x41ad1f&&_0x80ac5c(_0x201061[_0x41ad1f]);},'getCurrentTab':function(){return _0x3c4a19;},'getGUI':function(){return _0x1d0a0a;},'getWorkspace':function(){return _0x24661e;},'removeGenerator':function(_0x1d33b6){const _0xaa30c1=_0xdf9af1;if(!_0x1d33b6)throw Error(_0xaa30c1(0x9b));if(!(_0x1d33b6 in _0x201061))throw Error('removeGenerator\x20called\x20on\x20invalid\x20label:\x20'+_0x1d33b6);const _0xf382d0=_0x201061[_0x1d33b6];_0x1b8aa9[_0xaa30c1(0xb9)](_0xf382d0[_0xaa30c1(0xbf)]),delete _0x201061[_0x1d33b6];const _0x5b5f14=Object[_0xaa30c1(0xc2)](_0x201061);_0x3a4763===_0x1d33b6&&_0x5b5f14[_0xaa30c1(0xa2)]&&_0x80ac5c(_0x201061[_0x5b5f14[0x0]]);}};return registerTabButtons(_0x57552c,_0x82867f,_0x5bc453,_0x9e461e),registerEditorCommands(_0x57552c,_0x82867f),_0x82867f;});}function registerTabButtons(_0x1546a6,_0x136049,_0x1064b3,_0x4a33eb){const _0x3e33a1=a0_0x358249,[_0x3902c9,_0x5cc150]=renderCheckbox(_0x3e33a1(0x9f),'Auto');_0x3902c9[_0x3e33a1(0xa1)]=_0x136049[_0x3e33a1(0xdf)][_0x3e33a1(0x79)]('autoGenerate'),_0x3902c9[_0x3e33a1(0xc6)]('change',_0x2f0388=>{const _0x4a77cd=_0x3e33a1,_0x425c64=_0x2f0388['target'];_0x136049[_0x4a77cd(0xdf)][_0x4a77cd(0xa3)]('autoGenerate',!!_0x425c64[_0x4a77cd(0xa1)]),_0x136049['state']['save'](),_0x4a33eb();}),_0x1064b3['appendChild'](_0x3902c9),_0x1064b3[_0x3e33a1(0xb1)](_0x5cc150);}function registerEditorCommands(_0x2d0cd3,_0x447a95){const _0x4117fb=a0_0x358249,_0x714236=()=>{const _0x4f2379=a0_0x4839;if(_0x4f2379(0xce)!==_0x447a95['getCurrentTab']()[_0x4f2379(0xdf)][_0x4f2379(0xac)])return;const _0x2f2da0=_0x2d0cd3[_0x4f2379(0x83)]()[_0x4f2379(0x85)](),_0x258148=_0x447a95[_0x4f2379(0x7b)]();a0_0x214a0e[_0x4f2379(0x9c)][_0x4f2379(0x7d)](a0_0x214a0e[_0x4f2379(0x9c)][_0x4f2379(0xd0)](_0x2f2da0),_0x258148);},_0x1ce689=()=>{const _0x3bb3b5=a0_0x4839;_0x447a95[_0x3bb3b5(0xc9)]()[_0x3bb3b5(0xe9)]();};_0x2d0cd3['addAction']({'id':'import-xml','label':_0x4117fb(0xa4),'keybindings':[window[_0x4117fb(0x92)]['KeyMod'][_0x4117fb(0x95)]|window[_0x4117fb(0x92)][_0x4117fb(0xa6)][_0x4117fb(0x81)]],'precondition':'isEditorXml','contextMenuGroupId':_0x4117fb(0xda),'contextMenuOrder':0x0,'run':_0x714236}),_0x2d0cd3[_0x4117fb(0xe8)]({'id':_0x4117fb(0xbc),'label':_0x4117fb(0xdb),'keybindings':[window[_0x4117fb(0x92)][_0x4117fb(0xa7)][_0x4117fb(0x95)]|window[_0x4117fb(0x92)][_0x4117fb(0xa6)]['KEY_S']],'precondition':'isEditorXml','contextMenuGroupId':_0x4117fb(0xda),'contextMenuOrder':0x1,'run':_0x1ce689}),_0x2d0cd3[_0x4117fb(0xe8)]({'id':_0x4117fb(0xc5),'label':_0x4117fb(0xeb),'precondition':'isEditorXml','contextMenuGroupId':_0x4117fb(0xda),'contextMenuOrder':0x2,'run':()=>{const _0x4ad496=_0x4117fb,_0x24b428=_0x2d0cd3[_0x4ad496(0x83)](),_0xdb6f2d=_0x24b428['getValue']()[_0x4ad496(0x89)](/ (x|y|id)="[^"]*"/gim,'');_0x24b428['pushEditOperations']([],[{'range':_0x24b428[_0x4ad496(0xae)](),'text':_0xdb6f2d}],()=>null),_0x2d0cd3[_0x4ad496(0x82)](new window[(_0x4ad496(0x92))]['Range'](0x0,0x0,0x0,0x0));}}),_0x2d0cd3[_0x4117fb(0xe8)]({'id':'generate','label':_0x4117fb(0xd7),'keybindings':[window[_0x4117fb(0x92)][_0x4117fb(0xa7)][_0x4117fb(0x95)]|window[_0x4117fb(0x92)]['KeyCode'][_0x4117fb(0xb0)]],'precondition':_0x4117fb(0x93),'contextMenuGroupId':_0x4117fb(0xda),'contextMenuOrder':0x1,'run':_0x1ce689}),document[_0x4117fb(0xc6)]('keydown',_0x35c2d3=>{const _0x4b0e51=_0x4117fb,_0x4d8abe=_0x35c2d3['metaKey']||_0x35c2d3[_0x4b0e51(0xc7)];_0x4d8abe&&_0x35c2d3[_0x4b0e51(0xcb)]===a0_0x214a0e[_0x4b0e51(0xec)][_0x4b0e51(0xa9)]['S']?(_0x1ce689(),_0x35c2d3[_0x4b0e51(0xbd)]()):_0x4d8abe&&_0x35c2d3[_0x4b0e51(0xcb)]===a0_0x214a0e['utils'][_0x4b0e51(0xa9)][_0x4b0e51(0xca)]&&(_0x714236(),_0x35c2d3['preventDefault']());});}